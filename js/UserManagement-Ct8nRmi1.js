var te=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var G=(t,l,r)=>l in t?te(t,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[l]=r,b=(t,l)=>{for(var r in l||(l={}))ne.call(l,r)&&G(t,r,l[r]);if(J)for(var r of J(l))ce.call(l,r)&&G(t,r,l[r]);return t},w=(t,l)=>re(t,ie(l));var _=(t,l,r)=>new Promise((v,g)=>{var N=n=>{try{a(r.next(n))}catch(x){g(x)}},f=n=>{try{a(r.throw(n))}catch(x){g(x)}},a=n=>n.done?v(n.value):Promise.resolve(n.value).then(N,f);a((r=r.apply(t,l)).next())});import{r as o,j as e,C as O,p as W,q as K,v as Q,t as de,B as p}from"./main-B2Z1A0fl.js";import{B as m}from"./badge-CdNeXDip.js";import{I as oe}from"./index-yZSPA8A-.js";import{S,a as C,b as A,c as U,d as i}from"./select-BMFlvWAC.js";import{T as xe,a as me,b as X,c as j,d as he,e as u}from"./table-DepYldOb.js";import{D as je,a as ue,b as pe,c as ge,d as fe}from"./dialog-KM5TFbjt.js";import{A as ve,a as Ne,U as Y}from"./alert-DX9hSffn.js";import{u as ye,A as be,a as we,b as Se}from"./AdminLayout-Bu9tNW8d.js";import{F as Ce}from"./filter-BknADB58.js";import{S as Ae}from"./search-DJSs7YT2.js";import{M as Ue}from"./mail-UfkYQHv-.js";import{C as De}from"./calendar-Cawp_lnB.js";import{M as Te}from"./map-pin-CZucSvvB.js";import{E as Ee}from"./eye-DKsWSINO.js";import"./index-DJ86sh13.js";import"./index-DENeMT3x.js";import"./chevron-up-CetLqit9.js";import"./check-DuTiAf7C.js";import"./index-oNALVX6M.js";import"./label-naFpKG2V.js";import"./shield-CZrQFOJQ.js";import"./eye-off-B3dPSqT9.js";import"./loader-2-BKFknEq3.js";import"./scroll-area-BhRuPQbm.js";import"./bar-chart-3-BOeHrMz9.js";import"./log-out-wiSeNNbg.js";const ts=()=>{var F,L,B,P,V;ye();const t=o.useMemo(()=>new be,[]),[l,r]=o.useState([]),[v,g]=o.useState(!0),[N,f]=o.useState(null),[a,n]=o.useState({search:"",role:"all",status:"all",dateRange:"all",page:1,limit:20}),[x,Z]=o.useState(0),[c,$]=o.useState(null),[ee,y]=o.useState(!1);o.useEffect(()=>{D()},[a,D]);const D=o.useCallback(()=>_(void 0,null,function*(){try{g(!0),f(null);const s=yield t.getUsers(a);r(s.data||[]),Z(s.total||0)}catch(s){f(s instanceof Error?s.message:"Failed to load users")}finally{g(!1)}}),[a,t]),se=s=>{n(d=>w(b({},d),{search:s,page:1}))},T=(s,d)=>{n(h=>w(b({},h),{[s]:d,page:1}))},k=s=>{n(d=>w(b({},d),{page:s}))},ae=(s,d)=>_(void 0,null,function*(){try{switch(d){case"suspend":yield t.suspendUser(s);break;case"activate":yield t.activateUser(s);break;case"delete":confirm("Are you sure you want to delete this user? This action cannot be undone.")&&(yield t.deleteUser(s));break;default:break}D()}catch(h){f(h instanceof Error?h.message:"Failed to perform action")}}),M=s=>{switch(s){case"active":return e.jsx(m,{className:"bg-green-100 text-green-800",children:"Active"});case"suspended":return e.jsx(m,{className:"bg-red-100 text-red-800",children:"Suspended"});case"pending":return e.jsx(m,{className:"bg-yellow-100 text-yellow-800",children:"Pending"});default:return e.jsx(m,{variant:"secondary",children:s})}},R=s=>{switch(s){case"admin":return e.jsx(m,{className:"bg-purple-100 text-purple-800",children:"Admin"});case"moderator":return e.jsx(m,{className:"bg-blue-100 text-blue-800",children:"Moderator"});case"user":return e.jsx(m,{className:"bg-gray-100 text-gray-800",children:"User"});default:return e.jsx(m,{variant:"secondary",children:s})}},E=s=>new Date(s).toLocaleDateString();return v&&l.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})}):e.jsx(we,{requiredPermission:"users:manage",children:e.jsxs(Se,{children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage user accounts, roles, and permissions"})]}),N&&e.jsx(ve,{className:"mb-6",children:e.jsx(Ne,{children:N})}),e.jsxs(O,{className:"mb-6",children:[e.jsx(W,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"Filters"]})}),e.jsx(Q,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(oe,{placeholder:"Search users...",value:a.search,onChange:s=>se(s.target.value),className:"pl-10"})]}),e.jsxs(S,{value:a.role,onValueChange:s=>T("role",s),children:[e.jsx(C,{children:e.jsx(A,{placeholder:"All Roles"})}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Roles"}),e.jsx(i,{value:"user",children:"User"}),e.jsx(i,{value:"moderator",children:"Moderator"}),e.jsx(i,{value:"admin",children:"Admin"})]})]}),e.jsxs(S,{value:a.status,onValueChange:s=>T("status",s),children:[e.jsx(C,{children:e.jsx(A,{placeholder:"All Status"})}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"suspended",children:"Suspended"}),e.jsx(i,{value:"pending",children:"Pending"})]})]}),e.jsxs(S,{value:a.dateRange,onValueChange:s=>T("dateRange",s),children:[e.jsx(C,{children:e.jsx(A,{placeholder:"Date Range"})}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Time"}),e.jsx(i,{value:"today",children:"Today"}),e.jsx(i,{value:"week",children:"This Week"}),e.jsx(i,{value:"month",children:"This Month"})]})]})]})})]}),e.jsxs(O,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(K,{children:["Users (",x,")"]}),e.jsx(de,{children:"Platform user accounts"})]}),e.jsxs(p,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Export Users"]})]})}),e.jsxs(Q,{children:[e.jsxs(xe,{children:[e.jsx(me,{children:e.jsxs(X,{children:[e.jsx(j,{children:"User"}),e.jsx(j,{children:"Email"}),e.jsx(j,{children:"Role"}),e.jsx(j,{children:"Status"}),e.jsx(j,{children:"Joined"}),e.jsx(j,{children:"Location"}),e.jsx(j,{children:"Actions"})]})}),e.jsx(he,{children:l.map(s=>{var d,h,H,z,I,q;return e.jsxs(X,{children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium",children:((h=(d=s.profile)==null?void 0:d.full_name)==null?void 0:h.charAt(0))||s.email.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((H=s.profile)==null?void 0:H.full_name)||"No Name"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.id.slice(0,8),"..."]})]})]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s.email})]})}),e.jsx(u,{children:R(((z=s.profile)==null?void 0:z.role)||"user")}),e.jsx(u,{children:M(((I=s.profile)==null?void 0:I.status)||"active")}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:E(s.created_at)})]})}),e.jsx(u,{children:(q=s.profile)!=null&&q.location_name?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:s.profile.location_name})]}):e.jsx("span",{className:"text-gray-400",children:"Not set"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>{$(s),y(!0)},children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsxs(S,{onValueChange:le=>ae(s.id,le),children:[e.jsx(C,{className:"w-32",children:e.jsx(A,{placeholder:"Actions"})}),e.jsxs(U,{children:[e.jsx(i,{value:"view",children:"View Details"}),e.jsx(i,{value:"edit",children:"Edit User"}),e.jsx(i,{value:"suspend",children:"Suspend"}),e.jsx(i,{value:"activate",children:"Activate"}),e.jsx(i,{value:"delete",className:"text-red-600",children:"Delete"})]})]})]})})]},s.id)})})]}),l.length===0&&!v&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No users found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria."})]})]})]}),x>a.limit&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(a.page-1)*a.limit+1," to ",Math.min(a.page*a.limit,x)," of ",x," users"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"outline",size:"sm",disabled:a.page===1,onClick:()=>k(a.page-1),children:"Previous"}),e.jsx(p,{variant:"outline",size:"sm",disabled:a.page*a.limit>=x,onClick:()=>k(a.page+1),children:"Next"})]})]})]}),e.jsx(je,{open:ee,onOpenChange:y,children:e.jsxs(ue,{className:"max-w-2xl",children:[e.jsxs(pe,{children:[e.jsx(ge,{children:"User Details"}),e.jsx(fe,{children:"Detailed information about the selected user"})]}),c&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("p",{className:"text-sm text-gray-900",children:((F=c.profile)==null?void 0:F.full_name)||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Role"}),e.jsx("div",{className:"mt-1",children:R(((L=c.profile)==null?void 0:L.role)||"user")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),e.jsx("div",{className:"mt-1",children:M(((B=c.profile)==null?void 0:B.status)||"active")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Joined"}),e.jsx("p",{className:"text-sm text-gray-900",children:E(c.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Last Login"}),e.jsx("p",{className:"text-sm text-gray-900",children:(P=c.profile)!=null&&P.last_login_at?E(c.profile.last_login_at):"Never"})]})]}),((V=c.profile)==null?void 0:V.location_name)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Location"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.profile.location_name})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{variant:"outline",onClick:()=>y(!1),children:"Close"}),e.jsx(p,{onClick:()=>{y(!1)},children:"Edit User"})]})]})]})})]})})};export{ts as default};
