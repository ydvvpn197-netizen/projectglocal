var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,i=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))l.call(s,a)&&n(e,a,s[a]);return e},c=(e,t)=>s(e,a(t)),d=(e,s,a)=>new Promise((t,r)=>{var l=e=>{try{i(a.next(e))}catch(s){r(s)}},n=e=>{try{i(a.throw(e))}catch(s){r(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,n);i((a=a.apply(e,s)).next())});import{r as o,j as m,C as x,v as h,w as j,y as p,x as u,B as v,X as g}from"./main-6fHUpRzT.js";import{B as y}from"./badge-Bj-CyBpD.js";import{I as N}from"./input-C0XSs2D-.js";import{S as f,a as b,b as w,c as R,d as C}from"./select-CsS9Kpur.js";import{T as k,a as A,b as S,c as _,d as D,e as T}from"./table-DE859316.js";import{D as P,a as O,b as E,c as I,d as z}from"./dialog-DM8TTFu4.js";import{A as F,a as M}from"./alert-BCcU8rrr.js";import{T as V,a as q,b as B,c as L}from"./tabs-BNobDGc4.js";import{u as W,A as $,a as G,b as H,F as K}from"./AdminLayout-DhIOY26M.js";import{F as Q}from"./filter-B-r7EgVz.js";import{S as U}from"./search-CeL_nYcN.js";import{S as X}from"./shield-CcNVjYJS.js";import{C as Z}from"./clock-CuUFWr0o.js";import{U as J}from"./user-DoINJrqZ.js";import{C as Y}from"./index-YNlOS8aM.js";import{E as ee}from"./eye-B6Cx85SJ.js";import{C as se}from"./check-BVB7WkBF.js";import{C as ae}from"./check-circle-Bfeu-Ke9.js";import{X as te}from"./x-circle-CodQOx23.js";import{A as re}from"./alert-triangle-pxnfEJwz.js";import{F as le}from"./file-text-BWbCzzid.js";import{M as ne}from"./message-square-BNIlY-fX.js";import"./index-jVOyRz7F.js";import"./index-BlbmBgSN.js";import"./Combination-Bb2n9b59.js";import"./index-WEre3Vep.js";import"./chevron-up-k-AfHmE-.js";import"./label-B5VpaZlr.js";import"./eye-off-D0xxpRae.js";import"./loader-2-CTqUz6P4.js";import"./scroll-area-DRpKKhsW.js";import"./users-Czby48qY.js";import"./bar-chart-3-D93qNHMu.js";import"./log-out-B3lkkfQi.js";const ie=()=>{var e;W();const s=o.useMemo(()=>new $,[]),[a,t]=o.useState([]),[r,l]=o.useState(!0),[n,ie]=o.useState(null),[ce,de]=o.useState({search:"",contentType:"all",reportStatus:"all",reportReason:"all",dateRange:"all",page:1,limit:20}),[oe,me]=o.useState(0),[xe,he]=o.useState(null),[je,pe]=o.useState(!1);o.useEffect(()=>{ue()},[ce,ue]);const ue=o.useCallback(()=>d(void 0,null,function*(){try{l(!0),ie(null);const e=yield s.getContentReports(ce);t(e.data||[]),me(e.total||0)}catch(e){ie(e instanceof Error?e.message:"Failed to load reports")}finally{l(!1)}}),[ce,s]),ve=(e,s)=>{de(a=>c(i({},a),{[e]:s,page:1}))},ge=e=>{de(s=>c(i({},s),{page:e}))},ye=(e,a,t)=>d(void 0,null,function*(){try{yield s.resolveContentReport(e,a,t),ue(),pe(!1),he(null)}catch(r){ie(r instanceof Error?r.message:"Failed to perform moderation action")}}),Ne=e=>{switch(e){case"pending":return m.jsx(y,{className:"bg-yellow-100 text-yellow-800",children:"Pending Review"});case"resolved":return m.jsx(y,{className:"bg-green-100 text-green-800",children:"Resolved"});case"dismissed":return m.jsx(y,{className:"bg-gray-100 text-gray-800",children:"Dismissed"});case"escalated":return m.jsx(y,{className:"bg-red-100 text-red-800",children:"Escalated"});default:return m.jsx(y,{variant:"secondary",children:e})}},fe=e=>{switch(e){case"post":case"review":default:return m.jsx(le,{className:"h-4 w-4"});case"comment":return m.jsx(ne,{className:"h-4 w-4"});case"event":return m.jsx(Y,{className:"h-4 w-4"})}},be=e=>{switch(e){case"spam":return"bg-yellow-100 text-yellow-800";case"inappropriate":case"harassment":return"bg-red-100 text-red-800";case"misinformation":return"bg-orange-100 text-orange-800";case"copyright":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},we=e=>new Date(e).toLocaleDateString(),Re=e=>{let s=0;switch(e.report_reason){case"harassment":s+=5;break;case"inappropriate":s+=4;break;case"misinformation":case"copyright":s+=3;break;case"spam":s+=2;break;default:s+=1}const a=(Date.now()-new Date(e.created_at).getTime())/36e5;return a<1?s+=3:a<24?s+=2:a<72&&(s+=1),s},Ce=[...a].sort((e,s)=>Re(s)-Re(e));return r&&0===a.length?m.jsx("div",{className:"flex items-center justify-center min-h-screen",children:m.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})}):m.jsx(G,{requiredPermission:"moderation:manage",children:m.jsxs(H,{children:[m.jsxs("div",{className:"p-6",children:[m.jsxs("div",{className:"mb-6",children:[m.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Content Moderation"}),m.jsx("p",{className:"text-gray-600",children:"Review and take action on reported content"})]}),n&&m.jsx(F,{className:"mb-6",children:m.jsx(M,{children:n})}),m.jsxs(x,{className:"mb-6",children:[m.jsx(h,{children:m.jsxs(j,{className:"flex items-center gap-2",children:[m.jsx(Q,{className:"h-5 w-5"}),"Filters"]})}),m.jsx(p,{children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[m.jsxs("div",{className:"relative",children:[m.jsx(U,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),m.jsx(N,{placeholder:"Search reports...",value:ce.search,onChange:e=>(e=>{de(s=>c(i({},s),{search:e,page:1}))})(e.target.value),className:"pl-10"})]}),m.jsxs(f,{value:ce.contentType,onValueChange:e=>ve("contentType",e),children:[m.jsx(b,{children:m.jsx(w,{placeholder:"All Content Types"})}),m.jsxs(R,{children:[m.jsx(C,{value:"all",children:"All Content Types"}),m.jsx(C,{value:"post",children:"Posts"}),m.jsx(C,{value:"comment",children:"Comments"}),m.jsx(C,{value:"event",children:"Events"}),m.jsx(C,{value:"review",children:"Reviews"})]})]}),m.jsxs(f,{value:ce.reportStatus,onValueChange:e=>ve("reportStatus",e),children:[m.jsx(b,{children:m.jsx(w,{placeholder:"All Status"})}),m.jsxs(R,{children:[m.jsx(C,{value:"all",children:"All Status"}),m.jsx(C,{value:"pending",children:"Pending"}),m.jsx(C,{value:"resolved",children:"Resolved"}),m.jsx(C,{value:"dismissed",children:"Dismissed"}),m.jsx(C,{value:"escalated",children:"Escalated"})]})]}),m.jsxs(f,{value:ce.reportReason,onValueChange:e=>ve("reportReason",e),children:[m.jsx(b,{children:m.jsx(w,{placeholder:"All Reasons"})}),m.jsxs(R,{children:[m.jsx(C,{value:"all",children:"All Reasons"}),m.jsx(C,{value:"spam",children:"Spam"}),m.jsx(C,{value:"inappropriate",children:"Inappropriate"}),m.jsx(C,{value:"harassment",children:"Harassment"}),m.jsx(C,{value:"misinformation",children:"Misinformation"}),m.jsx(C,{value:"copyright",children:"Copyright"})]})]}),m.jsxs(f,{value:ce.dateRange,onValueChange:e=>ve("dateRange",e),children:[m.jsx(b,{children:m.jsx(w,{placeholder:"Date Range"})}),m.jsxs(R,{children:[m.jsx(C,{value:"all",children:"All Time"}),m.jsx(C,{value:"today",children:"Today"}),m.jsx(C,{value:"week",children:"This Week"}),m.jsx(C,{value:"month",children:"This Month"})]})]})]})})]}),m.jsxs(x,{children:[m.jsx(h,{children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsxs(j,{children:["Content Reports (",oe,")"]}),m.jsx(u,{children:"Reported content requiring review"})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsxs(v,{variant:"outline",children:[m.jsx(K,{className:"mr-2 h-4 w-4"}),"Export Reports"]}),m.jsxs(v,{children:[m.jsx(X,{className:"mr-2 h-4 w-4"}),"Bulk Actions"]})]})]})}),m.jsxs(p,{children:[m.jsxs(k,{children:[m.jsx(A,{children:m.jsxs(S,{children:[m.jsx(_,{children:"Priority"}),m.jsx(_,{children:"Content"}),m.jsx(_,{children:"Reporter"}),m.jsx(_,{children:"Reason"}),m.jsx(_,{children:"Status"}),m.jsx(_,{children:"Reported"}),m.jsx(_,{children:"Actions"})]})}),m.jsx(D,{children:Ce.map(e=>{var s;const a=Re(e);return m.jsxs(S,{children:[m.jsx(T,{children:m.jsxs("div",{className:"flex items-center space-x-2",children:[a>=7&&m.jsx(re,{className:"h-4 w-4 text-red-500"}),a>=4&&a<7&&m.jsx(Z,{className:"h-4 w-4 text-yellow-500"}),a<4&&m.jsx(Z,{className:"h-4 w-4 text-gray-400"}),m.jsx("span",{className:"text-sm font-medium",children:a})]})}),m.jsx(T,{children:m.jsxs("div",{className:"flex items-center space-x-2",children:[fe(e.content_type),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium",children:e.content_type}),m.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",e.content_id.slice(0,8),"..."]})]})]})}),m.jsx(T,{children:m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(J,{className:"h-4 w-4 text-gray-400"}),m.jsx("span",{className:"text-sm",children:(null==(s=e.reporter)?void 0:s.full_name)||"Anonymous"})]})}),m.jsx(T,{children:m.jsx(y,{className:be(e.report_reason),children:e.report_reason})}),m.jsx(T,{children:Ne(e.report_status)}),m.jsx(T,{children:m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Y,{className:"h-4 w-4 text-gray-400"}),m.jsx("span",{className:"text-sm",children:we(e.created_at)})]})}),m.jsx(T,{children:m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(v,{variant:"ghost",size:"sm",onClick:()=>{he(e),pe(!0)},children:m.jsx(ee,{className:"h-4 w-4"})}),"pending"===e.report_status&&m.jsxs("div",{className:"flex space-x-1",children:[m.jsx(v,{variant:"ghost",size:"sm",onClick:()=>ye(e.id,"approve"),className:"text-green-600 hover:text-green-700",children:m.jsx(se,{className:"h-4 w-4"})}),m.jsx(v,{variant:"ghost",size:"sm",onClick:()=>ye(e.id,"reject"),className:"text-red-600 hover:text-red-700",children:m.jsx(g,{className:"h-4 w-4"})})]})]})})]},e.id)})})]}),0===a.length&&!r&&m.jsxs("div",{className:"text-center py-8",children:[m.jsx(K,{className:"mx-auto h-12 w-12 text-gray-400"}),m.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No reports found"}),m.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"All content reports have been reviewed or try adjusting your filters."})]})]})]}),oe>ce.limit&&m.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[m.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(ce.page-1)*ce.limit+1," to ",Math.min(ce.page*ce.limit,oe)," of ",oe," reports"]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(v,{variant:"outline",size:"sm",disabled:1===ce.page,onClick:()=>ge(ce.page-1),children:"Previous"}),m.jsx(v,{variant:"outline",size:"sm",disabled:ce.page*ce.limit>=oe,onClick:()=>ge(ce.page+1),children:"Next"})]})]})]}),m.jsx(P,{open:je,onOpenChange:pe,children:m.jsxs(O,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[m.jsxs(E,{children:[m.jsx(I,{children:"Report Details"}),m.jsx(z,{children:"Review the reported content and take appropriate action"})]}),xe&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs(V,{defaultValue:"details",className:"w-full",children:[m.jsxs(q,{children:[m.jsx(B,{value:"details",children:"Report Details"}),m.jsx(B,{value:"content",children:"Reported Content"}),m.jsx(B,{value:"actions",children:"Actions"})]}),m.jsxs(L,{value:"details",className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Report ID"}),m.jsx("p",{className:"text-sm text-gray-900",children:xe.id})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),m.jsx("div",{className:"mt-1",children:Ne(xe.report_status)})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Content Type"}),m.jsx("p",{className:"text-sm text-gray-900",children:xe.content_type})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Report Reason"}),m.jsx("div",{className:"mt-1",children:m.jsx(y,{className:be(xe.report_reason),children:xe.report_reason})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Reporter"}),m.jsx("p",{className:"text-sm text-gray-900",children:(null==(e=xe.reporter)?void 0:e.full_name)||"Anonymous"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Reported At"}),m.jsx("p",{className:"text-sm text-gray-900",children:we(xe.created_at)})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Report Details"}),m.jsx("p",{className:"text-sm text-gray-900 mt-1 p-3 bg-gray-50 rounded",children:xe.report_details||"No additional details provided"})]})]}),m.jsx(L,{value:"content",className:"space-y-4",children:m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Content Preview"}),m.jsxs("div",{className:"mt-2 p-4 border rounded-lg bg-gray-50",children:[m.jsx("p",{className:"text-sm text-gray-600",children:"Content preview would be displayed here based on the content type and ID."}),m.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Content ID: ",xe.content_id]})]})]})}),m.jsx(L,{value:"actions",className:"space-y-4",children:"pending"===xe.report_status?m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Take Action"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[m.jsxs(v,{onClick:()=>ye(xe.id,"approve"),className:"bg-green-600 hover:bg-green-700",children:[m.jsx(ae,{className:"mr-2 h-4 w-4"}),"Approve Report"]}),m.jsxs(v,{onClick:()=>ye(xe.id,"reject"),variant:"outline",children:[m.jsx(te,{className:"mr-2 h-4 w-4"}),"Dismiss Report"]}),m.jsxs(v,{onClick:()=>ye(xe.id,"escalate"),variant:"outline",className:"text-orange-600 border-orange-600 hover:bg-orange-50",children:[m.jsx(re,{className:"mr-2 h-4 w-4"}),"Escalate"]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Resolution Notes (Optional)"}),m.jsx("textarea",{className:"mt-1 w-full p-2 border rounded-md",rows:3,placeholder:"Add notes about your decision..."})]})]}):m.jsxs("div",{className:"text-center py-8",children:[m.jsx(ae,{className:"mx-auto h-12 w-12 text-green-500"}),m.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Report Already Resolved"}),m.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This report has already been reviewed and resolved."})]})})]}),m.jsx("div",{className:"flex justify-end space-x-2",children:m.jsx(v,{variant:"outline",onClick:()=>pe(!1),children:"Close"})})]})]})})]})})};export{ie as default};
