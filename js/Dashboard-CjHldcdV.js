var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,n=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&i(e,t,s[t]);if(r)for(var t of r(s))l.call(s,t)&&i(e,t,s[t]);return e},c=(e,r)=>s(e,t(r));import{r as d,j as m,C as o,v as x,w as h,y as j,B as u,x as f,S as p}from"./main-u5iDOJMZ.js";import{B as y}from"./badge-k0SsuPwB.js";import{T as v,a as g,b as N,c as b}from"./tabs-Dn7YRzvT.js";import{u as w,A as R,a as U,b as A}from"./AdminLayout-CeQ3vd6z.js";import{U as P}from"./users-BKDXsamp.js";import{U as S}from"./user-check-B1BXaw6U.js";import{F as k}from"./file-text-sQiiCSOe.js";import{A as L}from"./alert-triangle-lyQ4bE6N.js";import{M as C}from"./message-square-DQ5316cR.js";import{B as E}from"./bar-chart-3-CGpjSjyG.js";import{S as H}from"./shield-sCmGbvNz.js";import{C as O}from"./clock-k4Wuy6bB.js";import{X as T}from"./x-circle-Dz5LHxry.js";import{C as _}from"./check-circle-Unk97XuD.js";import"./index-Dy-VqNBB.js";import"./input-d0wpgTJ2.js";import"./label-BmJUPftL.js";import"./alert-7nHfBPfv.js";import"./eye-off-DBLSYTPz.js";import"./eye-rgHTj3H0.js";import"./loader-2-BaQ9JvXw.js";import"./scroll-area-DANvZfFy.js";import"./index-jVOyRz7F.js";import"./log-out-CGc8M4_-.js";const D=()=>{var e;const{adminUser:s}=w(),t=d.useMemo(()=>new R,[]),[r,a]=d.useState({isLoading:!0,error:null,stats:{totalUsers:0,activeUsers:0,newUsersToday:0,totalContent:0,pendingReports:0,totalEvents:0,totalPosts:0,totalReviews:0},recentActivity:[],systemHealth:{status:"healthy",uptime:0,responseTime:0,errorRate:0}});d.useEffect(()=>{l()},[l]);const l=d.useCallback(()=>((e,s,t)=>new Promise((r,a)=>{var l=e=>{try{n(t.next(e))}catch(s){a(s)}},i=e=>{try{n(t.throw(e))}catch(s){a(s)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,i);n((t=t.apply(e,s)).next())}))(void 0,null,function*(){try{a(e=>c(n({},e),{isLoading:!0,error:null}));const e=yield t.getDashboardStats(),s=yield t.getAdminActions({page:1,limit:10,sortBy:"created_at",sortOrder:"desc"}),r={status:"healthy",uptime:99.9,responseTime:150,errorRate:.1};a(t=>c(n({},t),{isLoading:!1,stats:e,recentActivity:s.data||[],systemHealth:r}))}catch(e){a(s=>c(n({},s),{isLoading:!1,error:e instanceof Error?e.message:"Failed to load dashboard data"}))}}),[t]);return r.isLoading?m.jsx("div",{className:"flex items-center justify-center min-h-screen",children:m.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})}):r.error?m.jsx("div",{className:"flex items-center justify-center min-h-screen",children:m.jsxs(o,{className:"w-full max-w-md",children:[m.jsx(x,{children:m.jsx(h,{className:"text-red-600",children:"Error Loading Dashboard"})}),m.jsxs(j,{children:[m.jsx("p",{className:"text-gray-600",children:r.error}),m.jsx(u,{onClick:l,className:"mt-4",children:"Retry"})]})]})}):m.jsx(U,{requiredPermission:"dashboard:view",children:m.jsx(A,{children:m.jsxs("div",{className:"p-6",children:[m.jsxs("div",{className:"mb-6",children:[m.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",(null==(e=null==s?void 0:s.profile)?void 0:e.full_name)||"Admin","!"]}),m.jsx("p",{className:"text-gray-600",children:"Here's what's happening on your platform today."})]}),m.jsxs(v,{defaultValue:"overview",className:"space-y-6",children:[m.jsxs(g,{children:[m.jsx(N,{value:"overview",children:"Overview"}),m.jsx(N,{value:"activity",children:"Recent Activity"}),m.jsx(N,{value:"system",children:"System Health"})]}),m.jsxs(b,{value:"overview",className:"space-y-6",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[m.jsxs(o,{children:[m.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(h,{className:"text-sm font-medium",children:"Total Users"}),m.jsx(P,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(j,{children:[m.jsx("div",{className:"text-2xl font-bold",children:r.stats.totalUsers.toLocaleString()}),m.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",r.stats.newUsersToday," today"]})]})]}),m.jsxs(o,{children:[m.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(h,{className:"text-sm font-medium",children:"Active Users"}),m.jsx(S,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(j,{children:[m.jsx("div",{className:"text-2xl font-bold",children:r.stats.activeUsers.toLocaleString()}),m.jsxs("p",{className:"text-xs text-muted-foreground",children:[(r.stats.activeUsers/r.stats.totalUsers*100).toFixed(1),"% engagement"]})]})]}),m.jsxs(o,{children:[m.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(h,{className:"text-sm font-medium",children:"Total Content"}),m.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(j,{children:[m.jsx("div",{className:"text-2xl font-bold",children:r.stats.totalContent.toLocaleString()}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Posts, Events, Reviews"})]})]}),m.jsxs(o,{children:[m.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(h,{className:"text-sm font-medium",children:"Pending Reports"}),m.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(j,{children:[m.jsx("div",{className:"text-2xl font-bold",children:r.stats.pendingReports}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Require attention"})]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[m.jsxs(o,{children:[m.jsxs(x,{children:[m.jsx(h,{children:"Content Distribution"}),m.jsx(f,{children:"Breakdown by content type"})]}),m.jsxs(j,{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium",children:"Posts"}),m.jsx("span",{className:"text-sm text-muted-foreground",children:r.stats.totalPosts})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium",children:"Events"}),m.jsx("span",{className:"text-sm text-muted-foreground",children:r.stats.totalEvents})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium",children:"Reviews"}),m.jsx("span",{className:"text-sm text-muted-foreground",children:r.stats.totalReviews})]})]})]}),m.jsxs(o,{children:[m.jsxs(x,{children:[m.jsx(h,{children:"Quick Actions"}),m.jsx(f,{children:"Common admin tasks"})]}),m.jsxs(j,{className:"space-y-3",children:[m.jsxs(u,{variant:"outline",className:"w-full justify-start",size:"sm",children:[m.jsx(P,{className:"mr-2 h-4 w-4"}),"Manage Users"]}),m.jsxs(u,{variant:"outline",className:"w-full justify-start",size:"sm",children:[m.jsx(C,{className:"mr-2 h-4 w-4"}),"Review Reports"]}),m.jsxs(u,{variant:"outline",className:"w-full justify-start",size:"sm",children:[m.jsx(E,{className:"mr-2 h-4 w-4"}),"View Analytics"]}),m.jsxs(u,{variant:"outline",className:"w-full justify-start",size:"sm",children:[m.jsx(p,{className:"mr-2 h-4 w-4"}),"System Settings"]})]})]}),m.jsxs(o,{children:[m.jsxs(x,{children:[m.jsx(h,{children:"System Status"}),m.jsx(f,{children:"Platform health overview"})]}),m.jsxs(j,{children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[(e=>{switch(e){case"healthy":return m.jsx(_,{className:"h-4 w-4"});case"warning":return m.jsx(L,{className:"h-4 w-4"});case"error":return m.jsx(T,{className:"h-4 w-4"});default:return m.jsx(O,{className:"h-4 w-4"})}})(r.systemHealth.status),m.jsx(y,{className:(e=>{switch(e){case"healthy":return"bg-green-100 text-green-800";case"warning":return"bg-yellow-100 text-yellow-800";case"error":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(r.systemHealth.status),children:r.systemHealth.status})]}),m.jsxs("div",{className:"space-y-2 text-sm",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Uptime:"}),m.jsxs("span",{children:[r.systemHealth.uptime,"%"]})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Response Time:"}),m.jsxs("span",{children:[r.systemHealth.responseTime,"ms"]})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Error Rate:"}),m.jsxs("span",{children:[r.systemHealth.errorRate,"%"]})]})]})]})]})]})]}),m.jsx(b,{value:"activity",className:"space-y-6",children:m.jsxs(o,{children:[m.jsxs(x,{children:[m.jsx(h,{children:"Recent Admin Activity"}),m.jsx(f,{children:"Latest actions taken by administrators"})]}),m.jsx(j,{children:m.jsx("div",{className:"space-y-4",children:0===r.recentActivity.length?m.jsx("p",{className:"text-center text-gray-500 py-8",children:"No recent activity"}):r.recentActivity.map(e=>m.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx(H,{className:"h-5 w-5 text-gray-400"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.action_type}),m.jsxs("p",{className:"text-sm text-gray-500",children:[e.resource_type,": ",e.resource_id]}),m.jsx("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleString()})]}),m.jsx("div",{className:"flex-shrink-0",children:m.jsx(y,{variant:e.success?"default":"destructive",children:e.success?"Success":"Failed"})})]},e.id))})})]})}),m.jsx(b,{value:"system",className:"space-y-6",children:m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.jsxs(o,{children:[m.jsxs(x,{children:[m.jsx(h,{children:"Performance Metrics"}),m.jsx(f,{children:"Real-time system performance"})]}),m.jsx(j,{children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[m.jsx("span",{children:"CPU Usage"}),m.jsx("span",{children:"45%"})]}),m.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:m.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"45%"}})})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[m.jsx("span",{children:"Memory Usage"}),m.jsx("span",{children:"62%"})]}),m.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:m.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"62%"}})})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[m.jsx("span",{children:"Disk Usage"}),m.jsx("span",{children:"28%"})]}),m.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:m.jsx("div",{className:"bg-yellow-600 h-2 rounded-full",style:{width:"28%"}})})]})]})})]}),m.jsxs(o,{children:[m.jsxs(x,{children:[m.jsx(h,{children:"Error Logs"}),m.jsx(f,{children:"Recent system errors"})]}),m.jsx(j,{children:m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"text-sm p-3 bg-red-50 border border-red-200 rounded",children:[m.jsx("div",{className:"font-medium text-red-800",children:"Database Connection Timeout"}),m.jsx("div",{className:"text-red-600",children:"2 minutes ago"})]}),m.jsxs("div",{className:"text-sm p-3 bg-yellow-50 border border-yellow-200 rounded",children:[m.jsx("div",{className:"font-medium text-yellow-800",children:"High Memory Usage Warning"}),m.jsx("div",{className:"text-yellow-600",children:"15 minutes ago"})]}),m.jsxs("div",{className:"text-sm p-3 bg-green-50 border border-green-200 rounded",children:[m.jsx("div",{className:"font-medium text-green-800",children:"All systems operational"}),m.jsx("div",{className:"text-green-600",children:"1 hour ago"})]})]})})]})]})})]})]})})})};export{D as default};
