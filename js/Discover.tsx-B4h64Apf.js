var pt=Object.defineProperty,wt=Object.defineProperties;var vt=Object.getOwnPropertyDescriptors;var Fe=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var Ie=(r,t,s)=>t in r?pt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,q=(r,t)=>{for(var s in t||(t={}))at.call(t,s)&&Ie(r,s,t[s]);if(Fe)for(var s of Fe(t))rt.call(t,s)&&Ie(r,s,t[s]);return r},B=(r,t)=>wt(r,vt(t));var Pe=(r,t)=>{var s={};for(var a in r)at.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&Fe)for(var a of Fe(r))t.indexOf(a)<0&&rt.call(r,a)&&(s[a]=r[a]);return s};var ke=(r,t,s)=>Ie(r,typeof t!="symbol"?t+"":t,s);var x=(r,t,s)=>new Promise((a,n)=>{var i=d=>{try{c(s.next(d))}catch(u){n(u)}},l=d=>{try{c(s.throw(d))}catch(u){n(u)}},c=d=>d.done?a(d.value):Promise.resolve(d.value).then(i,l);c((s=s.apply(r,t)).next())});import{R as jt,j as e,r as o}from"./chunk-V8Tq47hD.js";import{d as Q,s as S,u as et,B as F,C as O,b as ne,c as fe,a as $,e as yt,f as Me}from"./main-nj8_qmr1.js";import{B as z}from"./chunk-BqqQDpKD.js";import{T as tt,a as st,b as K,c as X}from"./chunk-Dqojk3_S.js";import{ResponsiveLayout as Nt}from"./ResponsiveLayout.tsx-CBMj4ano.js";import{u as lt}from"./chunk-DJWri4GU.js";import{I as _e}from"./chunk-CfjvP89K.js";import{S as nt}from"./chunk-DX5IT3-R.js";import{S as Oe,a as $e,b as ze,c as qe,d as se}from"./chunk-BJzCN5QX.js";import{M as ct,N as bt}from"./chunk-HDUI5Ctd.js";import{af as St,v as be,X as ot,x as dt,M as Ne,a5 as Ct,C as De,T as Ce,ap as Te,U as Z,j as ue,z as Qe,g as Ae,h as Le,d as mt,ab as kt,R as ut,ao as He,p as Je,f as pe,I as _t,Q as Dt,ad as Ft,$ as Be,aq as Mt,G as Et,E as Tt,J as At,c as Lt,r as Rt,w as Ut,ah as It,ar as Pt,as as ht,at as Ot,au as $t,av as zt}from"./chunk-BD2ShIYc.js";import{L as le}from"./chunk-Ch6abJed.js";import{A as de,a as he,b as me}from"./chunk-CJL1E-Mt.js";import{a as Re}from"./chunk-jOF7Mqj2.js";import{S as qt}from"./chunk-CgjdgoZs.js";import"./chunk-7Gxbu0Lx.js";import"./chunk-aOfXXddH.js";import"./chunk-BbVfpXIH.js";import"./chunk-DkszvQuI.js";import"./chunk-Cv5hKDJv.js";import"./chunk-M09l3cRM.js";const Ee=jt.forwardRef((a,s)=>{var n=a,{className:r}=n,t=Pe(n,["className"]);return e.jsx(ct,B(q({ref:s,className:Q("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r)},t),{children:e.jsx(bt,{className:Q("flex items-center justify-center text-current"),children:e.jsx(St,{className:"h-4 w-4"})})}))});Ee.displayName=ct.displayName;class Ve{static calculateRelevanceScore(t,s){const a=this.calculateTextRelevance(t,s),n=this.calculateLocationRelevance(t,s),i=this.calculateCategoryRelevance(t,s),l=this.calculateEngagementScore(t),c=this.calculateFreshnessScore(t),d=a*.35+n*.25+i*.15+l*.15+c*.1;return{textRelevance:a,locationRelevance:n,categoryRelevance:i,engagementScore:l,freshnessScore:c,totalScore:d}}static calculateTextRelevance(t,s){var d,u;const a=s.query.toLowerCase(),n=t.title.toLowerCase(),i=((d=t.description)==null?void 0:d.toLowerCase())||"",l=((u=t.tags)==null?void 0:u.map(g=>g.toLowerCase()))||[];let c=0;return n.includes(a)?c+=10:n.split(" ").some(g=>g.includes(a))&&(c+=7),i.includes(a)?c+=5:i.split(" ").some(g=>g.includes(a))&&(c+=3),l.forEach(g=>{g.includes(a)&&(c+=3)}),n===a&&(c+=5),Math.min(c,20)}static calculateLocationRelevance(t,s){var d,u,g;if(!s.location||!t.location)return 0;let a=0;t.distance!==void 0&&(t.distance<=5?a+=10:t.distance<=15?a+=7:t.distance<=30?a+=4:t.distance<=50&&(a+=2));const n=s.query.toLowerCase(),i=((d=t.location.name)==null?void 0:d.toLowerCase())||"",l=((u=t.location.city)==null?void 0:u.toLowerCase())||"",c=((g=t.location.state)==null?void 0:g.toLowerCase())||"";return(i.includes(n)||l.includes(n)||c.includes(n))&&(a+=5),Math.min(a,15)}static calculateCategoryRelevance(t,s){return!s.category||s.category==="all",5}static calculateEngagementScore(t){if(!t.engagement)return 0;const{likes:s,comments:a,shares:n,views:i}=t.engagement,l=s*1+a*2+n*3+i*.1;return Math.min(l/100,10)}static calculateFreshnessScore(t){const s=new Date,a=new Date(t.createdAt),n=(s.getTime()-a.getTime())/(1e3*60*60);return n<=1?10:n<=24?8:n<=168?6:n<=720?4:2}static rankSearchResults(t,s){return t.map(a=>{const n=this.calculateRelevanceScore(a,s);return B(q({},a),{relevanceScore:n.totalScore})}).sort((a,n)=>{switch(s.sortBy){case"relevance":return(n.relevanceScore||0)-(a.relevanceScore||0);case"distance":return(a.distance||0)-(n.distance||0);case"date":return new Date(n.createdAt).getTime()-new Date(a.createdAt).getTime();case"popularity":{const i=a.engagement?a.engagement.likes+a.engagement.comments:0;return(n.engagement?n.engagement.likes+n.engagement.comments:0)-i}case"rating":return(n.rating||0)-(a.rating||0);default:return(n.relevanceScore||0)-(a.relevanceScore||0)}})}static generateSearchSuggestions(t,s=[]){const a=new Set;return s.forEach(l=>{l.toLowerCase().includes(t.toLowerCase())&&a.add(l)}),["music","art","food","sports","business","education","concert","exhibition","restaurant","gym","workshop","local","nearby","today","this week","free","paid"].forEach(l=>{l.toLowerCase().includes(t.toLowerCase())&&a.add(l)}),["music","art","food","sports","business","education","entertainment","health","technology","fashion","travel"].forEach(l=>{l.toLowerCase().includes(t.toLowerCase())&&a.add(l)}),Array.from(a).slice(0,10)}static calculateDistance(t,s,a,n){const l=this.deg2rad(a-t),c=this.deg2rad(n-s),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(this.deg2rad(t))*Math.cos(this.deg2rad(a))*Math.sin(c/2)*Math.sin(c/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static deg2rad(t){return t*(Math.PI/180)}}const we=class we{static getInstance(){return we.instance||(we.instance=new we),we.instance}search(t){return x(this,null,function*(){const s=[];try{const a=[];(t.type==="all"||t.type==="artist")&&a.push(this.searchArtists(t)),(t.type==="all"||t.type==="event")&&a.push(this.searchEvents(t)),(t.type==="all"||t.type==="post")&&a.push(this.searchPosts(t)),(t.type==="all"||t.type==="group")&&a.push(this.searchGroups(t)),(yield Promise.all(a)).forEach(d=>{s.push(...d)});const i=this.scoreAndSortResults(s,t),l=(t.page||0)*(t.limit||20),c=l+(t.limit||20);return i.slice(l,c)}catch(a){throw console.error("Search error:",a),new Error("Failed to perform search")}})}searchArtists(t){return x(this,null,function*(){const{data:s}=yield S.from("artists").select(`
        id,
        user_id,
        specialty,
        hourly_rate_min,
        hourly_rate_max,
        bio,
        is_available
      `).or(`specialty.cs.{${t.query}},bio.ilike.%${t.query}%`).eq("is_available",!0);if(!s)return[];const a=[];for(const n of s){const{data:i}=yield S.from("profiles").select("display_name, avatar_url, location_city, location_state, latitude, longitude").eq("user_id",n.user_id).single();if(i){const l=t.location?this.calculateDistance(t.location.latitude,t.location.longitude,i.latitude,i.longitude):void 0;(!t.location||l&&l<=t.location.radius)&&a.push({id:n.id,type:"artist",title:i.display_name||"Anonymous",description:n.bio,image:i.avatar_url,price:n.hourly_rate_min,location:{name:i.location_city||"",city:i.location_city||"",state:i.location_state||"",latitude:i.latitude,longitude:i.longitude},distance:l,tags:n.specialty,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}}return a})}searchEvents(t){return x(this,null,function*(){let s=S.from("events").select(`
        id,
        title,
        description,
        event_date,
        event_time,
        location_name,
        location_city,
        location_state,
        category,
        price,
        image_url,
        tags,
        created_at
      `).or(`title.ilike.%${t.query}%,description.ilike.%${t.query}%,category.ilike.%${t.query}%`);t.dateRange?s=s.gte("event_date",t.dateRange.start).lte("event_date",t.dateRange.end):s=s.gte("event_date",new Date().toISOString().split("T")[0]);const{data:a}=yield s;return a?a.map(n=>({id:n.id,type:"event",title:n.title,description:n.description,image:n.image_url,price:n.price,location:{name:n.location_name||"",city:n.location_city||"",state:n.location_state||""},date:`${n.event_date} ${n.event_time}`,tags:n.tags,createdAt:n.created_at,updatedAt:n.created_at})):[]})}searchPosts(t){return x(this,null,function*(){const{data:s}=yield S.from("posts").select(`
        id,
        user_id,
        title,
        content,
        type,
        likes_count,
        comments_count,
        created_at
      `).or(`title.ilike.%${t.query}%,content.ilike.%${t.query}%`).eq("status","active");if(!s)return[];const a=[];for(const n of s){const{data:i}=yield S.from("profiles").select("display_name, avatar_url").eq("user_id",n.user_id).single();i&&a.push({id:n.id,type:"post",title:n.title||"Untitled Post",description:n.content.substring(0,100)+"...",image:i.avatar_url,date:n.created_at,tags:n.type?[n.type]:[],engagement:{likes:n.likes_count||0,comments:n.comments_count||0,shares:0,views:0},createdAt:n.created_at,updatedAt:n.created_at})}return a})}searchGroups(t){return x(this,null,function*(){const{data:s}=yield S.from("community_groups").select(`
        id,
        name,
        description,
        category,
        created_at
      `).or(`name.ilike.%${t.query}%,description.ilike.%${t.query}%,category.ilike.%${t.query}%`);return s?s.map(a=>({id:a.id,type:"group",title:a.name,description:a.description,date:a.created_at,tags:a.category?[a.category]:[],createdAt:a.created_at,updatedAt:a.created_at})):[]})}calculateDistance(t,s,a,n){return!t||!s||!a||!n?0:Ve.calculateDistance(t,s,a,n)}scoreAndSortResults(t,s){return Ve.rankSearchResults(t,s)}getSearchSuggestions(t){return x(this,null,function*(){if(!t.trim())return[];const{data:s}=yield S.from("search_history").select("query").ilike("query",`%${t}%`).order("created_at",{ascending:!1}).limit(5),a=s?s.map(n=>n.query):[];return Ve.generateSearchSuggestions(t,a)})}saveSearchHistory(t,s,a,n){return x(this,null,function*(){yield S.from("search_history").insert({user_id:t,query:s,filters:JSON.stringify(a),results_count:n,created_at:new Date().toISOString()})})}};ke(we,"instance");let Ye=we;const We=Ye.getInstance(),Bt=()=>{const[r,t]=o.useState(""),[s,a]=o.useState([]),[n,i]=o.useState(!1),[l,c]=o.useState(null),[d,u]=o.useState({type:"all",category:"all",location:{enabled:!1,radius:50},dateRange:{enabled:!1,start:"",end:""},priceRange:{enabled:!1,min:0,max:1e3},tags:[],rating:0,sortBy:"relevance"}),[g,y]=o.useState([]),[h,f]=o.useState(0),[j,C]=o.useState(!0),{user:k}=et(),{currentLocation:I}=lt(),M=o.useCallback((m,v,w)=>x(null,null,function*(){const E=m||r,b=v||d,P=w||0;if(!E.trim()){a([]),C(!1);return}i(!0),c(null);try{const ee={query:E,type:b.type==="all"?void 0:b.type,category:b.category==="all"?void 0:b.category,location:b.location.enabled&&I?{latitude:I.latitude,longitude:I.longitude,radius:b.location.radius}:void 0,dateRange:b.dateRange.enabled?{start:b.dateRange.start,end:b.dateRange.end}:void 0,priceRange:b.priceRange.enabled?{min:b.priceRange.min,max:b.priceRange.max}:void 0,tags:b.tags.length>0?b.tags:void 0,sortBy:b.sortBy,page:P,limit:20},ae=yield We.search(ee);a(P===0?ae:V=>[...V,...ae]),C(ae.length===20),f(P),k&&(yield We.saveSearchHistory(k.id,E,b,ae.length))}catch(ee){c(ee instanceof Error?ee.message:"Search failed"),console.error("Search error:",ee)}finally{i(!1)}}),[r,d,I,k]),H=o.useCallback(m=>x(null,null,function*(){if(!m.trim()){y([]);return}try{const v=yield We.getSearchSuggestions(m);y(v)}catch(v){console.error("Error getting suggestions:",v)}}),[]),D=o.useCallback(m=>{u(v=>q(q({},v),m)),f(0)},[]),L=o.useCallback(()=>{u({type:"all",category:"all",location:{enabled:!1,radius:50},dateRange:{enabled:!1,start:"",end:""},priceRange:{enabled:!1,min:0,max:1e3},tags:[],rating:0,sortBy:"relevance"}),f(0)},[]),R=o.useCallback(()=>{!n&&j&&M(r,d,h+1)},[n,j,M,r,d,h]),p=o.useCallback(()=>{a([]),f(0),C(!0),c(null)},[]);return o.useEffect(()=>{const m=setTimeout(()=>{r.trim()?(M(),H(r)):(p(),y([]))},500);return()=>clearTimeout(m)},[r,M,H,p]),o.useEffect(()=>{r.trim()&&M()},[d,M,r]),{query:r,setQuery:t,results:s,loading:n,error:l,filters:d,updateFilters:D,resetFilters:L,suggestions:g,hasMore:j,loadMore:R,clearResults:p,search:()=>M()}},gt=o.memo(({result:r})=>{const t=o.useCallback(s=>({artist:e.jsx(ue,{className:"h-4 w-4"}),event:e.jsx(De,{className:"h-4 w-4"}),post:e.jsx(Z,{className:"h-4 w-4"}),group:e.jsx(Z,{className:"h-4 w-4"}),business:e.jsx(Te,{className:"h-4 w-4"})})[s]||e.jsx(be,{className:"h-4 w-4"}),[]);return e.jsx(O,{className:"hover:shadow-md transition-shadow",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(de,{className:"h-12 w-12",children:[e.jsx(he,{src:r.image}),e.jsx(me,{children:r.title.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t(r.type),e.jsx(z,{variant:"secondary",className:"text-xs",children:r.type}),e.jsx("h3",{className:"font-semibold truncate",children:r.title}),r.relevanceScore&&e.jsxs(z,{variant:"outline",className:"text-xs",children:[Math.round(r.relevanceScore),"% match"]})]}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[r.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),r.location.name||`${r.location.city}, ${r.location.state}`]}),r.distance&&e.jsxs("span",{children:[r.distance.toFixed(1),"km away"]}),r.price&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ct,{className:"h-3 w-3"}),"$",r.price]}),r.date&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{className:"h-3 w-3"}),Re(new Date(r.date),"MMM dd, yyyy")]}),r.engagement&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),r.engagement.likes+r.engagement.comments]})]}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex gap-1 mt-2",children:r.tags.slice(0,3).map((s,a)=>e.jsx(z,{variant:"outline",className:"text-xs",children:s},a))})]}),e.jsx(F,{variant:"outline",size:"sm",children:"View"})]})})})});gt.displayName="SearchResultItem";const xt=o.memo(({filters:r,updateFilters:t,resetFilters:s,categories:a})=>{var n;return e.jsxs(O,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(fe,{children:"Search Filters"}),e.jsxs(F,{variant:"outline",size:"sm",onClick:s,children:[e.jsx(ot,{className:"h-4 w-4 mr-2"}),"Reset"]})]})}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(le,{className:"text-sm font-medium",children:"Content Type"}),e.jsxs(Oe,{value:r.type,onValueChange:i=>t({type:i}),children:[e.jsx($e,{children:e.jsx(ze,{})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Types"}),e.jsx(se,{value:"artist",children:"Artists"}),e.jsx(se,{value:"event",children:"Events"}),e.jsx(se,{value:"post",children:"Posts"}),e.jsx(se,{value:"group",children:"Groups"}),e.jsx(se,{value:"business",children:"Businesses"})]})]})]}),e.jsxs("div",{children:[e.jsx(le,{className:"text-sm font-medium",children:"Category"}),e.jsxs(Oe,{value:r.category,onValueChange:i=>t({category:i}),children:[e.jsx($e,{children:e.jsx(ze,{})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Categories"}),r.type!=="all"&&((n=a[r.type])==null?void 0:n.map(i=>e.jsx(se,{value:i.toLowerCase(),children:i},i)))]})]})]}),e.jsxs("div",{children:[e.jsx(le,{className:"text-sm font-medium",children:"Sort By"}),e.jsxs(Oe,{value:r.sortBy,onValueChange:i=>t({sortBy:i}),children:[e.jsx($e,{children:e.jsx(ze,{})}),e.jsxs(qe,{children:[e.jsx(se,{value:"relevance",children:"Relevance"}),e.jsx(se,{value:"distance",children:"Distance"}),e.jsx(se,{value:"date",children:"Date"}),e.jsx(se,{value:"popularity",children:"Popularity"}),e.jsx(se,{value:"rating",children:"Rating"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{id:"location-filter",checked:r.location.enabled,onCheckedChange:i=>t({location:B(q({},r.location),{enabled:i})})}),e.jsx(le,{htmlFor:"location-filter",children:"Filter by location"})]}),r.location.enabled&&e.jsxs("div",{children:[e.jsxs(le,{className:"text-sm font-medium",children:["Max Distance: ",r.location.radius,"km"]}),e.jsx(nt,{value:[r.location.radius],onValueChange:([i])=>t({location:B(q({},r.location),{radius:i})}),max:100,min:1,step:1})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{id:"date-filter",checked:r.dateRange.enabled,onCheckedChange:i=>t({dateRange:B(q({},r.dateRange),{enabled:i})})}),e.jsx(le,{htmlFor:"date-filter",children:"Filter by date range"})]}),r.dateRange.enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(le,{className:"text-sm font-medium",children:"Start Date"}),e.jsx(_e,{type:"date",value:r.dateRange.start,onChange:i=>t({dateRange:B(q({},r.dateRange),{start:i.target.value})})})]}),e.jsxs("div",{children:[e.jsx(le,{className:"text-sm font-medium",children:"End Date"}),e.jsx(_e,{type:"date",value:r.dateRange.end,onChange:i=>t({dateRange:B(q({},r.dateRange),{end:i.target.value})})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{id:"price-filter",checked:r.priceRange.enabled,onCheckedChange:i=>t({priceRange:B(q({},r.priceRange),{enabled:i})})}),e.jsx(le,{htmlFor:"price-filter",children:"Filter by price range"})]}),r.priceRange.enabled&&e.jsxs("div",{children:[e.jsxs(le,{className:"text-sm font-medium",children:["Price Range: $",r.priceRange.min," - $",r.priceRange.max]}),e.jsx(nt,{value:[r.priceRange.min,r.priceRange.max],onValueChange:i=>t({priceRange:B(q({},r.priceRange),{min:i[0],max:i[1]})}),max:1e3,min:0,step:10})]})]})]})]})});xt.displayName="SearchFilters";const Vt=()=>{const{query:r,setQuery:t,results:s,loading:a,error:n,filters:i,updateFilters:l,resetFilters:c,suggestions:d,hasMore:u,loadMore:g}=Bt(),[y,h]=o.useState(!1),[f,j]=o.useState(!1),C=o.useMemo(()=>({artist:["Photographer","Musician","DJ","Chef","Designer","Writer","Performer"],event:["Music","Food","Art","Sports","Business","Education","Entertainment"],post:["News","Discussion","Question","Announcement","Review"],group:["Hobby","Professional","Community","Interest","Location-based"],business:["Restaurant","Shop","Service","Entertainment","Health","Education"]}),[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(_e,{placeholder:"Search artists, events, posts, groups, businesses...",value:r,onChange:k=>{t(k.target.value),j(k.target.value.length>0)},onFocus:()=>j(r.length>0),className:"pl-10"}),r&&e.jsx(F,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:()=>{t(""),j(!1)},children:e.jsx(ot,{className:"h-3 w-3"})})]}),e.jsxs(F,{variant:"outline",onClick:()=>h(!y),children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),f&&d.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 bg-background border rounded-md shadow-lg z-10 mt-1",children:d.map((k,I)=>e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-muted flex items-center gap-2",onClick:()=>{t(k),j(!1)},children:[e.jsx(be,{className:"h-3 w-3 text-muted-foreground"}),k]},I))})]}),y&&e.jsx(xt,{filters:i,updateFilters:l,resetFilters:c,categories:C}),n&&e.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-4",children:e.jsx("p",{className:"text-destructive text-sm",children:n})}),e.jsxs("div",{className:"space-y-4",children:[a&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Searching..."})]}),!a&&s.length===0&&r&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(be,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No results found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search terms or filters"})]}),s.map(k=>e.jsx(gt,{result:k},`${k.type}-${k.id}`)),u&&s.length>0&&e.jsx("div",{className:"text-center pt-4",children:e.jsx(F,{variant:"outline",onClick:g,disabled:a,children:a?"Loading...":"Load More"})})]})]})};class Wt{static calculateTrendingScore(t,s="day"){const a=this.calculateEngagementScore(t),n=this.calculateVelocityScore(t),i=this.calculateTimeDecayScore(t),l=this.calculateCategoryWeight(t),c=this.calculateLocationRelevance(t),d=this.calculateQualityScore(t),u=this.getPeriodWeights(s),g=a*u.engagement+n*u.velocity+i*u.timeDecay+l*u.category+c*u.location+d*u.quality;return{engagementScore:a,velocityScore:n,timeDecayScore:i,categoryWeight:l,locationRelevance:c,qualityScore:d,finalScore:g}}static calculateEngagementScore(t){const{likes:s,comments:a,shares:n,views:i}=t.engagement,l=s*1+a*2+n*3+i*.1;return Math.min(l/10,100)}static calculateVelocityScore(t){const{velocity:s}=t.engagement;return Math.min(s*10,100)}static calculateTimeDecayScore(t){const s=new Date,a=new Date(t.createdAt),n=(s.getTime()-a.getTime())/(1e3*60*60),i=Math.exp(-.1*n)*100;return Math.max(i,1)}static calculateCategoryWeight(t){return({music:1.2,art:1.1,food:1,sports:1.3,business:.9,education:1,entertainment:1.2,health:1.1,technology:1,fashion:1.1,travel:1}[t.category.toLowerCase()]||1)*100}static calculateLocationRelevance(t){return 80}static calculateQualityScore(t){let s=50;if(t.title&&t.title.length>10&&(s+=10),t.description&&t.description.length>50&&(s+=10),t.image&&(s+=10),t.engagement.views>0){const a=t.engagement.likes/t.engagement.views;s+=Math.min(a*100,20)}return Math.min(s,100)}static getPeriodWeights(t){return{hour:{engagement:.25,velocity:.35,timeDecay:.2,category:.1,location:.05,quality:.05},day:{engagement:.3,velocity:.25,timeDecay:.25,category:.1,location:.05,quality:.05},week:{engagement:.35,velocity:.15,timeDecay:.2,category:.15,location:.1,quality:.05},month:{engagement:.4,velocity:.1,timeDecay:.15,category:.2,location:.1,quality:.05}}[t]}static rankTrendingContent(t,s="day"){return t.map(a=>{const n=this.calculateTrendingScore(a,s);return B(q({},a),{trendingScore:n.finalScore})}).sort((a,n)=>n.trendingScore-a.trendingScore)}static calculateTrendingVelocity(t){if(t.length<2)return 0;const s=t.sort((i,l)=>new Date(i.timestamp).getTime()-new Date(l.timestamp).getTime()),a=(new Date(s[s.length-1].timestamp).getTime()-new Date(s[0].timestamp).getTime())/(1e3*60*60),n=s[s.length-1].engagement-s[0].engagement;return a>0?n/a:0}static detectTrendingPattern(t){const s=t.engagement.velocity;return s>10?"rising":s>2?"stable":"declining"}static calculateTrendingMomentum(t){if(t.length<3)return 0;const s=[];for(let a=1;a<t.length;a++){const n=(new Date(t[a].timestamp).getTime()-new Date(t[a-1].timestamp).getTime())/36e5,i=t[a].engagement-t[a-1].engagement;s.push(n>0?i/n:0)}return s.length<2?0:s[s.length-1]-s[0]}static filterByQuality(t,s=30){return t.filter(a=>this.calculateTrendingScore(a).qualityScore>=s)}static getTrendingInsights(t){const s=this.detectTrendingPattern(t),a=t.engagement.velocity;let n="stable";a>20?n="strong":a>10?n="moderate":a<2&&(n="weak");let i="stable";a>15&&s==="rising"?i="likely to trend higher":a<5&&s==="declining"?i="likely to decline":i="expected to remain stable";const l=[];return s==="rising"?(l.push("Consider promoting this content"),l.push("Monitor engagement closely")):s==="declining"&&(l.push("Consider refreshing content"),l.push("Analyze engagement patterns")),{pattern:s,momentum:n,prediction:i,recommendations:l}}}const ve=class ve{static getInstance(){return ve.instance||(ve.instance=new ve),ve.instance}getTrendingContent(t="day",s=20){return x(this,null,function*(){try{const a=[],n=yield this.getTrendingEvents(t,s/4);a.push(...n);const i=yield this.getTrendingPosts(t,s/4);a.push(...i);const l=yield this.getTrendingArtists(t,s/4);a.push(...l);const c=yield this.getTrendingGroups(t,s/4);return a.push(...c),Wt.rankTrendingContent(a,t).slice(0,s)}catch(a){return console.error("Error fetching trending content:",a),[]}})}getTrendingEvents(t,s){return x(this,null,function*(){const a=this.getTimeFilter(t),{data:n}=yield S.from("events").select(`
        id,
        title,
        description,
        category,
        event_date,
        location_name,
        location_city,
        location_state,
        image_url,
        max_attendees,
        created_at
      `).gte("event_date",new Date().toISOString().split("T")[0]).gte("created_at",a).order("max_attendees",{ascending:!1}).limit(s);return n?n.map(i=>({id:i.id,type:"event",title:i.title,description:i.description,image:i.image_url,engagement:{likes:0,comments:0,shares:0,views:0,velocity:i.max_attendees||0},trendingScore:this.calculateTrendingScore(i.max_attendees||0,i.created_at),category:i.category,location:{name:i.location_name||"",city:i.location_city||"",state:i.location_state||""},createdAt:i.created_at,trendingPeriod:t})):[]})}getTrendingPosts(t,s){return x(this,null,function*(){const a=this.getTimeFilter(t),{data:n}=yield S.from("posts").select(`
        id,
        user_id,
        title,
        content,
        type,
        likes_count,
        comments_count,
        created_at
      `).eq("status","active").gte("created_at",a).order("likes_count",{ascending:!1}).limit(s);if(!n)return[];const i=[];for(const l of n){const{data:c}=yield S.from("profiles").select("display_name, avatar_url").eq("user_id",l.user_id).single();if(c){const d=(l.likes_count||0)+(l.comments_count||0)*2;i.push({id:l.id,type:"post",title:l.title||"Untitled Post",description:l.content.substring(0,100)+"...",image:c.avatar_url,engagement:{likes:l.likes_count||0,comments:l.comments_count||0,shares:0,views:0,velocity:d},trendingScore:this.calculateTrendingScore(d,l.created_at),category:l.type||"general",createdAt:l.created_at,trendingPeriod:t})}}return i})}getTrendingArtists(t,s){return x(this,null,function*(){var i;this.getTimeFilter(t);const{data:a}=yield S.from("artists").select(`
        id,
        user_id,
        specialty,
        bio,
        hourly_rate_min,
        is_available
      `).eq("is_available",!0).limit(s);if(!a)return[];const n=[];for(const l of a){const{data:c}=yield S.from("profiles").select("display_name, avatar_url, location_city, location_state").eq("user_id",l.user_id).single();if(c){const d=Math.floor(Math.random()*100)+10;n.push({id:l.id,type:"artist",title:c.display_name||"Anonymous",description:l.bio,image:c.avatar_url,engagement:{likes:0,comments:0,shares:0,views:d,velocity:d},trendingScore:this.calculateTrendingScore(d,new Date().toISOString()),category:((i=l.specialty)==null?void 0:i[0])||"artist",location:{name:c.location_city||"",city:c.location_city||"",state:c.location_state||""},createdAt:new Date().toISOString(),trendingPeriod:t})}}return n})}getTrendingGroups(t,s){return x(this,null,function*(){const a=this.getTimeFilter(t),{data:n}=yield S.from("community_groups").select(`
        id,
        name,
        description,
        category,
        created_at
      `).gte("created_at",a).limit(s);return n?n.map(i=>{const l=Math.floor(Math.random()*50)+5;return{id:i.id,type:"group",title:i.name,description:i.description,engagement:{likes:0,comments:0,shares:0,views:l,velocity:l},trendingScore:this.calculateTrendingScore(l,i.created_at),category:i.category,createdAt:i.created_at,trendingPeriod:t}}):[]})}getTimeFilter(t){const s=new Date;let a;switch(t){case"hour":a=new Date(s.getTime()-3600*1e3);break;case"day":a=new Date(s.getTime()-1440*60*1e3);break;case"week":a=new Date(s.getTime()-10080*60*1e3);break;case"month":a=new Date(s.getTime()-720*60*60*1e3);break;default:a=new Date(s.getTime()-1440*60*1e3)}return a.toISOString()}calculateTrendingScore(t,s){const a=new Date,n=new Date(s),i=(a.getTime()-n.getTime())/(1e3*60*60),l=Math.max(.1,1-i/168),c=t/Math.max(1,i);return(t*.4+c*.4+l*.2)*100}getDiscoverContent(t,s=20){return x(this,null,function*(){try{const a=yield this.getUserPreferences(t);return(yield this.getTrendingContent("day",s*2)).map(l=>B(q({},l),{personalizationScore:this.calculatePersonalizationScore(l,a)})).sort((l,c)=>c.personalizationScore-l.personalizationScore).slice(0,s).map(d=>{var u=d,{personalizationScore:l}=u,c=Pe(u,["personalizationScore"]);return c})}catch(a){return console.error("Error fetching discover content:",a),this.getTrendingContent("day",s)}})}getUserPreferences(t){return x(this,null,function*(){const{data:s}=yield S.from("posts").select("type, category").eq("user_id",t).gte("created_at",new Date(Date.now()-2592e6).toISOString()).limit(50);if(!s)return[];const a=new Set;return s.forEach(n=>{n.type&&a.add(n.type),n.category&&a.add(n.category)}),Array.from(a)})}calculatePersonalizationScore(t,s){if(s.length===0)return .5;let a=0,n=0;return s.includes(t.category)&&(a+=.4,n++),t.tags&&t.tags.forEach(i=>{s.includes(i)&&(a+=.2,n++)}),n>0?a/n:.5}};ke(ve,"instance");let Ke=ve;const Gt=Ke.getInstance(),Qt=()=>{const[r,t]=o.useState([]),[s,a]=o.useState(!1),[n,i]=o.useState(null),[l,c]=o.useState("day"),[d,u]=o.useState(20),g=o.useCallback(()=>x(null,null,function*(){a(!0),i(null);try{const j=yield Gt.getTrendingContent(l,d);t(j)}catch(j){i(j instanceof Error?j.message:"Failed to fetch trending content"),console.error("Error fetching trending content:",j)}finally{a(!1)}}),[l,d]),y=o.useCallback(()=>{g()},[g]),h=o.useCallback(j=>{c(j)},[]),f=o.useCallback(j=>{u(j)},[]);return o.useEffect(()=>{g()},[g]),{trendingContent:r,loading:s,error:n,period:l,limit:d,fetchTrendingContent:g,refreshTrendingContent:y,changePeriod:h,changeLimit:f}},Ht=({content:r})=>{var a;const t=n=>({artist:e.jsx(ue,{className:"h-4 w-4"}),event:e.jsx(De,{className:"h-4 w-4"}),post:e.jsx(Z,{className:"h-4 w-4"}),group:e.jsx(Z,{className:"h-4 w-4"}),business:e.jsx(Te,{className:"h-4 w-4"})})[n]||e.jsx(Ce,{className:"h-4 w-4"}),s=n=>n>=1e3?`${(n/1e3).toFixed(1)}k`:Math.round(n).toString();return e.jsx(O,{className:"hover:shadow-md transition-shadow",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(de,{className:"h-12 w-12",children:[e.jsx(he,{src:r.image}),e.jsx(me,{children:r.title.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t(r.type),e.jsx(z,{variant:"secondary",className:"text-xs",children:r.type}),e.jsxs(z,{variant:"outline",className:"text-xs text-green-600",children:[s(r.trendingScore)," trending"]}),e.jsx("h3",{className:"font-semibold truncate",children:r.title})]}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-2",children:[r.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"h-3 w-3"}),r.location.name||`${r.location.city}, ${r.location.state}`]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),Re(new Date(r.createdAt),"MMM dd, yyyy")]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),r.engagement.likes]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),r.engagement.comments]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mt,{className:"h-3 w-3"}),r.engagement.shares]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(kt,{className:"h-3 w-3"}),r.engagement.views]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),r.engagement.velocity,"/hr"]})]}),((a=r.metadata)==null?void 0:a.tags)&&Array.isArray(r.metadata.tags)&&e.jsx("div",{className:"flex gap-1 mt-2",children:r.metadata.tags.slice(0,3).map((n,i)=>e.jsx(z,{variant:"outline",className:"text-xs",children:n},i))})]}),e.jsx(F,{variant:"outline",size:"sm",children:"View"})]})})})},Jt=()=>{const{trendingContent:r,loading:t,error:s,period:a,changePeriod:n,refreshTrendingContent:i}=Qt(),l=[{value:"hour",label:"Hour"},{value:"day",label:"Day"},{value:"week",label:"Week"},{value:"month",label:"Month"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Trending Content"}),e.jsx("p",{className:"text-muted-foreground",children:"Discover what's popular in your area"})]}),e.jsx(F,{variant:"outline",onClick:i,disabled:t,children:"Refresh"})]}),e.jsxs(tt,{value:a,onValueChange:c=>n(c),children:[e.jsx(st,{children:l.map(c=>e.jsx(K,{value:c.value,children:c.label},c.value))}),e.jsxs(X,{value:a,className:"space-y-4",children:[s&&e.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-4",children:e.jsx("p",{className:"text-destructive text-sm",children:s})}),t&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Loading trending content..."})]}),!t&&r.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No trending content"}),e.jsx("p",{className:"text-muted-foreground",children:"Check back later for trending content in your area"})]}),e.jsx("div",{className:"grid gap-4",children:r.map(c=>e.jsx(Ht,{content:c},`${c.type}-${c.id}`))})]})]})]})};class Yt{static generateRecommendations(t,s,a=20){const i=s.map(c=>{const d=this.calculateRecommendationScores(t,c);return B(q({},c),{scores:d})}).sort((c,d)=>d.scores.finalScore-c.scores.finalScore);return this.applyDiversityFilter(i,a).map((c,d)=>({id:`rec_${c.id}_${d}`,userId:t.userId,contentId:c.id,contentType:c.type,score:c.scores.finalScore,reason:this.generateRecommendationReason(t,c,c.scores),algorithm:"hybrid",metadata:{collaborativeScore:c.scores.collaborativeScore,contentBasedScore:c.scores.contentBasedScore,locationScore:c.scores.locationScore,freshnessScore:c.scores.freshnessScore,diversityScore:c.scores.diversityScore},createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+1440*60*1e3).toISOString()}))}static calculateRecommendationScores(t,s){const a=this.calculateCollaborativeScore(t,s),n=this.calculateContentBasedScore(t,s),i=this.calculateLocationScore(t,s),l=this.calculateFreshnessScore(s),c=this.calculateDiversityScore(s),d=a*.3+n*.25+i*.2+l*.15+c*.1;return{collaborativeScore:a,contentBasedScore:n,locationScore:i,freshnessScore:l,diversityScore:c,finalScore:d}}static calculateCollaborativeScore(t,s){const a=this.findSimilarUsers(t);if(a.length===0)return .5;const n=a.map(l=>{const c=l.preferences.find(d=>d.category===s.category);return c?c.weight:.5}),i=n.reduce((l,c)=>l+c,0)/n.length;return Math.min(i,1)}static calculateContentBasedScore(t,s){const a=t.preferences;if(a.length===0)return .5;const n=a.find(d=>d.category===s.category);if(n)return n.weight;const i=this.extractContentFeatures(s),l=this.extractUserInterests(t),c=this.calculateFeatureSimilarity(i,l);return Math.min(c,1)}static calculateLocationScore(t,s){if(!t.location||!s.location)return .5;const a=this.calculateDistance(t.location.latitude,t.location.longitude,s.location.latitude,s.location.longitude);return Math.max(0,1-a/50)}static calculateFreshnessScore(t){const s=new Date,a=new Date(t.createdAt),n=(s.getTime()-a.getTime())/(1e3*60*60),i=Math.exp(-.05*n);return Math.max(i,.1)}static calculateDiversityScore(t){return .8}static findSimilarUsers(t){return[]}static extractContentFeatures(t){const s={};if(s[`category_${t.category}`]=1,t.tags&&t.tags.forEach(a=>{s[`tag_${a}`]=1}),t.price&&(s.price_low=t.price<50?1:0,s.price_medium=t.price>=50&&t.price<200?1:0,s.price_high=t.price>=200?1:0),t.date){const a=new Date(t.date),n=new Date,i=(a.getTime()-n.getTime())/(1e3*60*60*24);s.time_soon=i<=7?1:0,s.time_medium=i>7&&i<=30?1:0,s.time_far=i>30?1:0}return s}static extractUserInterests(t){const s={};t.preferences.forEach(i=>{s[`category_${i.category}`]=i.weight});const a={};t.behaviorHistory.forEach(i=>{const l=`${i.action}_${i.contentType}`;a[l]=(a[l]||0)+1});const n=Math.max(...Object.values(a),1);return Object.entries(a).forEach(([i,l])=>{s[i]=l/n}),s}static calculateFeatureSimilarity(t,s){const a=new Set([...Object.keys(t),...Object.keys(s)]);let n=0,i=0,l=0;return a.forEach(c=>{const d=t[c]||0,u=s[c]||0;n+=d*u,i+=d*d,l+=u*u}),i===0||l===0?0:n/(Math.sqrt(i)*Math.sqrt(l))}static applyDiversityFilter(t,s){const a=[],n=new Set,i=new Set;for(const l of t){if(a.length>=s)break;const c=!n.has(l.category)||n.size>=3,d=!i.has(l.type)||i.size>=2;c&&d&&(a.push(l),n.add(l.category),i.add(l.type))}if(a.length<s)for(const l of t){if(a.length>=s)break;a.find(c=>c.id===l.id)||a.push(l)}return a}static generateRecommendationReason(t,s,a){const n=[];return a.contentBasedScore>.7&&t.preferences.find(l=>l.category===s.category)&&n.push(`Based on your interest in ${s.category}`),a.locationScore>.7&&n.push("Happening near you"),a.freshnessScore>.8&&n.push("Recently added"),a.collaborativeScore>.7&&n.push("Popular with similar users"),n.length===0&&n.push("Recommended for you"),n.join(", ")}static calculateDistance(t,s,a,n){const l=this.deg2rad(a-t),c=this.deg2rad(n-s),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(this.deg2rad(t))*Math.cos(this.deg2rad(a))*Math.sin(c/2)*Math.sin(c/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static deg2rad(t){return t*(Math.PI/180)}static updateUserPreferences(t,s,a,n){const i=[...t.preferences];let l=i.find(d=>d.category===a);l||(l={id:`pref_${a}`,userId:t.userId,category:a,weight:.5,source:"behavioral",lastUpdated:new Date().toISOString()},i.push(l));const c=this.getWeightChangeForAction(s);return l.weight=Math.max(0,Math.min(1,l.weight+c)),l.lastUpdated=new Date().toISOString(),i}static getWeightChangeForAction(t){return{like:.1,comment:.15,share:.2,bookmark:.1,follow:.25,view:.02,search:.05}[t]||0}}const je=class je{static getInstance(){return je.instance||(je.instance=new je),je.instance}getRecommendations(t,s=20){return x(this,null,function*(){try{const a=yield this.getUserProfile(t),n=yield this.getAvailableContent(t);return Yt.generateRecommendations(a,n,s)}catch(a){return console.error("Error getting recommendations:",a),[]}})}getUserProfile(t){return x(this,null,function*(){try{const{data:s}=yield S.from("user_preferences").select("*").eq("user_id",t).single(),{data:a}=yield S.from("user_behavior").select("*").eq("user_id",t).order("created_at",{ascending:!1}).limit(100);return{userId:t,preferences:s||{},behavior:a||[],interests:(s==null?void 0:s.interests)||[],location:(s==null?void 0:s.location)||null}}catch(s){return console.error("Error getting user profile:",s),{userId:t,preferences:{},behavior:[],interests:[],location:null}}})}getAvailableContent(t){return x(this,null,function*(){try{const{data:s}=yield S.from("posts").select("*").neq("user_id",t).order("created_at",{ascending:!1}).limit(100),{data:a}=yield S.from("events").select("*").order("created_at",{ascending:!1}).limit(50),{data:n}=yield S.from("profiles").select("*").eq("is_artist",!0).neq("id",t).limit(50);return[...(s||[]).map(i=>B(q({},i),{type:"post"})),...(a||[]).map(i=>B(q({},i),{type:"event"})),...(n||[]).map(i=>B(q({},i),{type:"artist"}))]}catch(s){return console.error("Error getting available content:",s),[]}})}generatePreferencesFromBehavior(t){return x(this,null,function*(){const s=[],{data:a}=yield S.from("posts").select("type, category").eq("user_id",t).limit(100);if(a){const i=new Map;a.forEach(l=>{l.type&&i.set(l.type,(i.get(l.type)||0)+1),l.category&&i.set(l.category,(i.get(l.category)||0)+1)}),i.forEach((l,c)=>{s.push({id:`${t}-${c}`,userId:t,category:c,weight:Math.min(1,l/10),source:"behavioral",lastUpdated:new Date().toISOString()})})}const{data:n}=yield S.from("post_likes").select("post_id").eq("user_id",t).limit(100);if(n)for(const i of n){const{data:l}=yield S.from("posts").select("type, category").eq("id",i.post_id).single();if(l){const c=s.find(d=>d.category===(l.type||l.category));c?c.weight+=.1:s.push({id:`${t}-${l.type||l.category}`,userId:t,category:l.type||l.category||"general",weight:.1,source:"behavioral",lastUpdated:new Date().toISOString()})}}return s})}getContentScores(t,s){return x(this,null,function*(){const a=[],{data:n}=yield S.from("posts").select(`
        id,
        user_id,
        title,
        content,
        type,
        category,
        likes_count,
        comments_count,
        created_at
      `).eq("status","active").neq("user_id",t).order("created_at",{ascending:!1}).limit(200);if(!n)return a;for(const i of n){const l=yield this.calculateContentScore(i,s,t);a.push(l)}return a})}calculateContentScore(t,s,a){return x(this,null,function*(){let n=0,i=0,l=0,c=0;s.forEach(h=>{(t.type===h.category||t.category===h.category)&&(n+=h.weight)});const d=(t.likes_count||0)+(t.comments_count||0)*2;i=Math.min(1,d/100);const u=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60);l=Math.max(0,1-u/168);const{data:g}=yield S.from("profiles").select("latitude, longitude").eq("user_id",a).single();g!=null&&g.latitude&&(g!=null&&g.longitude)&&(c=.5);const y=n*.4+i*.3+l*.2+c*.1;return{contentId:t.id,contentType:"post",relevanceScore:n,popularityScore:i,freshnessScore:l,locationScore:c,overallScore:y,factors:{userInterest:n,contentQuality:i,engagement:i,recency:l,proximity:c}}})}generateRecommendations(t,s,a){return x(this,null,function*(){const n=[],i=s.sort((l,c)=>c.overallScore-l.overallScore).slice(0,a);for(const l of i){const c=this.generateRecommendationReason(l);n.push({id:`${t}-${l.contentId}`,userId:t,contentId:l.contentId,contentType:l.contentType,score:l.overallScore,reason:c,algorithm:"hybrid",metadata:{relevanceScore:l.relevanceScore,popularityScore:l.popularityScore,freshnessScore:l.freshnessScore,locationScore:l.locationScore},createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+1440*60*1e3).toISOString()})}return n})}generateRecommendationReason(t){const s=[];return t.factors.userInterest>.5&&s.push("matches your interests"),t.factors.contentQuality>.7&&s.push("highly engaging content"),t.factors.recency>.8&&s.push("fresh content"),t.factors.proximity>.6&&s.push("local to you"),s.length===0?"trending in your area":s.join(", ")}updateUserPreferences(t,s,a){return x(this,null,function*(){yield S.from("user_preferences").upsert({user_id:t,category:s,weight:a,source:"explicit",last_updated:new Date().toISOString()})})}trackUserBehavior(t,s,a,n){return x(this,null,function*(){yield S.from("user_behavior").insert({user_id:t,action:s,content_type:a,content_id:n,metadata:{},timestamp:new Date().toISOString(),session_id:`session-${Date.now()}`})})}};ke(je,"instance");let Xe=je;const Ge=Xe.getInstance(),Kt=()=>{const[r,t]=o.useState([]),[s,a]=o.useState(!1),[n,i]=o.useState(null),[l,c]=o.useState(20),{user:d}=et(),u=o.useCallback(()=>x(null,null,function*(){if(!d){t([]);return}a(!0),i(null);try{const j=yield Ge.getRecommendations(d.id,l);t(j)}catch(j){i(j instanceof Error?j.message:"Failed to fetch recommendations"),console.error("Error fetching recommendations:",j)}finally{a(!1)}}),[d,l]),g=o.useCallback(()=>{u()},[u]),y=o.useCallback((j,C)=>x(null,null,function*(){if(d)try{yield Ge.updateUserPreferences(d.id,j,C),yield u()}catch(k){console.error("Error updating user preference:",k)}}),[d,u]),h=o.useCallback((j,C,k)=>x(null,null,function*(){if(d)try{yield Ge.trackUserBehavior(d.id,j,C,k)}catch(I){console.error("Error tracking user behavior:",I)}}),[d]),f=o.useCallback(j=>{c(j)},[]);return o.useEffect(()=>{u()},[u]),{recommendations:r,loading:s,error:n,limit:l,fetchRecommendations:u,refreshRecommendations:g,updateUserPreference:y,trackUserBehavior:h,changeLimit:f}},Xt=({recommendation:r})=>{const t=a=>({artist:e.jsx(ue,{className:"h-4 w-4"}),event:e.jsx(De,{className:"h-4 w-4"}),post:e.jsx(Z,{className:"h-4 w-4"}),group:e.jsx(Z,{className:"h-4 w-4"}),business:e.jsx(Te,{className:"h-4 w-4"})})[a]||e.jsx(He,{className:"h-4 w-4"}),s=a=>Math.round(a*100);return e.jsx(O,{className:"hover:shadow-md transition-shadow border-l-4 border-l-primary",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(de,{className:"h-12 w-12",children:e.jsx(me,{children:r.contentType.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t(r.contentType),e.jsx(z,{variant:"secondary",className:"text-xs",children:r.contentType}),e.jsxs(z,{variant:"outline",className:"text-xs text-blue-600",children:[s(r.score),"% match"]}),e.jsx("h3",{className:"font-semibold truncate",children:"Recommended Content"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:r.reason}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-3 w-3"}),r.algorithm]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),Re(new Date(r.createdAt),"MMM dd, yyyy")]})]}),r.metadata&&e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[r.metadata.relevanceScore&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),Math.round(r.metadata.relevanceScore*100),"% relevant"]}),r.metadata.popularityScore&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),Math.round(r.metadata.popularityScore*100),"% popular"]}),r.metadata.freshnessScore&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),Math.round(r.metadata.freshnessScore*100),"% fresh"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(F,{variant:"outline",size:"sm",children:"View"}),e.jsx(F,{variant:"ghost",size:"sm",children:e.jsx(Ae,{className:"h-3 w-3"})})]})]})})})},Zt=()=>{const{recommendations:r,loading:t,error:s,refreshRecommendations:a}=Kt();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Recommended for You"}),e.jsx("p",{className:"text-muted-foreground",children:"Personalized content based on your interests and behavior"})]}),e.jsxs(F,{variant:"outline",onClick:a,disabled:t,children:[e.jsx(ut,{className:`h-4 w-4 mr-2 ${t?"animate-spin":""}`}),"Refresh"]})]}),s&&e.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-4",children:e.jsx("p",{className:"text-destructive text-sm",children:s})}),t&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Loading recommendations..."})]}),!t&&r.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(He,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No recommendations yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Start exploring content to get personalized recommendations"})]}),e.jsx("div",{className:"grid gap-4",children:r.map(n=>e.jsx(Xt,{recommendation:n},n.id))})]})};class it{static generateFollowSuggestions(t,s,a,n,i,l=20){return i.filter(g=>g.id!==t&&!n.includes(g.id)).map(g=>{const y=this.calculateFollowRecommendationScores(t,s,a,g,i);return B(q({},g),{scores:y})}).sort((g,y)=>y.scores.finalScore-g.scores.finalScore).slice(0,l).map((g,y)=>({id:`suggestion_${g.id}_${y}`,userId:g.id,displayName:g.display_name||g.username||"Anonymous",avatarUrl:g.avatar_url,bio:g.bio||"",score:g.scores.finalScore,commonInterests:this.findCommonInterests(s,g.interests||[]),mutualFollowers:this.countMutualFollowers(t,g.id,i),location:g.location?{city:g.location.city||"",state:g.location.state||""}:null,reason:this.generateFollowReason(g.scores,g),createdAt:new Date().toISOString()}))}static calculateFollowRecommendationScores(t,s,a,n,i){const l=this.calculateSimilarityScore(s,n.interests||[]),c=this.calculateMutualConnectionsScore(t,n.id,i),d=this.calculateActivityScore(n),u=this.calculateLocationScore(a,n.location),g=this.calculateInterestOverlapScore(s,n.interests||[]),y=l*.25+c*.3+d*.2+u*.15+g*.1;return{similarityScore:l,mutualConnectionsScore:c,activityScore:d,locationScore:u,interestOverlapScore:g,finalScore:y}}static calculateSimilarityScore(t,s){if(t.length===0||s.length===0)return .5;const n=this.findCommonInterests(t,s).length/Math.max(t.length,s.length);return Math.min(n,1)}static calculateMutualConnectionsScore(t,s,a){const n=this.countMutualFollowers(t,s,a);return Math.min(n/50,1)}static calculateActivityScore(t){let s=.5;if(t.posts_count){const a=Math.min(t.posts_count/100,1);s+=a*.2}if(t.events_created_count){const a=Math.min(t.events_created_count/20,1);s+=a*.2}if(t.last_activity){const a=(new Date().getTime()-new Date(t.last_activity).getTime())/864e5;a<=7?s+=.3:a<=30?s+=.2:a<=90&&(s+=.1)}return Math.min(s,1)}static calculateLocationScore(t,s){if(!t||!s)return .5;if(t.city===s.city)return 1;if(t.state===s.state)return .7;if(s.latitude&&s.longitude){const a=this.calculateDistance(t.latitude,t.longitude,s.latitude,s.longitude);return Math.max(0,1-a/100)}return .3}static calculateInterestOverlapScore(t,s){if(t.length===0||s.length===0)return .5;const n=this.findCommonInterests(t,s).length/Math.min(t.length,s.length);return Math.min(n,1)}static findCommonInterests(t,s){const a=t.map(i=>i.toLowerCase()),n=s.map(i=>i.toLowerCase());return a.filter(i=>n.includes(i))}static countMutualFollowers(t,s,a){const n=a.find(u=>u.id===t),i=a.find(u=>u.id===s);if(!n||!i)return 0;const l=n.followers_count||0,c=i.followers_count||0,d=Math.min(l,c);return Math.floor(d*.1)}static calculateDistance(t,s,a,n){const l=this.deg2rad(a-t),c=this.deg2rad(n-s),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(this.deg2rad(t))*Math.cos(this.deg2rad(a))*Math.sin(c/2)*Math.sin(c/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static deg2rad(t){return t*(Math.PI/180)}static generateFollowReason(t,s){const a=[];if(t.similarityScore>.7&&a.push("Similar interests"),t.mutualConnectionsScore>.5){const n=Math.floor(t.mutualConnectionsScore*50);a.push(`${n} mutual connections`)}return t.activityScore>.7?a.push("Very active"):t.activityScore>.5&&a.push("Active user"),t.locationScore>.8?a.push("Same city"):t.locationScore>.6&&a.push("Nearby"),t.interestOverlapScore>.6&&a.push("Shared interests"),a.length===0&&a.push("Recommended for you"),a.join(", ")}static getPopularUsers(t,s=10){return t.filter(a=>a.followers_count>0).sort((a,n)=>(n.followers_count||0)-(a.followers_count||0)).slice(0,s)}static getUsersByInterest(t,s,a=10){const n=s.toLowerCase();return t.filter(i=>(i.interests||[]).some(c=>c.toLowerCase().includes(n))).sort((i,l)=>(l.followers_count||0)-(i.followers_count||0)).slice(0,a)}static calculateFollowStats(t,s,a){const n=s.length,i=a.length,l=s.filter(h=>a.some(f=>f.id===h.id)).length,c=s.reduce((h,f)=>h+(f.engagement_count||0),0),d=n>0?c/n:0,u=new Date(Date.now()-720*60*60*1e3),g=s.filter(h=>new Date(h.followed_at||h.created_at)>u).length,y=n>0?g/n:0;return{userId:t,totalFollowers:n,totalFollowing:i,mutualFollowers:l,engagementRate:d,growthRate:y,lastUpdated:new Date().toISOString()}}static analyzeFollowNetwork(t,s,a){const n=new Set([...s.map(f=>f.id),...a.map(f=>f.id)]).size,i=n*(n-1)/2,l=s.length+a.length,c=i>0?l/i:0,d=[...s,...a].filter(f=>(f.followers_count||0)>1e3).length,u=[...s,...a].flatMap(f=>f.interests||[]),g={};u.forEach(f=>{g[f]=(g[f]||0)+1});const y=Object.entries(g).filter(([f,j])=>j>1).sort(([f,j],[C,k])=>k-j).slice(0,5).map(([f,j])=>f),h=[];return c<.1&&h.push("Consider following more people to expand your network"),d<5&&h.push("Connect with more influential users in your field"),y.length<3&&h.push("Diversify your interests to connect with more people"),{networkSize:n,networkDensity:c,influentialConnections:d,commonInterests:y,recommendations:h}}}const ye=class ye{static getInstance(){return ye.instance||(ye.instance=new ye),ye.instance}followUser(t,s){return x(this,null,function*(){const{data:a,error:n}=yield S.from("user_follows").insert({follower_id:t,following_id:s,status:"active",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(n)throw new Error(`Failed to follow user: ${n.message}`);return a})}unfollowUser(t,s){return x(this,null,function*(){const{error:a}=yield S.from("user_follows").delete().eq("follower_id",t).eq("following_id",s);if(a)throw new Error(`Failed to unfollow user: ${a.message}`)})}getFollowStatus(t,s){return x(this,null,function*(){const{data:a}=yield S.from("user_follows").select("status").eq("follower_id",t).eq("following_id",s).single();return a?a.status:"not_following"})}getFollowers(t,s=20){return x(this,null,function*(){const{data:a}=yield S.from("user_follows").select(`
        *,
        follower:profiles!user_follows_follower_id_fkey(
          user_id,
          display_name,
          avatar_url,
          bio
        )
      `).eq("following_id",t).eq("status","active").order("created_at",{ascending:!1}).limit(s);return a||[]})}getFollowing(t,s=20){return x(this,null,function*(){const{data:a}=yield S.from("user_follows").select(`
        *,
        following:profiles!user_follows_following_id_fkey(
          user_id,
          display_name,
          avatar_url,
          bio
        )
      `).eq("follower_id",t).eq("status","active").order("created_at",{ascending:!1}).limit(s);return a||[]})}getFollowStats(t){return x(this,null,function*(){const{count:s}=yield S.from("user_follows").select("*",{count:"exact",head:!0}).eq("following_id",t).eq("status","active"),{count:a}=yield S.from("user_follows").select("*",{count:"exact",head:!0}).eq("follower_id",t).eq("status","active"),{data:n}=yield S.from("user_follows").select("follower_id").eq("following_id",t).eq("status","active"),{data:i}=yield S.from("user_follows").select("following_id").eq("follower_id",t).eq("status","active");return it.calculateFollowStats(t,n||[],i||[])})}getFollowSuggestions(t,s=10){return x(this,null,function*(){try{const a=yield this.getUserProfile(t),n=yield this.getAllUsers(t);return it.generateFollowSuggestions(t,a.interests,a.location,this.getExistingFollows(t),n,s)}catch(a){return console.error("Error getting follow suggestions:",a),[]}})}getPopularUsers(t=10){return x(this,null,function*(){try{const{data:s}=yield S.from("profiles").select(`
          user_id,
          display_name,
          avatar_url,
          bio,
          location_city,
          location_state
        `).order("created_at",{ascending:!1}).limit(t*2);if(!s)return[];const a=[];for(const n of s){const{count:i}=yield S.from("user_follows").select("*",{count:"exact",head:!0}).eq("following_id",n.user_id).eq("status","active");i&&i>5&&a.push({userId:n.user_id,displayName:n.display_name||"Anonymous",avatarUrl:n.avatar_url,bio:n.bio,mutualFollowers:0,commonInterests:[],location:n.location_city?{city:n.location_city,state:n.location_state||""}:void 0,score:i,reason:"Popular in your area"})}return a.sort((n,i)=>i.score-n.score).slice(0,t)}catch(s){return console.error("Error getting popular users:",s),[]}})}getUsersByInterest(t,s=10){return x(this,null,function*(){try{const{data:a}=yield S.from("posts").select("user_id").or(`content.ilike.%${t}%,title.ilike.%${t}%`).eq("status","active").limit(100);if(!a)return[];const n=[...new Set(a.map(l=>l.user_id))];if(n.length===0)return[];const{data:i}=yield S.from("profiles").select(`
          user_id,
          display_name,
          avatar_url,
          bio,
          location_city,
          location_state
        `).in("user_id",n).limit(s);return i?i.map(l=>({userId:l.user_id,displayName:l.display_name||"Anonymous",avatarUrl:l.avatar_url,bio:l.bio,mutualFollowers:0,commonInterests:[t],location:l.location_city?{city:l.location_city,state:l.location_state||""}:void 0,score:1,reason:`Interested in ${t}`})):[]}catch(a){return console.error("Error getting users by interest:",a),[]}})}getUserProfile(t){return x(this,null,function*(){try{const{data:s}=yield S.from("profiles").select("*").eq("id",t).single(),{data:a}=yield S.from("user_preferences").select("*").eq("user_id",t).single();return{id:t,interests:(a==null?void 0:a.interests)||[],location:(s==null?void 0:s.location)||null,skills:(s==null?void 0:s.skills)||[],bio:(s==null?void 0:s.bio)||""}}catch(s){return console.error("Error getting user profile:",s),{id:t,interests:[],location:null,skills:[],bio:""}}})}getAllUsers(t){return x(this,null,function*(){try{const{data:s}=yield S.from("user_follows").select("following_id").eq("follower_id",t).eq("status","active"),a=(s==null?void 0:s.map(i=>i.following_id))||[],{data:n}=yield S.from("profiles").select("*").neq("id",t).not("id","in",`(${a.join(",")})`);return n||[]}catch(s){return console.error("Error getting all users:",s),[]}})}getExistingFollows(t){return[]}};ke(ye,"instance");let Ze=ye;const oe=Ze.getInstance(),ft=()=>{const[r,t]=o.useState([]),[s,a]=o.useState([]),[n,i]=o.useState(null),[l,c]=o.useState([]),[d,u]=o.useState(!1),[g,y]=o.useState(null),{user:h}=et(),f=o.useCallback(p=>x(null,null,function*(){if(!h&&!p)return;const m=p||h.id;u(!0),y(null);try{const v=yield oe.getFollowers(m);t(v)}catch(v){y(v instanceof Error?v.message:"Failed to fetch followers"),console.error("Error fetching followers:",v)}finally{u(!1)}}),[h]),j=o.useCallback(p=>x(null,null,function*(){if(!h&&!p)return;const m=p||h.id;u(!0),y(null);try{const v=yield oe.getFollowing(m);a(v)}catch(v){y(v instanceof Error?v.message:"Failed to fetch following"),console.error("Error fetching following:",v)}finally{u(!1)}}),[h]),C=o.useCallback(p=>x(null,null,function*(){if(!h&&!p)return;const m=p||h.id;u(!0),y(null);try{const v=yield oe.getFollowStats(m);i(v)}catch(v){y(v instanceof Error?v.message:"Failed to fetch follow stats"),console.error("Error fetching follow stats:",v)}finally{u(!1)}}),[h]),k=o.useCallback(()=>x(null,null,function*(){if(h){u(!0),y(null);try{const p=yield oe.getFollowSuggestions(h.id);c(p)}catch(p){y(p instanceof Error?p.message:"Failed to fetch suggestions"),console.error("Error fetching suggestions:",p)}finally{u(!1)}}}),[h]),I=o.useCallback(p=>x(null,null,function*(){if(h){u(!0),y(null);try{yield oe.followUser(h.id,p),a(m=>[...m,{id:`${h.id}-${p}`,followerId:h.id,followingId:p,status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}]),yield C()}catch(m){y(m instanceof Error?m.message:"Failed to follow user"),console.error("Error following user:",m)}finally{u(!1)}}}),[h,C]),M=o.useCallback(p=>x(null,null,function*(){if(h){u(!0),y(null);try{yield oe.unfollowUser(h.id,p),a(m=>m.filter(v=>v.followingId!==p)),yield C()}catch(m){y(m instanceof Error?m.message:"Failed to unfollow user"),console.error("Error unfollowing user:",m)}finally{u(!1)}}}),[h,C]),H=o.useCallback(p=>x(null,null,function*(){if(!h)return"not_following";try{return yield oe.getFollowStatus(h.id,p)}catch(m){return console.error("Error getting follow status:",m),"not_following"}}),[h]),D=o.useCallback((p=10)=>x(null,null,function*(){u(!0),y(null);try{return yield oe.getPopularUsers(p)}catch(m){return y(m instanceof Error?m.message:"Failed to fetch popular users"),console.error("Error fetching popular users:",m),[]}finally{u(!1)}}),[]),L=o.useCallback((p,m=10)=>x(null,null,function*(){u(!0),y(null);try{return yield oe.getUsersByInterest(p,m)}catch(v){return y(v instanceof Error?v.message:"Failed to fetch users by interest"),console.error("Error fetching users by interest:",v),[]}finally{u(!1)}}),[]),R=o.useCallback(p=>x(null,null,function*(){if(!h&&!p)return;const m=p||h.id;yield Promise.all([f(m),j(m),C(m)]),p||(yield k())}),[h,f,j,C,k]);return o.useEffect(()=>{h&&R()},[h,R]),{followers:r,following:s,followStats:n,suggestions:l,loading:d,error:g,fetchFollowers:f,fetchFollowing:j,fetchFollowStats:C,fetchSuggestions:k,followUser:I,unfollowUser:M,getFollowStatus:H,getPopularUsers:D,getUsersByInterest:L,refreshAll:R}},es=({suggestion:r})=>{const{followUser:t,loading:s}=ft(),a=()=>x(null,null,function*(){yield t(r.userId)});return e.jsx(O,{className:"hover:shadow-md transition-shadow",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(de,{className:"h-12 w-12",children:[e.jsx(he,{src:r.avatarUrl}),e.jsx(me,{children:r.displayName.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold truncate",children:r.displayName}),e.jsxs(z,{variant:"outline",className:"text-xs",children:[Math.round(r.score),"% match"]})]}),r.bio&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:r.bio}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-2",children:[r.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),r.location.city,", ",r.location.state]}),r.mutualFollowers>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"}),r.mutualFollowers," mutual"]})]}),r.commonInterests.length>0&&e.jsx("div",{className:"flex gap-1 mb-2",children:r.commonInterests.slice(0,3).map((n,i)=>e.jsx(z,{variant:"outline",className:"text-xs",children:n},i))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.reason})]}),e.jsxs(F,{variant:"outline",size:"sm",onClick:a,disabled:s,children:[e.jsx(Je,{className:"h-3 w-3 mr-1"}),"Follow"]})]})})})},ts=()=>{const{suggestions:r,loading:t,error:s,fetchSuggestions:a}=ft();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"People to Follow"}),e.jsx("p",{className:"text-muted-foreground",children:"Discover people with similar interests"})]}),e.jsxs(F,{variant:"outline",onClick:a,disabled:t,children:[e.jsx(ut,{className:`h-4 w-4 mr-2 ${t?"animate-spin":""}`}),"Refresh"]})]}),s&&e.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-4",children:e.jsx("p",{className:"text-destructive text-sm",children:s})}),t&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Loading suggestions..."})]}),!t&&r.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No suggestions yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Start following people to get personalized suggestions"})]}),e.jsx("div",{className:"grid gap-4",children:r.map(n=>e.jsx(es,{suggestion:n},n.userId))})]})},Se=({user:r,onFollow:t,onMessage:s,onViewProfile:a,onShare:n,onEdit:i,onContact:l,showActions:c=!0,showStats:d=!0,showSocialLinks:u=!1,showSkills:g=!1,showInterests:y=!1,className:h,variant:f="default",loading:j=!1,error:C=null,animate:k=!0,interactive:I=!0})=>{var re;const[M,H]=o.useState(r.isFollowing||!1),[D,L]=o.useState(!1),[R,p]=o.useState(C),[m,v]=o.useState(!1),[w,E]=o.useState(!1),[b,P]=o.useState(0),ee=o.useCallback(()=>{E(!w),P(A=>w?A-1:A+1)},[w]),ae=o.useCallback(A=>{v(A)},[]),V=o.useMemo(()=>r.name?r.name:"Anonymous User",[r.name]),ie=o.useMemo(()=>r.bio?r.bio:null,[r.bio]),J=o.useMemo(()=>r.location?r.location:null,[r.location]),ge=o.useMemo(()=>V.charAt(0).toUpperCase(),[V]),te=o.useMemo(()=>r.verified===!0,[r.verified]),N=o.useMemo(()=>r.isOnline===!0,[r.isOnline]),_=o.useMemo(()=>r.isPremium===!0,[r.isPremium]);o.useMemo(()=>r.isFeatured===!0,[r.isFeatured]);const W=o.useCallback(()=>x(null,null,function*(){if(!(!t||D))try{L(!0),p(null),yield t(r.id),H(!M)}catch(A){p(A instanceof Error?A.message:"Failed to follow user")}finally{L(!1)}}),[t,r.id,M,D]),ce=o.useCallback(()=>x(null,null,function*(){if(!(!s||D))try{L(!0),p(null),yield s(r.id)}catch(A){p(A instanceof Error?A.message:"Failed to send message")}finally{L(!1)}}),[s,r.id,D]),Ue=o.useCallback(()=>x(null,null,function*(){if(!(!a||D))try{L(!0),p(null),yield a(r.id)}catch(A){p(A instanceof Error?A.message:"Failed to view profile")}finally{L(!1)}}),[a,r.id,D]),T=o.useCallback(()=>x(null,null,function*(){if(!(!n||D))try{L(!0),p(null),yield n(r.id)}catch(A){p(A instanceof Error?A.message:"Failed to share profile")}finally{L(!1)}}),[n,r.id,D]),U=o.useCallback(()=>x(null,null,function*(){if(!(!i||D))try{L(!0),p(null),yield i(r.id)}catch(A){p(A instanceof Error?A.message:"Failed to edit profile")}finally{L(!1)}}),[i,r.id,D]),G=o.useCallback(()=>x(null,null,function*(){if(!(!l||D))try{L(!0),p(null),yield l(r.id)}catch(A){p(A instanceof Error?A.message:"Failed to contact user")}finally{L(!1)}}),[l,r.id,D]);if(j)return e.jsxs(O,{className:Q("w-full animate-pulse",h),"data-testid":"loading-skeleton",children:[e.jsx(ne,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-32"}),e.jsx("div",{className:"h-3 bg-muted rounded w-24"})]})]})}),e.jsxs($,{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-muted rounded w-full"}),e.jsx("div",{className:"h-3 bg-muted rounded w-3/4"})]})]});const Y=R&&e.jsxs("div",{className:"mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-destructive",children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Error loading profile"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:R})]});return f==="minimal"?e.jsx(O,{className:Q("w-full transition-all duration-200",I&&"hover:shadow-md cursor-pointer",k&&"animate-in fade-in-0 slide-in-from-bottom-2",h),onMouseEnter:()=>I&&v(!0),onMouseLeave:()=>I&&v(!1),"data-testid":"enhanced-user-profile-card-minimal",children:e.jsx($,{className:"p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(de,{className:"h-10 w-10",children:[e.jsx(he,{src:r.avatar,alt:V}),e.jsx(me,{className:"text-sm",children:ge})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:V}),te&&e.jsx(pe,{className:"h-3 w-3 text-blue-500 flex-shrink-0","data-testid":"verified-badge"}),N&&e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full","data-testid":"online-indicator"})]}),J&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate flex items-center",children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),J]})]})]})})}):f==="compact"?e.jsx(O,{className:Q("w-full transition-all duration-200",I&&"hover:shadow-md",k&&"animate-in fade-in-0 slide-in-from-bottom-2",h),"data-testid":"enhanced-user-profile-card-compact",children:e.jsxs($,{className:"p-4",children:[Y,e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(de,{className:"h-12 w-12",children:[e.jsx(he,{src:r.avatar,alt:V}),e.jsx(me,{children:ge})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-sm truncate",children:V}),te&&e.jsx(pe,{className:"h-4 w-4 text-blue-500 flex-shrink-0","data-testid":"verified-badge"}),N&&e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full","data-testid":"online-indicator"}),_&&e.jsx(ue,{className:"h-4 w-4 text-yellow-500 flex-shrink-0","data-testid":"premium-badge"})]}),ie&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:ie}),J&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate flex items-center",children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),J]})]}),c&&e.jsx(F,{size:"sm",variant:M?"outline":"default",onClick:W,disabled:D,className:"flex-shrink-0",children:M?"Following":"Follow"})]})]})}):f==="default"?e.jsxs(O,{className:Q("w-full transition-all duration-200",I&&"hover:shadow-md hover:scale-[1.02]",k&&"animate-in fade-in-0 slide-in-from-bottom-2",m&&"shadow-lg ring-2 ring-primary/20",h),"data-testid":"enhanced-user-profile-card-default",onMouseEnter:()=>ae(!0),onMouseLeave:()=>ae(!1),children:[Y,e.jsx(ne,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(de,{className:"h-20 w-20",children:[e.jsx(he,{src:r.avatar,alt:V}),e.jsx(me,{className:"text-lg",children:ge})]}),N&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-background","data-testid":"online-indicator"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:V}),te&&e.jsx(pe,{className:"h-5 w-5 text-blue-500","data-testid":"verified-badge"}),((re=r.badges)==null?void 0:re.includes("trending"))&&e.jsx(Ce,{className:"h-5 w-5 text-orange-500","data-testid":"trending-badge"}),_&&e.jsx(ue,{className:"h-5 w-5 text-yellow-500","data-testid":"premium-badge"})]}),ie&&e.jsx("p",{className:"text-muted-foreground",children:ie}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[J&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{children:J})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx("span",{children:r.email})]})]})]})]}),c&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(F,{variant:M?"outline":"default",onClick:W,disabled:D,className:"flex-shrink-0","aria-label":`${M?"Unfollow":"Follow"} ${V}`,children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),M?"Following":"Follow",D&&e.jsx("span",{"data-testid":"loading-indicator",className:"ml-2",children:"..."})]}),e.jsxs(F,{variant:"outline",onClick:ce,disabled:D,className:"flex-shrink-0",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Message"]}),i&&e.jsxs(F,{variant:"ghost",size:"sm",onClick:U,disabled:D,className:"flex-shrink-0","aria-label":"Edit profile",children:[e.jsx(Dt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs(F,{variant:"ghost",size:"sm",onClick:T,disabled:D,className:"flex-shrink-0","aria-label":"Share profile",children:[e.jsx(mt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Share"})]})]})]})}),e.jsxs($,{className:"space-y-4",children:[g&&r.skills&&r.skills.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Skills"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.skills.map((A,xe)=>e.jsxs(z,{variant:"secondary",children:[e.jsx(Ft,{className:"h-3 w-3 mr-1"}),A]},xe))})]}),d&&(r.followersCount!==void 0||r.followingCount!==void 0)&&e.jsxs("div",{className:"flex items-center space-x-6 py-4 border-t",children:[r.followersCount!==void 0&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:r.followersCount.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Followers"})]}),r.followingCount!==void 0&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:r.followingCount.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Following"})]}),r.eventsCount!==void 0&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:r.eventsCount}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Events"})]})]}),u&&r.socialLinks&&e.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t",children:[r.socialLinks.twitter&&e.jsx(F,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs("a",{href:r.socialLinks.twitter,target:"_blank",rel:"noopener noreferrer","aria-label":"Twitter",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Twitter"})]})}),r.socialLinks.linkedin&&e.jsx(F,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs("a",{href:r.socialLinks.linkedin,target:"_blank",rel:"noopener noreferrer","aria-label":"LinkedIn",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"LinkedIn"})]})}),r.socialLinks.github&&e.jsx(F,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs("a",{href:r.socialLinks.github,target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub",children:[e.jsx(Mt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"GitHub"})]})}),r.socialLinks.website&&e.jsx(F,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs("a",{href:r.socialLinks.website,target:"_blank",rel:"noopener noreferrer","aria-label":"Website",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Website"})]})}),r.socialLinks.phone&&e.jsxs(F,{variant:"ghost",size:"sm",onClick:G,"aria-label":"Phone",children:[e.jsx(Tt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Phone"})]})]}),a&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(F,{variant:"outline",onClick:Ue,disabled:D,className:"w-full",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"View Full Profile"]})}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(F,{variant:"ghost",size:"sm",onClick:ee,className:Q("w-full transition-all duration-200",w&&"text-red-500 hover:text-red-600"),children:[e.jsx(Ae,{className:Q("h-4 w-4 mr-2 transition-all duration-200",w&&"fill-current")}),w?"Liked":"Like"," ",b>0&&`(${b})`]})})]})]}):f==="enterprise"?e.jsxs(O,{className:Q("relative overflow-hidden border-2 border-slate-200 bg-gradient-to-br from-slate-50 to-slate-100 shadow-xl","hover:shadow-2xl hover:border-slate-300 transition-all duration-300",h),children:[e.jsx("div",{className:"absolute top-0 right-0 bg-slate-800 text-white px-3 py-1 text-xs font-bold rounded-bl-lg",children:"ENTERPRISE"}),e.jsxs($,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(de,{className:"h-20 w-20 border-4 border-slate-200",children:[e.jsx(he,{src:r.avatar,alt:r.name}),e.jsx(me,{className:"text-lg font-bold bg-slate-700 text-white",children:r.name.split(" ").map(A=>A[0]).join("")})]}),r.isOnline&&e.jsx("div",{className:"absolute -bottom-1 -right-1 h-6 w-6 bg-green-500 border-4 border-white rounded-full"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 truncate",children:r.name}),r.verified&&e.jsxs(z,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),r.bio&&e.jsx("p",{className:"text-slate-600 text-sm mb-3 line-clamp-2",children:r.bio}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:r.eventsCount||0}),e.jsx("div",{className:"text-xs text-slate-500",children:"Events"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:r.projectsCount||0}),e.jsx("div",{className:"text-xs text-slate-500",children:"Projects"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:r.followersCount||0}),e.jsx("div",{className:"text-xs text-slate-500",children:"Followers"})]})]}),g&&r.skills&&r.skills.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Key Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.skills.slice(0,4).map((A,xe)=>e.jsx(z,{variant:"outline",className:"text-xs bg-slate-100 border-slate-300",children:A},xe)),r.skills.length>4&&e.jsxs(z,{variant:"outline",className:"text-xs bg-slate-100 border-slate-300",children:["+",r.skills.length-4," more"]})]})]})]})]}),c&&e.jsxs("div",{className:"flex space-x-2 mt-4 pt-4 border-t border-slate-200",children:[e.jsxs(F,{size:"sm",className:"flex-1 bg-slate-800 hover:bg-slate-900",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"View Profile"]}),e.jsxs(F,{size:"sm",variant:"outline",className:"border-slate-300",children:[e.jsx(At,{className:"h-4 w-4 mr-2"}),"Contact"]})]})]})]}):f==="dark"?e.jsxs(O,{className:Q("relative overflow-hidden border border-slate-700 bg-gradient-to-br from-slate-900 to-slate-800 text-white shadow-2xl","hover:shadow-slate-900/50 hover:border-slate-600 transition-all duration-300",h),children:[e.jsx("div",{className:"absolute top-0 right-0 bg-slate-600 text-slate-200 px-3 py-1 text-xs font-bold rounded-bl-lg",children:"DARK"}),e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(de,{className:"h-20 w-20 border-4 border-slate-600 ring-2 ring-slate-500",children:[e.jsx(he,{src:r.avatar,alt:V}),e.jsx(me,{className:"bg-slate-700 text-slate-200 text-xl font-bold",children:V.charAt(0)})]}),r.isOnline&&e.jsx("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-green-500 border-2 border-slate-800 rounded-full"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white truncate",children:V}),r.verified&&e.jsxs(z,{className:"bg-blue-600 text-white text-xs",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"Verified"]}),r.isPremium&&e.jsxs(z,{className:"bg-amber-600 text-white text-xs",children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),"Premium"]})]}),ie&&e.jsx("p",{className:"text-slate-300 text-sm mb-3 line-clamp-2",children:ie}),J&&e.jsxs("div",{className:"flex items-center text-slate-400 text-sm mb-3",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),J]})]})}),d&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.followersCount||0}),e.jsx("div",{className:"text-xs text-slate-400",children:"Followers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.followingCount||0}),e.jsx("div",{className:"text-xs text-slate-400",children:"Following"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.eventsCount||0}),e.jsx("div",{className:"text-xs text-slate-400",children:"Events"})]})]}),g&&r.skills&&r.skills.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.skills.slice(0,3).map((A,xe)=>e.jsx(z,{variant:"secondary",className:"bg-slate-700 text-slate-200 border-slate-600",children:A},xe)),r.skills.length>3&&e.jsxs(z,{variant:"secondary",className:"bg-slate-700 text-slate-200 border-slate-600",children:["+",r.skills.length-3," more"]})]})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[t&&e.jsxs(F,{variant:r.isFollowing?"default":"outline",size:"sm",onClick:W,disabled:D,className:Q("flex-1",r.isFollowing?"bg-slate-600 hover:bg-slate-700 text-white":"border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white"),children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),r.isFollowing?"Following":"Follow"]}),s&&e.jsxs(F,{variant:"outline",size:"sm",onClick:ce,disabled:D,className:"border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Message"]})]})]})]})})]}):null},ss=({users:r,variant:t="default",layout:s="grid",showSearch:a=!0,showFilters:n=!0,showTabs:i=!0,className:l,loading:c=!1,error:d=null,onUserAction:u,onFollow:g,onMessage:y,onViewProfile:h,onShare:f,onEdit:j,onContact:C})=>{const[k,I]=o.useState(""),[M,H]=o.useState("all"),[D,L]=o.useState("name"),[R,p]=o.useState(!1),[m,v]=o.useState(!1),[w,E]=o.useState(!1),b=o.useMemo(()=>{let N=r;switch(k.trim()&&(N=N.filter(_=>{var W,ce;return _.name.toLowerCase().includes(k.toLowerCase())||((W=_.bio)==null?void 0:W.toLowerCase().includes(k.toLowerCase()))||((ce=_.location)==null?void 0:ce.toLowerCase().includes(k.toLowerCase()))})),M){case"verified":N=N.filter(_=>_.verified);break;case"online":N=N.filter(_=>_.isOnline);break;case"premium":N=N.filter(_=>_.isPremium);break;case"trending":N=N.filter(_=>{var W;return(W=_.badges)==null?void 0:W.includes("trending")});break;case"featured":N=N.filter(_=>_.isFeatured);break}return R&&(N=N.filter(_=>_.verified)),m&&(N=N.filter(_=>_.isOnline)),w&&(N=N.filter(_=>_.isPremium)),N.sort((_,W)=>{switch(D){case"name":return _.name.localeCompare(W.name);case"followers":return(W.followersCount||0)-(_.followersCount||0);case"rating":return(W.rating||0)-(_.rating||0);case"recent":return new Date(W.joinDate||"").getTime()-new Date(_.joinDate||"").getTime();default:return 0}}),N},[r,k,M,D,R,m,w]),P=o.useCallback((N,_,W)=>x(null,null,function*(){if(u)try{yield u(N,_,W)}catch(ce){console.error(`Failed to perform action ${_}:`,ce)}}),[u]),ee=o.useCallback(N=>x(null,null,function*(){g&&(yield g(N)),yield P(N,"follow")}),[g,P]),ae=o.useCallback(N=>x(null,null,function*(){y&&(yield y(N)),yield P(N,"message")}),[y,P]),V=o.useCallback(N=>x(null,null,function*(){h&&(yield h(N)),yield P(N,"view_profile")}),[h,P]),ie=o.useCallback(N=>x(null,null,function*(){f&&(yield f(N)),yield P(N,"share")}),[f,P]),J=o.useCallback(N=>x(null,null,function*(){j&&(yield j(N)),yield P(N,"edit")}),[j,P]),ge=o.useCallback(N=>x(null,null,function*(){C&&(yield C(N)),yield P(N,"contact")}),[C,P]);if(c)return e.jsx("div",{className:Q("space-y-4",l),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((N,_)=>e.jsxs(O,{className:"animate-pulse",children:[e.jsx(ne,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-32"}),e.jsx("div",{className:"h-3 bg-muted rounded w-24"})]})]})}),e.jsxs($,{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-muted rounded w-full"}),e.jsx("div",{className:"h-3 bg-muted rounded w-3/4"})]})]},_))})});if(d)return e.jsx(O,{className:Q("w-full",l),children:e.jsx($,{className:"p-6 text-center",children:e.jsxs("div",{className:"text-destructive",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Users"}),e.jsx("p",{className:"text-muted-foreground",children:d})]})})});if(b.length===0)return e.jsx(O,{className:Q("w-full",l),children:e.jsx($,{className:"p-6 text-center",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Users Found"}),e.jsx("p",{className:"mb-4",children:k?`No users match "${k}"`:"No users available"}),k&&e.jsx(F,{variant:"outline",onClick:()=>I(""),children:"Clear Search"})]})})});const te=()=>{const N=b.map(_=>e.jsx(Se,{user:_,variant:t,onFollow:ee,onMessage:ae,onViewProfile:V,onShare:ie,onEdit:J,onContact:ge,showActions:!0,showStats:t!=="minimal",showSocialLinks:t==="detailed"||t==="premium"||t==="featured",showSkills:t==="detailed"||t==="premium"||t==="featured",showInterests:t==="featured",animate:!0,interactive:!0},_.id));switch(s){case"grid":return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:N});case"list":return e.jsx("div",{className:"space-y-3",children:N});case"cards":return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N});case"enterprise":return e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:r.map(_=>e.jsx(Se,{user:_,variant:"enterprise",showActions:!0,showStats:!0,showSkills:!0,onFollow:g,onMessage:y,onViewProfile:h,onShare:f,onEdit:j,onContact:C,className:"h-full"},_.id))});case"dark":return e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:r.map(_=>e.jsx(Se,{user:_,variant:"dark",showActions:!0,showStats:!0,showSkills:!0,onFollow:g,onMessage:y,onViewProfile:h,onShare:f,onEdit:j,onContact:C,className:"h-full"},_.id))});default:return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N})}};return e.jsxs("div",{className:Q("space-y-6",l),children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Users"}),e.jsxs("p",{className:"text-muted-foreground",children:[b.length," of ",r.length," users"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{variant:s==="grid"?"default":"outline",size:"sm",onClick:()=>L("name"),children:e.jsx(Rt,{className:"h-4 w-4"})}),e.jsx(F,{variant:s==="list"?"default":"outline",size:"sm",onClick:()=>L("name"),children:e.jsx(Ut,{className:"h-4 w-4"})})]})]}),(a||n)&&e.jsxs(O,{children:[e.jsx(ne,{children:e.jsx(fe,{className:"text-lg",children:"Search & Filters"})}),e.jsxs($,{className:"space-y-4",children:[a&&e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(_e,{placeholder:"Search users by name, bio, or location...",value:k,onChange:N=>I(N.target.value),className:"pl-10"})]}),n&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(F,{variant:R?"default":"outline",size:"sm",onClick:()=>p(!R),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Verified"]}),e.jsxs(F,{variant:m?"default":"outline",size:"sm",onClick:()=>v(!m),children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Online"]}),e.jsxs(F,{variant:w?"default":"outline",size:"sm",onClick:()=>E(!w),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Premium"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),e.jsxs("select",{value:D,onChange:N=>L(N.target.value),className:"px-3 py-1 border rounded-md text-sm",children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"followers",children:"Followers"}),e.jsx("option",{value:"rating",children:"Rating"}),e.jsx("option",{value:"recent",children:"Recently Joined"})]})]})]})]}),i&&e.jsxs(tt,{value:M,onValueChange:H,children:[e.jsxs(st,{className:"grid w-full grid-cols-6",children:[e.jsx(K,{value:"all",children:"All"}),e.jsxs(K,{value:"verified",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Verified"]}),e.jsxs(K,{value:"online",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Online"]}),e.jsxs(K,{value:"premium",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Premium"]}),e.jsxs(K,{value:"trending",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Trending"]}),e.jsxs(K,{value:"featured",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Featured"]})]}),e.jsx(X,{value:"all",className:"mt-6",children:te()}),e.jsx(X,{value:"verified",className:"mt-6",children:te()}),e.jsx(X,{value:"online",className:"mt-6",children:te()}),e.jsx(X,{value:"premium",className:"mt-6",children:te()}),e.jsx(X,{value:"trending",className:"mt-6",children:te()}),e.jsx(X,{value:"featured",className:"mt-6",children:te()})]}),!i&&te()]})};function as({users:r,variant:t="default",onReorder:s,onUserAction:a,onFollow:n,onMessage:i,onViewProfile:l,onShare:c,onEdit:d,onContact:u,className:g,showDragHandles:y=!0,allowReordering:h=!0}){const[f,j]=o.useState(r),[C,k]=o.useState(null),[I,M]=o.useState(null),H=o.useCallback((w,E)=>{if(!h)return;k(E),w.dataTransfer&&(w.dataTransfer.effectAllowed="move",w.dataTransfer.setData("text/html",E.toString()));const b=w.target;b.style.opacity="0.5"},[h]),D=o.useCallback((w,E)=>{!h||C===null||(w.preventDefault(),w.dataTransfer&&(w.dataTransfer.dropEffect="move"),I!==E&&M(E))},[h,C,I]),L=o.useCallback(w=>{w.preventDefault(),M(null)},[]),R=o.useCallback((w,E)=>{if(!h||C===null)return;w.preventDefault();const b=[...f],[P]=b.splice(C,1);b.splice(E,0,P),j(b),k(null),M(null);const ee=w.target;ee.style.opacity="1",s==null||s(b)},[h,C,f,s]),p=o.useCallback(w=>{k(null),M(null);const E=w.target;E.style.opacity="1"},[]),m=o.useCallback(()=>{const w=[...f].sort(()=>Math.random()-.5);j(w),s==null||s(w)},[f,s]),v=o.useCallback(()=>{j(r),s==null||s(r)},[r,s]);return e.jsxs("div",{className:Q("space-y-4",g),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[f.length," users"]}),h&&e.jsx(z,{variant:"secondary",className:"text-xs",children:"Drag to reorder"})]}),h&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:"outline",size:"sm",onClick:m,className:"text-xs",children:[e.jsx(Pt,{className:"h-3 w-3 mr-1"}),"Shuffle"]}),e.jsx(F,{variant:"outline",size:"sm",onClick:v,className:"text-xs",children:"Reset"})]})]}),e.jsx("div",{className:"space-y-3",children:f.map((w,E)=>e.jsx(O,B(q({className:Q("transition-all duration-200 cursor-move","hover:shadow-md hover:scale-[1.01]",C===E&&"opacity-50 scale-95",I===E&&"ring-2 ring-primary/50 ring-offset-2",!h&&"cursor-default")},h?{draggable:!0}:{}),{onDragStart:b=>H(b,E),onDragOver:b=>D(b,E),onDragLeave:L,onDrop:b=>R(b,E),onDragEnd:p,"data-testid":"user-card",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[y&&h&&e.jsx("div",{className:"flex-shrink-0 text-muted-foreground hover:text-foreground transition-colors","data-testid":"drag-handle",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1",children:e.jsx(Se,{user:w,variant:t,showActions:!0,showStats:!1,showSkills:!1,onFollow:n,onMessage:i,onViewProfile:l,onShare:c,onEdit:d,onContact:u,className:"border-0 shadow-none p-0"})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(z,{variant:"outline",className:"text-xs",children:["#",E+1]})})]})})}),w.id))})]})}function rs({users:r,variant:t="default",height:s=600,itemHeight:a=120,onUserAction:n,onFollow:i,onMessage:l,onViewProfile:c,onShare:d,onEdit:u,onContact:g,className:y,showSearch:h=!0,showFilters:f=!0,showSorting:j=!0,enableVirtualization:C=!0}){const[k,I]=o.useState(r),[M,H]=o.useState(r),[D,L]=o.useState(""),[R,p]=o.useState("name"),[m,v]=o.useState("asc"),[w,E]=o.useState(new Set),b=o.useRef(null),[P,ee]=o.useState(0),ae=o.useMemo(()=>{let T=[...r];if(D){const U=D.toLowerCase();T=T.filter(G=>{var Y,re,A;return G.name.toLowerCase().includes(U)||((Y=G.bio)==null?void 0:Y.toLowerCase().includes(U))||((re=G.location)==null?void 0:re.toLowerCase().includes(U))||((A=G.skills)==null?void 0:A.some(xe=>xe.toLowerCase().includes(U)))})}return w.size>0&&(T=T.filter(U=>!(w.has("verified")&&!U.verified||w.has("premium")&&!U.isPremium||w.has("featured")&&!U.isFeatured||w.has("online")&&!U.isOnline))),T.sort((U,G)=>{let Y,re;switch(R){case"name":Y=U.name.toLowerCase(),re=G.name.toLowerCase();break;case"followers":Y=U.followersCount||0,re=G.followersCount||0;break;case"joinDate":Y=new Date(U.joinDate||"").getTime(),re=new Date(G.joinDate||"").getTime();break;case"rating":Y=U.rating||0,re=G.rating||0;break;default:return 0}return m==="asc"?Y>re?1:-1:Y<re?1:-1}),T},[r,D,w,R,m]);o.useEffect(()=>{H(ae)},[ae]);const V=M.length*a,ie=Math.ceil(s/a)+2,J=Math.max(0,Math.floor(P/a)),ge=Math.min(M.length,J+ie),te=C?M.slice(J,ge):M,N=o.useCallback(T=>{C&&ee(T.currentTarget.scrollTop)},[C]),_=o.useCallback(T=>{L(T)},[]),W=o.useCallback(T=>{E(U=>{const G=new Set(U);return G.has(T)?G.delete(T):G.add(T),G})},[]),ce=o.useCallback(T=>{R===T?v(U=>U==="asc"?"desc":"asc"):(p(T),v("asc"))},[R]),Ue=o.useCallback((T,U)=>{const G=C?J+U:U,Y=C?G*a:0;return e.jsx("div",{className:"w-full",style:C?{position:"absolute",top:Y,height:a}:void 0,children:e.jsx(O,{className:"h-full mx-2 mb-2 transition-all duration-200 hover:shadow-md",children:e.jsx($,{className:"p-4",children:e.jsx(Se,{user:T,variant:t,showActions:!0,showStats:!1,showSkills:!1,onFollow:i,onMessage:l,onViewProfile:c,onShare:d,onEdit:u,onContact:g,className:"border-0 shadow-none p-0"})})})},T.id)},[J,a,C,t,i,l,c,d,u,g]);return e.jsxs("div",{className:Q("space-y-4",y),children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[M.length," of ",r.length," users"]}),C&&e.jsx(z,{variant:"secondary",className:"text-xs",children:"Virtualized"})]})}),h&&e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(_e,{placeholder:"Search users by name, bio, location, or skills...",value:D,onChange:T=>_(T.target.value),className:"pl-10"})]}),(f||j)&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Filters:"}),["verified","premium","featured","online"].map(T=>e.jsxs(F,{variant:w.has(T)?"default":"outline",size:"sm",onClick:()=>W(T),className:"text-xs capitalize",children:[e.jsx(dt,{className:"h-3 w-3 mr-1"}),T]},T))]}),j&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground ml-4",children:"Sort by:"}),[{key:"name",label:"Name"},{key:"followers",label:"Followers"},{key:"joinDate",label:"Join Date"},{key:"rating",label:"Rating"}].map(({key:T,label:U})=>e.jsxs(F,{variant:R===T?"default":"outline",size:"sm",onClick:()=>ce(T),className:"text-xs",children:[U,R===T&&(m==="asc"?e.jsx(Ot,{className:"h-3 w-3 ml-1"}):e.jsx($t,{className:"h-3 w-3 ml-1"}))]},T))]})]})]}),e.jsx("div",{ref:b,className:"border rounded-lg",style:{height:s},children:e.jsx(qt,{className:"h-full",onScroll:N,children:e.jsx("div",{className:"relative w-full",style:{height:C?V:"auto"},children:te.map((T,U)=>Ue(T,U))})})})]})}const _s=()=>{const{toast:r}=yt(),{currentLocation:t}=lt(),[s,a]=o.useState("search"),[n,i]=o.useState([]),[l,c]=o.useState([]),[d,u]=o.useState([]),[g,y]=o.useState(!0),[h,f]=o.useState([]),j=o.useCallback(()=>x(null,null,function*(){try{y(!0);const{data:m,error:v}=yield S.functions.invoke("fetch-local-news",{body:{location:t?"Your Area":"Local Area",latitude:t==null?void 0:t.latitude,longitude:t==null?void 0:t.longitude,radius:50}});v?(console.error("Error fetching news:",v),i([{title:"Local Community Updates",description:"Stay connected with your local community and discover what's happening around you.",url:"#",source:"Local News",publishedAt:new Date().toISOString(),category:"General"},{title:"Community Events This Week",description:"Find exciting events and activities happening in your neighborhood this week.",url:"#",source:"Community Events",publishedAt:new Date(Date.now()-7200*1e3).toISOString(),category:"Events"}])):m&&m.news?i(m.news.slice(0,5)):i([{title:"Local Community Updates",description:"Stay connected with your local community and discover what's happening around you.",url:"#",source:"Local News",publishedAt:new Date().toISOString(),category:"General"},{title:"Community Events This Week",description:"Find exciting events and activities happening in your neighborhood this week.",url:"#",source:"Community Events",publishedAt:new Date(Date.now()-7200*1e3).toISOString(),category:"Events"}]);try{const{data:w}=yield S.from("events").select("*").gte("event_date",new Date().toISOString().split("T")[0]).order("event_date",{ascending:!0}).limit(6);w&&c(w.map(E=>({id:E.id,title:E.title,description:E.description,location:E.location_name,date:E.event_date,category:E.category,price:E.price?`$${E.price}`:"Free"})))}catch(w){console.error("Error fetching events:",w),c([{id:"1",title:"Community Meetup",description:"Join us for a friendly community gathering",location:"Local Community Center",date:new Date(Date.now()+10080*60*1e3).toISOString(),category:"Community",price:"Free"}])}}catch(m){console.error("Error fetching local content:",m),r({title:"Error",description:"Failed to load local content",variant:"destructive"})}finally{y(!1)}}),[t,r]),C=o.useCallback(()=>x(null,null,function*(){try{const{data:m}=yield S.from("events").select(`
          id,
          title,
          description,
          category,
          max_attendees,
          event_date,
          image_url
        `).gte("event_date",new Date().toISOString().split("T")[0]).order("max_attendees",{ascending:!1}).limit(3),{data:v}=yield S.from("artists").select(`
          id,
          user_id,
          specialty,
          bio
        `).eq("is_available",!0).limit(3),{data:w}=yield S.from("posts").select(`
          id,
          user_id,
          title,
          content,
          type,
          likes_count
        `).eq("status","active").order("likes_count",{ascending:!1}).limit(3),E=[...(m==null?void 0:m.map(b=>({id:b.id,type:"event",title:b.title,description:b.description,engagement:b.max_attendees||0,image:b.image_url})))||[],...(v==null?void 0:v.map(b=>{var P;return{id:b.id,type:"artist",title:"Artist Profile",description:b.bio||((P=b.specialty)==null?void 0:P.join(", "))||"",engagement:0,image:void 0}}))||[],...(w==null?void 0:w.map(b=>({id:b.id,type:"post",title:b.title||"Untitled Post",description:b.content.substring(0,100)+"...",engagement:b.likes_count||0,image:void 0})))||[]];u(E)}catch(m){console.error("Error fetching trending content:",m)}}),[]),k=o.useCallback(()=>x(null,null,function*(){try{f([{id:"user-1",name:"Sarah Johnson",email:"sarah@example.com",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=200&h=200&fit=crop&",bio:"Event organizer and community builder passionate about bringing people together",location:"San Francisco, CA",verified:!0,followersCount:2341,followingCount:189,isFollowing:!1,isOnline:!0,badges:["trending"],skills:["Event Planning","Community Management","Marketing"],interests:["Community","Events","Networking"],joinDate:"2021-08-15",eventsCount:23,projectsCount:12,isPremium:!0,isFeatured:!1},{id:"user-2",name:"Michael Chen",email:"michael@example.com",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&",bio:"Tech entrepreneur and startup mentor helping others build successful businesses",location:"Austin, TX",verified:!0,followersCount:5678,followingCount:234,isFollowing:!0,isOnline:!1,badges:["trending"],skills:["Startup Strategy","Product Development","Investor Relations"],interests:["Technology","Business","Innovation"],joinDate:"2020-12-01",eventsCount:45,projectsCount:18,isPremium:!0,isFeatured:!0},{id:"user-3",name:"Emma Rodriguez",email:"emma@example.com",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=200&h=200&fit=crop&",bio:"Creative designer and artist exploring the intersection of art and technology",location:"Portland, OR",verified:!1,followersCount:892,followingCount:456,isFollowing:!1,isOnline:!0,badges:[],skills:["UI/UX Design","Digital Art","Creative Direction"],interests:["Art","Design","Technology"],joinDate:"2023-01-20",eventsCount:8,projectsCount:5,isPremium:!1,isFeatured:!1},{id:"user-4",name:"David Kim",email:"david@example.com",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=200&h=200&fit=crop&",bio:"Fitness coach and wellness advocate promoting healthy lifestyles",location:"Miami, FL",verified:!0,followersCount:3456,followingCount:123,isFollowing:!1,isOnline:!1,badges:["trending"],skills:["Personal Training","Nutrition","Wellness Coaching"],interests:["Fitness","Health","Wellness"],joinDate:"2022-06-10",eventsCount:32,projectsCount:14,isPremium:!0,isFeatured:!1}])}catch(m){console.error("Error fetching discovered users:",m),r({title:"Error",description:"Failed to load discovered users",variant:"destructive"})}}),[r]);o.useEffect(()=>{j(),C(),k()},[j,C,k]);const I=o.useCallback((m,v,w)=>x(null,null,function*(){switch(console.log(`User action: ${v} for user ${m}`,w),v){case"follow":r({title:"Success",description:"You are now following this user"});break;case"message":r({title:"Message",description:"Opening message composer..."});break;case"view_profile":r({title:"Profile",description:"Navigating to user profile..."});break;case"share":r({title:"Share",description:"Sharing user profile..."});break;case"edit":r({title:"Edit",description:"Opening profile editor..."});break;case"contact":r({title:"Contact",description:"Opening contact options..."});break}}),[r]),M=o.useCallback(m=>x(null,null,function*(){try{f(v=>v.map(w=>w.id===m?B(q({},w),{isFollowing:!w.isFollowing}):w)),r({title:"Success",description:"Follow status updated"})}catch(v){r({title:"Error",description:"Failed to update follow status",variant:"destructive"})}}),[r]),H=o.useCallback(m=>x(null,null,function*(){r({title:"Message",description:"Opening message composer..."})}),[r]),D=o.useCallback(m=>x(null,null,function*(){r({title:"Profile",description:"Navigating to user profile..."})}),[r]),L=o.useCallback(m=>x(null,null,function*(){r({title:"Share",description:"Sharing user profile..."})}),[r]),R=o.useCallback(m=>x(null,null,function*(){r({title:"Edit",description:"Opening profile editor..."})}),[r]),p=o.useCallback(m=>x(null,null,function*(){r({title:"Contact",description:"Opening contact options..."})}),[r]);return e.jsx(Nt,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-center mb-4",children:"Discover Your Community"}),e.jsx("p",{className:"text-xl text-center text-muted-foreground max-w-3xl mx-auto",children:"Connect with amazing people, discover local events, and explore trending content in your area"})]}),e.jsxs(tt,{value:s,onValueChange:a,className:"w-full",children:[e.jsxs(st,{className:"grid w-full grid-cols-7",children:[e.jsx(K,{value:"overview",children:"Overview"}),e.jsx(K,{value:"users",children:"People"}),e.jsx(K,{value:"events",children:"Events"}),e.jsx(K,{value:"trending",children:"Trending"}),e.jsx(K,{value:"recommendations",children:"Recommendations"}),e.jsx(K,{value:"draggable",children:"Draggable"}),e.jsx(K,{value:"virtualized",children:"Virtualized"})]}),e.jsx(X,{value:"search",className:"space-y-6",children:e.jsx(Vt,{})}),e.jsxs(X,{value:"users",className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Discover Amazing People"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with verified professionals, creators, and community leaders"})]}),e.jsxs(O,{children:[e.jsxs(ne,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-yellow-500"}),"Featured Users"]}),e.jsx(Me,{children:"Premium and verified users you might want to connect with"})]}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:h.filter(m=>m.isPremium||m.isFeatured).map(m=>e.jsx(Se,{user:m,variant:m.isFeatured?"featured":"premium",onFollow:M,onMessage:H,onViewProfile:D,onShare:L,onEdit:R,onContact:p,showActions:!0,showStats:!0,showSocialLinks:!0,showSkills:!0,showInterests:!0,animate:!0,interactive:!0},m.id))})})]}),e.jsxs(O,{children:[e.jsxs(ne,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"All Users"]}),e.jsx(Me,{children:"Browse and discover users in your community"})]}),e.jsx($,{children:e.jsx(ss,{users:h,variant:"compact",layout:"grid",showSearch:!0,showFilters:!0,showTabs:!0,onUserAction:I,onFollow:M,onMessage:H,onViewProfile:D,onShare:L,onEdit:R,onContact:p})})]})]}),e.jsxs(X,{value:"events",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Nearby Events"}),e.jsx(F,{variant:"outline",onClick:()=>window.location.href="/events",children:"View All Events"})]}),g?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((m,v)=>e.jsxs(O,{className:"animate-pulse",children:[e.jsx(ne,{children:e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"})}),e.jsxs($,{children:[e.jsx("div",{className:"h-3 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})]},v))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(m=>e.jsxs(O,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(ne,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{variant:"outline",children:m.category}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:m.price})]}),e.jsx(fe,{className:"text-lg",children:m.title})]}),e.jsxs($,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:m.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:m.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:Re(new Date(m.date),"MMM dd, yyyy")})]})]})]})]},m.id))})]}),e.jsx(X,{value:"trending",className:"space-y-6",children:e.jsx(Jt,{})}),e.jsxs(X,{value:"recommendations",className:"space-y-6",children:[e.jsx(Zt,{}),e.jsx(ts,{})]}),e.jsx(X,{value:"draggable",className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Interactive User List"}),e.jsx("p",{className:"text-muted-foreground",children:"Drag and drop users to reorder them. Use the shuffle button to randomize the order."})]}),e.jsxs(O,{children:[e.jsxs(ne,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(ht,{className:"h-5 w-5 text-blue-500"}),"Draggable Users"]}),e.jsx(Me,{children:"Drag users to reorder them. Click shuffle to randomize the order."})]}),e.jsx($,{children:e.jsx(as,{users:h,variant:"compact",onReorder:m=>{f(m),r({title:"Users Reordered",description:"The user list has been updated with the new order."})},onFollow:M,onMessage:H,onViewProfile:D,onShare:L,onEdit:R,onContact:p,showDragHandles:!0,allowReordering:!0})})]})]})}),e.jsx(X,{value:"virtualized",className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"High-Performance User List"}),e.jsx("p",{className:"text-muted-foreground",children:"This list uses virtualization to handle large datasets efficiently. Only visible items are rendered."})]}),e.jsxs(O,{children:[e.jsxs(ne,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(zt,{className:"h-5 w-5 text-green-500"}),"Virtualized Users"]}),e.jsx(Me,{children:"High-performance list with search, filtering, and sorting capabilities."})]}),e.jsx($,{children:e.jsx(rs,{users:h,variant:"dark",height:600,itemHeight:120,onFollow:M,onMessage:H,onViewProfile:D,onShare:L,onEdit:R,onContact:p,showSearch:!0,showFilters:!0,showSorting:!0,enableVirtualization:!0})})]})]})})]})]})})};export{_s as default};
