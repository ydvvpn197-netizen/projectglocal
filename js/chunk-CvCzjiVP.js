const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ConsolidatedIndex.tsx-Bb0Syarj.js","js/chunk-COTa-BBv.js","js/chunk-DvlvDbdf.js","js/chunk-BlluHz2J.js","js/chunk-DJzzOJWe.js","js/chunk-BA32w1ww.js","js/main-BMj1NFFE.js","css/main-MAizy_pB.css","js/ResponsiveLayout.tsx-wqK2pe-W.js","js/AnimatedCard.tsx-Kx8XRBok.js","js/chunk-COG8KeUH.js","js/chunk-BCSLz2CJ.js","js/chunk-mExNus9E.js","js/chunk-BzTmHFr7.js","js/chunk-BHNn8WBs.js","js/chunk-CasIWBEQ.js","js/chunk-C4jjqBrH.js","js/chunk-DYZWJdwa.js","js/chunk-DmQrF9DI.js","js/chunk-Bqzn8EJ-.js","js/ConsolidatedEvents.tsx-BZF-saaQ.js","js/chunk-BQur_cHm.js","js/chunk-Caym9pUi.js","js/chunk-DAuIGAgW.js","js/chunk-DkS-Khix.js","js/EventDetails.tsx-CZWEf16R.js","js/chunk-CKr6gYyv.js","js/chunk-egW852rZ.js","js/chunk-UbFD0_dp.js","js/chunk-qg8sq3rE.js","js/chunk-D-G76ObT.js","js/CreateEvent.tsx-CV5o1urZ.js","js/chunk-CE0O3dYU.js","js/ConsolidatedCommunity.tsx-CVRZpEPK.js","js/ConsolidatedProfile.tsx-CCfg6aSB.js","js/chunk-BXmsKp86.js","js/chunk-DPjdzSDe.js","js/chunk-BPfgVWOI.js","js/chunk-CrtaOutE.js","js/Messages.tsx-CS7dIGPU.js","js/NotificationsPage.tsx-0bmCqOk0.js","js/chunk-B55Wu1Wu.js","js/chunk-DHZUcEJV.js","js/ConsolidatedSettings.tsx-CktvtEgA.js","js/About.tsx-Biwnep9H.js","js/Discover.tsx-Didog-K4.js","js/chunk-DQqbdQUG.js","js/chunk-Drm-sIqC.js","js/News.tsx-ByrpDFAd.js","js/chunk-DQMKfNBV.js","js/ConsolidatedFeed.tsx-KaXQrKSM.js","js/chunk-CtVZ7_EZ.js","js/ConsolidatedDashboard.tsx-DidgyUCs.js","js/chunk-BcC6xPGe.js","js/SignIn.tsx-sHUbYp-a.js","js/SignUp.tsx-pczdP65A.js","js/ConsolidatedCommunityInsights.tsx-AQQtMprj.js","js/LegalAssistant.tsx-C7S9feei.js","js/LifeWish.tsx-BZXnxCDe.js"])))=>i.map(i=>d[i]);
var Y=Object.defineProperty;var B=(n,s,r)=>s in n?Y(n,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[s]=r;var U=(n,s,r)=>B(n,typeof s!="symbol"?s+"":s,r);var c=(n,s,r)=>new Promise((o,u)=>{var p=_=>{try{i(r.next(_))}catch(g){u(g)}},v=_=>{try{i(r.throw(_))}catch(g){u(g)}},i=_=>_.done?o(_.value):Promise.resolve(_.value).then(p,v);i((r=r.apply(n,s)).next())});import{W as d}from"./chunk-BlluHz2J.js";import{r as t,u as G,j as e,L as J,N as z,l as K,m as Q,i as X,k as l}from"./chunk-COTa-BBv.js";import{a as q,C as O,b as V,c as Z,d as ee,E as se}from"./main-BMj1NFFE.js";import{s as x}from"./chunk-CasIWBEQ.js";const y=class y{static getInstance(){return y.instance||(y.instance=new y),y.instance}getUserRole(){return c(this,null,function*(){const{data:{user:s}}=yield x.auth.getUser();if(!s)return null;const{data:r,error:o}=yield x.from("roles").select("role").eq("user_id",s.id).single();return o?(console.error("Error fetching user role:",o),null):(r==null?void 0:r.role)||"user"})}isAdmin(){return c(this,null,function*(){const s=yield this.getUserRole();return s==="admin"||s==="super_admin"})}isSuperAdmin(){return c(this,null,function*(){return(yield this.getUserRole())==="super_admin"})}isModerator(){return c(this,null,function*(){const s=yield this.getUserRole();return s==="moderator"||s==="admin"||s==="super_admin"})}hasRole(s){return c(this,null,function*(){const r=yield this.getUserRole();if(!r)return!1;const o={user:0,moderator:1,admin:2,super_admin:3};return o[r]>=o[s]})}getAllUsersWithRoles(){return c(this,null,function*(){const{data:s,error:r}=yield x.from("admin_dashboard").select("*").order("role_created_at",{ascending:!1});if(r)throw r;return s||[]})}promoteUser(s,r){return c(this,null,function*(){const{data:o,error:u}=yield x.rpc("promote_user_to_admin",{target_user_id:s,new_role:r});if(u)throw u})}demoteUser(s){return c(this,null,function*(){const{data:r,error:o}=yield x.rpc("demote_user",{target_user_id:s});if(o)throw o})}getAuditLogs(s=50,r=0){return c(this,null,function*(){const{data:o,error:u}=yield x.from("audit_logs").select(`
        *,
        admin_user:admin_user_id (
          email,
          profiles (
            display_name,
            avatar_url
          )
        )
      `).order("created_at",{ascending:!1}).range(r,r+s-1);if(u)throw u;return o||[]})}logAdminAction(s,r,o,u){return c(this,null,function*(){const{error:p}=yield x.rpc("log_admin_action",{action_type:s,target_type:r,target_uuid:o,action_details:u,client_ip:null,client_user_agent:null});p&&console.error("Error logging admin action:",p)})}canEditEvent(s){return c(this,null,function*(){const{data:{user:r}}=yield x.auth.getUser();return r?r.id===s?!0:yield this.isAdmin():!1})}canDeleteEvent(s){return c(this,null,function*(){return yield this.canEditEvent(s)})}canFeatureEvent(){return c(this,null,function*(){return yield this.isAdmin()})}canModerateContent(){return c(this,null,function*(){return yield this.isModerator()})}canAccessAdminPanel(){return c(this,null,function*(){return yield this.isAdmin()})}canManageUsers(){return c(this,null,function*(){return yield this.isSuperAdmin()})}getRoleDisplayName(s){return{user:"User",moderator:"Moderator",admin:"Administrator",super_admin:"Super Administrator"}[s]}getRoleColor(s){return{user:"gray",moderator:"blue",admin:"green",super_admin:"purple"}[s]}getRoleDescription(s){return{user:"Regular user with basic permissions",moderator:"Can moderate content and manage community",admin:"Can manage events, users, and platform settings",super_admin:"Full platform access including user management"}[s]}getRolePermissions(s){return{user:["create_events","edit_own_events","delete_own_events","create_posts","comment_on_posts","like_content","use_legal_assistant","create_life_wishes"],moderator:["all_user_permissions","moderate_content","delete_any_posts","ban_users","manage_reports"],admin:["all_moderator_permissions","feature_events","manage_events","access_admin_panel","view_analytics","manage_platform_settings"],super_admin:["all_admin_permissions","manage_users","promote_users","demote_users","view_audit_logs","full_platform_control"]}[s]}};U(y,"instance");let L=y;const Ne=L.getInstance(),te={getUserPlanInfo(n){return c(this,null,function*(){return{is_premium:!1,plan_type:"free",can_create_services:!1,can_feature_events:!1,features:[]}})}};function M(n){return{user:{canCreatePosts:!0,canEditPosts:!1,canDeletePosts:!1,canModerateContent:!1,canManageUsers:!1,canAccessAnalytics:!1,canManageSettings:!1,canAccessAdminPanel:!1},artist:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!1,canModerateContent:!1,canManageUsers:!1,canAccessAnalytics:!1,canManageSettings:!1,canAccessAdminPanel:!1},moderator:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!0,canModerateContent:!0,canManageUsers:!1,canAccessAnalytics:!0,canManageSettings:!1,canAccessAdminPanel:!1},admin:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!0,canModerateContent:!0,canManageUsers:!0,canAccessAnalytics:!0,canManageSettings:!0,canAccessAdminPanel:!0},super_admin:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!0,canModerateContent:!0,canManageUsers:!0,canAccessAnalytics:!0,canManageSettings:!0,canAccessAdminPanel:!0}}[n]}function I(){const{user:n}=q(),[s,r]=t.useState({hasRole:!1,role:null,permissions:M("user")}),[o,u]=t.useState(!0),[p,v]=t.useState(null),[i,_]=t.useState(null),[g,w]=t.useState(!0),[F,T]=t.useState(null),P=t.useCallback(()=>c(null,null,function*(){if(!n){r({hasRole:!1,role:null,permissions:M("user")}),u(!1);return}try{u(!0),v(null);const a=yield L.checkUserRole(n.id);r(a)}catch(a){v(a instanceof Error?a.message:"Failed to fetch role"),r({hasRole:!1,role:null,permissions:M("user")})}finally{u(!1)}}),[n]),A=t.useCallback(()=>c(null,null,function*(){if(!n){_(null),w(!1);return}try{w(!0),T(null);const a=yield te.getUserPlanInfo(n.id);_(a)}catch(a){console.error("Error loading user plan info:",a),T(a instanceof Error?a.message:"Failed to load plan information")}finally{w(!1)}}),[n]);t.useEffect(()=>{P(),A()},[P,A]);const j=s.role==="admin"||s.role==="super_admin",E=s.role==="super_admin",S=s.role==="moderator"||j,R=(i==null?void 0:i.is_premium)||!1,N=t.useMemo(()=>({canCreateServices:(i==null?void 0:i.can_create_services)||!1,canFeatureEvents:(i==null?void 0:i.can_feature_events)||!1,canAccessAnalytics:(i==null?void 0:i.is_premium)||!1,canModerateContent:S,canManageUsers:j,canAccessAPI:(i==null?void 0:i.is_premium)||!1,canCreatePolls:(i==null?void 0:i.is_premium)||!1,canAccessVoiceControl:(i==null?void 0:i.is_premium)||!1}),[i,S,j]),C=t.useCallback(a=>{if(!s.hasRole)return!1;const m={user:0,artist:1,moderator:2,admin:3,super_admin:4},h=m[s.role||"user"],b=m[a];return h>=b},[s]),k=t.useCallback(a=>s.permissions[a]||!1,[s.permissions]),D=t.useCallback(a=>N[a]||!1,[N]),H=t.useCallback(a=>{if(o||g)return{hasAccess:!1,loading:!0};if(!n)return{hasAccess:!1,loading:!1,reason:"Not authenticated"};const m=[],h=[];if(a.requiredRole){const f=C(a.requiredRole);m.push(f),f||h.push(`Requires ${a.requiredRole} role`)}if(a.requiredPermission){const f=k(a.requiredPermission);m.push(f),f||h.push(`Requires ${a.requiredPermission} permission`)}if(a.requiredProPermission){const f=D(a.requiredProPermission);m.push(f),f||h.push(`Requires ${a.requiredProPermission} pro permission`)}a.requireAdmin&&(m.push(j),j||h.push("Requires admin access")),a.requireSuperAdmin&&(m.push(E),E||h.push("Requires super admin access")),a.requirePro&&(m.push(R),R||h.push("Requires pro subscription"));const b=m.length===0?!0:a.requireAny?m.some(f=>f):m.every(f=>f);return{hasAccess:b,loading:!1,reason:b?void 0:h.join(", ")}},[o,g,n,C,k,D,j,E,R]),$=t.useCallback(()=>c(null,null,function*(){yield Promise.all([P(),A()])}),[P,A]),W=t.useCallback(()=>c(null,null,function*(){yield A()}),[A]);return{role:s.role,hasRole:s.hasRole,permissions:s.permissions,loading:o||g,error:p||F,isAdmin:j,isSuperAdmin:E,isModerator:S,proPermissions:N,isPro:R,planInfo:i,hasRequiredRole:C,hasPermission:k,hasProPermission:D,checkAccess:H,refetch:$,refreshPlanInfo:W}}function Ce(n){const{hasRequiredRole:s,loading:r}=I();return{hasRole:s(n),loading:r}}function re(){const{isAdmin:n,loading:s}=I();return{isAdmin:n,loading:s}}function ke(){const{isSuperAdmin:n,loading:s}=I();return{isSuperAdmin:n,loading:s}}const ae=({children:n,requireSuperAdmin:s=!1})=>{const{user:r,loading:o}=q(),{isAdmin:u,loading:p}=re(),v=G();return o||p?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(O,{className:"w-full max-w-md mx-4",children:e.jsxs(V,{className:"text-center py-8",children:[e.jsx(J,{className:"animate-spin h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Verifying admin access..."})]})})}):r?u?e.jsx(e.Fragment,{children:n}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs(O,{className:"w-full max-w-md mx-4",children:[e.jsxs(Z,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(K,{className:"w-6 h-6 text-red-600"})}),e.jsx(ee,{className:"text-xl font-semibold text-gray-900",children:"Administrator Access Required"})]}),e.jsx(V,{className:"text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"This page requires administrator privileges to access. You do not have sufficient permissions to view this content."}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Admin or Super Admin role required"})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-400",children:"If you believe this is an error, please contact your system administrator."})})]})})]})}):e.jsx(z,{to:"/signin",state:{from:v},replace:!0})},ne=t.lazy(()=>d(()=>import("./ConsolidatedIndex.tsx-Bb0Syarj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),ie=t.lazy(()=>d(()=>import("./ConsolidatedEvents.tsx-BZF-saaQ.js"),__vite__mapDeps([20,1,2,3,4,5,8,6,7,21,11,12,13,22,23,14,15,16,17,18,19,24,10]))),ce=t.lazy(()=>d(()=>import("./EventDetails.tsx-CZWEf16R.js"),__vite__mapDeps([25,1,2,3,4,5,8,6,7,11,12,26,23,27,28,14,15,16,17,18,29,30]))),oe=t.lazy(()=>d(()=>import("./CreateEvent.tsx-CV5o1urZ.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,21,28,27,22,8,14,15,16,17,18,11,32]))),le=t.lazy(()=>d(()=>import("./ConsolidatedCommunity.tsx-CVRZpEPK.js"),__vite__mapDeps([33,1,2,3,4,5,8,6,7,21,11,12,13,22,23,19,15,16,14,17,18,10]))),de=t.lazy(()=>d(()=>import("./ConsolidatedProfile.tsx-CCfg6aSB.js"),__vite__mapDeps([34,1,2,3,4,5,8,6,7,11,13,12,35,36,37,14,15,16,17,18,19,24,38,10]))),ue=t.lazy(()=>d(()=>import("./Messages.tsx-CS7dIGPU.js"),__vite__mapDeps([39,1,2,3,4,5,8,6,7,13,12,11,15,16]))),me=t.lazy(()=>d(()=>import("./NotificationsPage.tsx-0bmCqOk0.js"),__vite__mapDeps([40,1,2,3,4,5,6,7,11,21,13,30,41,42,15,16,10]))),fe=t.lazy(()=>d(()=>import("./ConsolidatedSettings.tsx-CktvtEgA.js"),__vite__mapDeps([43,1,2,3,4,5,8,6,7,21,28,27,12,36,37,15,16,11,29,10]))),_e=t.lazy(()=>d(()=>import("./About.tsx-Biwnep9H.js"),__vite__mapDeps([44,1,2,3,4,5,8,6,7,11]))),he=t.lazy(()=>d(()=>import("./Discover.tsx-Didog-K4.js"),__vite__mapDeps([45,1,2,3,4,5,6,7,11,13,8,17,15,16,18,21,46,22,28,12,47,30]))),pe=t.lazy(()=>d(()=>import("./News.tsx-ByrpDFAd.js"),__vite__mapDeps([48,1,2,3,4,5,8,13,6,7,21,49,32,15,16,11,12,10,23,28,35,27,29,22,46]))),xe=t.lazy(()=>d(()=>import("./ConsolidatedFeed.tsx-KaXQrKSM.js"),__vite__mapDeps([50,1,2,3,4,5,8,6,7,12,51,11,32,15,16,18,41,30,13,42,21,10,19,14,17,38,24]))),ge=t.lazy(()=>d(()=>import("./ConsolidatedDashboard.tsx-DidgyUCs.js"),__vite__mapDeps([52,1,2,3,4,5,53,6,7,11,12,41,51,32,15,16,18,21,26,49,10,42,13,35,47,22]))),je=t.lazy(()=>d(()=>import("./SignIn.tsx-sHUbYp-a.js"),__vite__mapDeps([54,1,2,3,4,5,6,7,21,28,13,26,8,27,22]))),ye=t.lazy(()=>d(()=>import("./SignUp.tsx-pczdP65A.js"),__vite__mapDeps([55,1,2,3,4,5,6,7,21,28]))),ve=t.lazy(()=>d(()=>import("./ConsolidatedCommunityInsights.tsx-AQQtMprj.js"),__vite__mapDeps([56,1,2,3,4,5,6,7,13,29,28,15,16,10]))),Ae=t.lazy(()=>d(()=>import("./LegalAssistant.tsx-C7S9feei.js"),__vite__mapDeps([57,1,2,3,4,5,53,6,7,11,12,41,51,32,15,16,18,21,26,49,10,13,27,22]))),Pe=t.lazy(()=>d(()=>import("./LifeWish.tsx-BZXnxCDe.js"),__vite__mapDeps([58,1,2,3,4,5,53,6,7,11,12,41,51,32,15,16,18,21,26,49,10,13,27,22]))),Ee=()=>e.jsxs(X,{children:[e.jsx(l,{path:"/",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(ne,{})})}),e.jsx(l,{path:"/feed",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading feed..."}),children:e.jsx(xe,{})})}),e.jsx(l,{path:"/dashboard",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading dashboard..."}),children:e.jsx(ge,{})})}),e.jsx(l,{path:"/events",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading events..."}),children:e.jsx(ie,{})})}),e.jsx(l,{path:"/event/:eventId",element:e.jsx(se,{children:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading event..."}),children:e.jsx(ce,{})})})}),e.jsx(l,{path:"/create-event",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(oe,{})})}),e.jsx(l,{path:"/community",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading community..."}),children:e.jsx(le,{})})}),e.jsx(l,{path:"/profile/:userId?",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading profile..."}),children:e.jsx(de,{})})}),e.jsx(l,{path:"/messages",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading messages..."}),children:e.jsx(ue,{})})}),e.jsx(l,{path:"/notifications",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading notifications..."}),children:e.jsx(me,{})})}),e.jsx(l,{path:"/settings",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading settings..."}),children:e.jsx(fe,{})})}),e.jsx(l,{path:"/discover",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading discover..."}),children:e.jsx(he,{})})}),e.jsx(l,{path:"/news",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading news..."}),children:e.jsx(pe,{})})}),e.jsx(l,{path:"/signin",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(je,{})})}),e.jsx(l,{path:"/signup",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(ye,{})})}),e.jsx(l,{path:"/about",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading about..."}),children:e.jsx(_e,{})})}),e.jsx(l,{path:"/legal-assistant",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading legal assistant..."}),children:e.jsx(Ae,{})})}),e.jsx(l,{path:"/life-wish",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading life wishes..."}),children:e.jsx(Pe,{})})}),e.jsx(l,{path:"/community-insights",element:e.jsx(ae,{children:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading community insights..."}),children:e.jsx(ve,{})})})}),e.jsx(l,{path:"*",element:e.jsx(z,{to:"/",replace:!0})})]}),De=Object.freeze(Object.defineProperty({__proto__:null,AppRoutes:Ee},Symbol.toStringTag,{value:"Module"}));export{De as A,Ce as a,re as b,ke as c,Ne as r,I as u};
