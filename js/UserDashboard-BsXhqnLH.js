var e=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(s,i,t)=>i in s?e(s,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[i]=t,l=(e,s,i)=>new Promise((t,a)=>{var r=e=>{try{l(i.next(e))}catch(s){a(s)}},n=e=>{try{l(i.throw(e))}catch(s){a(s)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,n);l((i=i.apply(e,s)).next())});import{u as c,d as o,r as d,s as m,j as x,B as h,b as j}from"./index-BG6xRDTV.js";import{R as u}from"./ResponsiveLayout-Cy8fRDGj.js";import{C as p,a as g,b as f,d as v,c as N}from"./card-CbL4dXrv.js";import{B as b}from"./badge-B2QlhVT_.js";import{S as y}from"./separator-HAFz-71w.js";import{S as w}from"./scroll-area-HbJeSRic.js";import{D as k,e as _,a as B,b as C,c as P,d as D}from"./dialog-DLasFCgV.js";import{C as S}from"./index-Dy3819KX.js";import{U as A}from"./user-innQK5gL.js";import{f as O}from"./index-DxejKcbp.js";import{M as $}from"./map-pin-Cmdgk16n.js";import{D as E}from"./dollar-sign-djeNKARt.js";import{M}from"./message-circle-B6r7KIbR.js";import{C as q}from"./clock-zbgmrwZC.js";import{C as z}from"./check-circle-IwVTE-WC.js";import{X as U}from"./x-circle-bYxIaXGn.js";import{T,a as I,b as V,c as F}from"./tabs-DsAJelf8.js";import{A as L,a as R,b as X,i as Y}from"./sheet-D3ubJQDf.js";import{C as H}from"./calendar-days-DuxFIfH6.js";import{S as J}from"./settings-C5hGa_4W.js";import"./input-CK5tWTqm.js";import"./NotificationBell-DnloidrO.js";import"./Combination-Ca6tC3WL.js";import"./useNotifications-B1ZtpJoQ.js";import"./index-B4GyU7fY.js";import"./check-CF8HR3W6.js";import"./bell-9bXVKGDo.js";import"./NotificationButton-BhOs_94_.js";import"./search-B4Ny2Otc.js";import"./users-C0r8Z-ie.js";import"./zap-3-X3ymuv.js";import"./message-square-B4qpNpo_.js";import"./alert-yPy2QlxQ.js";import"./log-out-CsYOYMhW.js";import"./index-jVOyRz7F.js";const K=()=>{const{user:e}=c(),{toast:j}=o(),[u,T]=d.useState([]),[I,V]=d.useState(!0);d.useEffect(()=>{if(e){F();const s=m.channel("client-bookings").on("postgres_changes",{event:"UPDATE",schema:"public",table:"artist_bookings",filter:`user_id=eq.${e.id}`},()=>{F()}).subscribe();return()=>{m.removeChannel(s)}}},[e]);const F=()=>l(void 0,null,function*(){if(e)try{const{data:c,error:o}=yield m.from("artist_bookings").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(o)throw o;const d=yield Promise.all((c||[]).map(e=>l(void 0,null,function*(){var l;const{data:c}=yield m.from("profiles").select("display_name, avatar_url, artist_skills").eq("user_id",e.artist_id).single();return((e,t)=>s(e,i(t)))(((e,s)=>{for(var i in s||(s={}))a.call(s,i)&&n(e,i,s[i]);if(t)for(var i of t(s))r.call(s,i)&&n(e,i,s[i]);return e})({},e),{artist_name:(null==c?void 0:c.display_name)||"Unknown Artist",artist_avatar:(null==c?void 0:c.avatar_url)||"",artist_specialty:(null==(l=null==c?void 0:c.artist_skills)?void 0:l[0])||"Artist"})})));T(d)}catch(c){j({title:"Error",description:"Failed to load your bookings",variant:"destructive"})}finally{V(!1)}}),L=e=>{switch(e){case"pending":return x.jsx(b,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"Pending"});case"accepted":return x.jsx(b,{variant:"outline",className:"text-green-600 border-green-600",children:"Accepted"});case"declined":return x.jsx(b,{variant:"outline",className:"text-red-600 border-red-600",children:"Declined"});case"completed":return x.jsx(b,{variant:"outline",className:"text-blue-600 border-blue-600",children:"Completed"});default:return x.jsx(b,{variant:"outline",children:e})}},R=e=>{switch(e){case"pending":return x.jsx(q,{className:"h-4 w-4 text-yellow-600"});case"accepted":return x.jsx(z,{className:"h-4 w-4 text-green-600"});case"declined":return x.jsx(U,{className:"h-4 w-4 text-red-600"});case"completed":return x.jsx(z,{className:"h-4 w-4 text-blue-600"});default:return x.jsx(q,{className:"h-4 w-4"})}};return e?I?x.jsxs(p,{children:[x.jsx(g,{children:x.jsx(f,{children:"My Bookings"})}),x.jsx(v,{children:x.jsx("div",{className:"flex items-center justify-center py-8",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):x.jsxs(p,{children:[x.jsxs(g,{children:[x.jsxs(f,{className:"flex items-center gap-2",children:[x.jsx(S,{className:"h-5 w-5"}),"My Bookings"]}),x.jsx(N,{children:"View and manage your booking requests"})]}),x.jsx(v,{children:0===u.length?x.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[x.jsx(S,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),x.jsx("p",{children:"No bookings yet"}),x.jsx("p",{className:"text-sm",children:"Your booking requests will appear here"})]}):x.jsx(w,{className:"h-96",children:x.jsx("div",{className:"space-y-4",children:u.map(e=>x.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:x.jsx(A,{className:"h-5 w-5 text-primary"})}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium",children:e.artist_name}),x.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.artist_specialty," â€¢ ",O(new Date(e.created_at),"PPp")]})]})]}),L(e.status)]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:O(new Date(e.event_date),"PPP")})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx($,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{className:"truncate",children:e.event_location||"Location TBD"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:e.budget_min&&e.budget_max?`$${e.budget_min} - $${e.budget_max}`:"Budget TBD"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[R(e.status),x.jsx("span",{className:"capitalize",children:e.status})]})]}),x.jsx("div",{className:"space-y-2",children:x.jsx("p",{className:"text-sm text-muted-foreground",children:e.event_description})}),x.jsx(y,{}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs(k,{children:[x.jsx(_,{asChild:!0,children:x.jsx(h,{variant:"outline",size:"sm",children:"View Details"})}),x.jsxs(B,{children:[x.jsxs(C,{children:[x.jsx(P,{children:"Booking Details"}),x.jsx(D,{children:"Full information about this booking"})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Artist Information"}),x.jsxs("p",{children:["Name: ",e.artist_name]}),x.jsxs("p",{children:["Specialty: ",e.artist_specialty]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Event Details"}),x.jsxs("div",{className:"space-y-1 text-sm",children:[x.jsxs("p",{children:[x.jsx("strong",{children:"Date:"})," ",O(new Date(e.event_date),"PPP")]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Location:"})," ",e.event_location]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Description:"})," ",e.event_description]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Budget:"}),e.budget_min&&e.budget_max?` $${e.budget_min} - $${e.budget_max}`:" Not specified"]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Status:"})," ",x.jsx("span",{className:"capitalize",children:e.status})]})]})]})]})]})]}),x.jsxs("div",{className:"flex gap-2",children:["accepted"===e.status&&x.jsxs(h,{size:"sm",onClick:()=>window.location.href=`/chat/${e.id}`,children:[x.jsx(M,{className:"h-4 w-4 mr-1"}),"Chat with Artist"]}),"pending"===e.status&&x.jsx(h,{size:"sm",variant:"outline",onClick:()=>{j({title:"Contact Support",description:"Please contact support to cancel this booking"})},children:"Cancel Booking"})]})]})]},e.id))})})})]}):null},Q=()=>{var e,s;const{user:i}=c(),t=j(),[a,r]=d.useState({totalBookings:0,pendingBookings:0,activeBookings:0,completedBookings:0}),[n,o]=d.useState(null),[y,w]=d.useState(!0),[k,_]=d.useState("bookings");d.useEffect(()=>{i&&B()},[i]);const B=()=>l(void 0,null,function*(){if(i)try{const{data:e,error:s}=yield m.from("profiles").select("*").eq("user_id",i.id).single();if(s)throw s;o(e);const{data:t,error:a}=yield m.from("artist_bookings").select("status").eq("user_id",i.id);if(a)throw a;const n=(null==t?void 0:t.length)||0,l=(null==t?void 0:t.filter(e=>"pending"===e.status).length)||0,c=(null==t?void 0:t.filter(e=>"accepted"===e.status).length)||0,d=(null==t?void 0:t.filter(e=>"completed"===e.status).length)||0;r({totalBookings:n,pendingBookings:l,activeBookings:c,completedBookings:d})}catch(e){}finally{w(!1)}});return i?y?x.jsx(u,{children:x.jsx("div",{className:"container max-w-6xl mx-auto p-6",children:x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})}):x.jsx(u,{children:x.jsxs("div",{className:"container max-w-6xl mx-auto p-6",children:[x.jsx("div",{className:"mb-8",children:x.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[x.jsxs(L,{className:"h-16 w-16",children:[x.jsx(R,{src:null==n?void 0:n.avatar_url}),x.jsx(X,{className:"text-lg",children:(null==(e=null==n?void 0:n.display_name)?void 0:e.charAt(0))||(null==(s=i.email)?void 0:s.charAt(0))||"U"})]}),x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold",children:(null==n?void 0:n.display_name)||"User"}),x.jsx("p",{className:"text-muted-foreground",children:i.email})]})]})}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>_("bookings"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Bookings"}),x.jsx("p",{className:"text-2xl font-bold",children:a.totalBookings})]}),x.jsx(H,{className:"h-8 w-8 text-primary"})]})})}),x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>_("bookings"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pending"}),x.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:a.pendingBookings})]}),x.jsx(q,{className:"h-8 w-8 text-yellow-600"})]})})}),x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>_("bookings"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active"}),x.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.activeBookings})]}),x.jsx(z,{className:"h-8 w-8 text-green-600"})]})})}),x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>_("bookings"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),x.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.completedBookings})]}),x.jsx(Y,{className:"h-8 w-8 text-blue-600"})]})})})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/book-artist"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x.jsx(A,{className:"h-6 w-6 text-primary"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-semibold",children:"Book an Artist"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Find and book artists for your events"})]})]})})}),x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/events"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x.jsx(H,{className:"h-6 w-6 text-primary"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-semibold",children:"Browse Events"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover local events and activities"})]})]})})}),x.jsx(p,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/messages"),children:x.jsx(v,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x.jsx(M,{className:"h-6 w-6 text-primary"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-semibold",children:"Messages"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Chat with artists and organizers"})]})]})})})]}),x.jsxs(T,{value:k,onValueChange:_,className:"space-y-6",children:[x.jsxs(I,{children:[x.jsxs(V,{value:"bookings",children:["My Bookings",a.pendingBookings>0&&x.jsx(b,{variant:"destructive",className:"ml-2 h-5 w-5 rounded-full p-0 text-xs",children:a.pendingBookings})]}),x.jsx(V,{value:"profile",children:"Profile"}),x.jsx(V,{value:"settings",children:"Settings"})]}),x.jsx(F,{value:"bookings",children:x.jsx(K,{})}),x.jsx(F,{value:"profile",children:x.jsxs(p,{children:[x.jsxs(g,{children:[x.jsx(f,{children:"Profile Information"}),x.jsx(N,{children:"Manage your profile and preferences"})]}),x.jsx(v,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Display Name"}),x.jsx("p",{className:"text-muted-foreground",children:(null==n?void 0:n.display_name)||"Not set"})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Email"}),x.jsx("p",{className:"text-muted-foreground",children:i.email})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Bio"}),x.jsx("p",{className:"text-muted-foreground",children:(null==n?void 0:n.bio)||"No bio added yet"})]}),x.jsx(h,{onClick:()=>t("/profile"),children:"Edit Profile"})]})})]})}),x.jsx(F,{value:"settings",children:x.jsxs(p,{children:[x.jsxs(g,{children:[x.jsx(f,{children:"Account Settings"}),x.jsx(N,{children:"Manage your account preferences and security"})]}),x.jsx(v,{children:x.jsx("div",{className:"space-y-4",children:x.jsxs(h,{variant:"outline",onClick:()=>t("/settings"),children:[x.jsx(J,{className:"h-4 w-4 mr-2"}),"Account Settings"]})})})]})})]})]})}):(t("/signin"),null)};export{Q as default};
