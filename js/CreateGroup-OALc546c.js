var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,n=(e,s)=>{for(var t in s||(s={}))i.call(s,t)&&o(e,t,s[t]);if(r)for(var t of r(s))a.call(s,t)&&o(e,t,s[t]);return e},c=(e,r)=>s(e,t(r));import{b as l,d as m,u as d,r as p,j as u,B as h}from"./index-B5IYdG7F.js";import{C as x,a as j,b as y,c as v,d as g}from"./card-Bm1jiGt-.js";import{I as f}from"./input-C4_QhDnm.js";import{T as b}from"./textarea-DnhiZrYB.js";import{S as N,a as w,b as _,c as C,d as P}from"./select-DME_qdt9.js";import{L as k}from"./label-BIAuZBUP.js";import{R as O}from"./ResponsiveLayout-BzUw0buI.js";import{u as S}from"./useLocation-BN9qq_uk.js";import{C as q}from"./communityService-ebNKPOD3.js";import{A as F}from"./arrow-left-CfH2SqfZ.js";import{U as L}from"./users-Dh-Bdb-k.js";import"./index-jVOyRz7F.js";import"./index-9msbY5CZ.js";import"./Combination-BxRIZ8rt.js";import"./index-_KG4atBu.js";import"./chevron-up-DvjQ7ry8.js";import"./check-C9wwFfOs.js";import"./separator-BZYZTYLW.js";import"./sheet-CgDUfSpi.js";import"./index-DD_J5sPn.js";import"./NotificationBell-DtnEojo4.js";import"./badge-Dh5Uj8vN.js";import"./scroll-area-Beiyt5Kx.js";import"./useNotifications-C0wifgqF.js";import"./tabs-DPPBWbFC.js";import"./bell-qeMkXRtc.js";import"./settings-DSEWn2wM.js";import"./user-UOowhO7W.js";import"./index-DWtoKlrM.js";import"./NotificationButton-CqXjP_LK.js";import"./search-Co_OHmlK.js";import"./map-pin-BwnggLrZ.js";import"./zap-DPSXpNso.js";import"./message-square-j4RxGxzk.js";import"./alert-CQybxmNr.js";import"./log-out-DchhrZ8K.js";import"./locationService-BBE-Ay-I.js";const B=()=>{const e=l(),{toast:s}=m(),{user:t}=d(),{currentLocation:r}=S(),[i,a]=p.useState(!1),[o,B]=p.useState({name:"",description:"",category:"General",is_public:!0,allow_anonymous_posts:!1,require_approval:!1}),E=(e,s)=>{B(t=>c(n({},t),{[e]:s}))};return u.jsx(O,{children:u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs(h,{variant:"ghost",size:"sm",onClick:()=>e("/community"),className:"flex items-center gap-2",children:[u.jsx(F,{className:"h-4 w-4"}),"Back to Community"]})}),u.jsxs(x,{children:[u.jsxs(j,{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(L,{className:"h-6 w-6 text-primary"}),u.jsx(y,{className:"text-2xl",children:"Create a Community"})]}),u.jsx(v,{children:"Start a new community group to connect with like-minded people in your area"})]}),u.jsx(g,{children:u.jsxs("form",{onSubmit:i=>((e,s,t)=>new Promise((r,a)=>{var o=e=>{try{c(t.next(e))}catch(i){a(i)}},n=e=>{try{c(t.throw(e))}catch(i){a(i)}},c=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,n);c((t=t.apply(e,s)).next())}))(void 0,null,function*(){if(i.preventDefault(),t)if(o.name.trim()&&o.description.trim()&&o.category){a(!0);try{const t=c(n({},o),{name:o.name.trim(),description:o.description.trim(),latitude:null==r?void 0:r.latitude,longitude:null==r?void 0:r.longitude,location_city:(null==r?void 0:r.city)||"",location_state:(null==r?void 0:r.state)||"",location_country:(null==r?void 0:r.country)||""});if(!(yield q.createGroup(t)))throw new Error("Failed to create community");s({title:"Success!",description:"Your community has been created successfully."}),e("/community")}catch(l){s({title:"Error",description:"Failed to create community. Please try again.",variant:"destructive"})}finally{a(!1)}}else s({title:"Error",description:"Please fill in all required fields.",variant:"destructive"})}),className:"space-y-6",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(k,{htmlFor:"name",children:"Community Name *"}),u.jsx(f,{id:"name",placeholder:"Enter community name",value:o.name,onChange:e=>E("name",e.target.value),maxLength:50}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.name.length,"/50 characters"]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(k,{htmlFor:"description",children:"Description *"}),u.jsx(b,{id:"description",placeholder:"Describe what your community is about...",value:o.description,onChange:e=>E("description",e.target.value),rows:4,maxLength:500}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.description.length,"/500 characters"]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(k,{htmlFor:"category",children:"Category *"}),u.jsxs(N,{value:o.category,onValueChange:e=>E("category",e),children:[u.jsx(w,{children:u.jsx(_,{placeholder:"Select a category"})}),u.jsx(C,{children:["Photography","Food","Outdoor","Art","Music","Sports","Technology","Business","Health","Education","Gaming","Travel","Books","Movies","General"].map(e=>u.jsx(P,{value:e,children:e},e))})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("input",{type:"checkbox",id:"is_public",checked:o.is_public,onChange:e=>E("is_public",e.target.checked),className:"rounded"}),u.jsx(k,{htmlFor:"is_public",children:"Public Community"})]}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Public communities are visible to everyone and anyone can join"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("input",{type:"checkbox",id:"allow_anonymous_posts",checked:o.allow_anonymous_posts,onChange:e=>E("allow_anonymous_posts",e.target.checked),className:"rounded"}),u.jsx(k,{htmlFor:"allow_anonymous_posts",children:"Allow Anonymous Posts"})]}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Members can post anonymously in this community"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("input",{type:"checkbox",id:"require_approval",checked:o.require_approval,onChange:e=>E("require_approval",e.target.checked),className:"rounded"}),u.jsx(k,{htmlFor:"require_approval",children:"Require Post Approval"})]}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Posts must be approved by moderators before appearing"})]}),u.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[u.jsx("h3",{className:"font-medium mb-2",children:"Community Visibility"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Your community will be visible to people in your local area based on their location settings. This helps create relevant local communities."}),r&&u.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Location: ",r.city,", ",r.state]})]}),u.jsxs("div",{className:"flex gap-4 pt-4",children:[u.jsx(h,{type:"button",variant:"outline",onClick:()=>e("/community"),className:"flex-1",children:"Cancel"}),u.jsx(h,{type:"submit",disabled:i||!o.name.trim()||!o.description.trim()||!o.category,className:"flex-1",children:i?"Creating...":"Create Community"})]})]})})]})]})})};export{B as default};
