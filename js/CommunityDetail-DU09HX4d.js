var h=(r,o,t)=>new Promise((s,n)=>{var c=a=>{try{l(t.next(a))}catch(_){n(_)}},x=a=>{try{l(t.throw(a))}catch(_){n(_)}},l=a=>a.done?s(a.value):Promise.resolve(a.value).then(c,x);l((t=t.apply(r,o)).next())});import{c as ue,R as Se,j as e,b as L,B as N,s as m,r as f,g as xe,u as Q,f as he,C,p as R,v as E,M as Pe,S as ke,q as T}from"./main-B2Z1A0fl.js";import{A as z,b as W,c as Y,R as J,S as Ve}from"./ResponsiveLayout-CYnOsYqc.js";import{B as D}from"./badge-CdNeXDip.js";import{T as qe,a as De,b as G,c as B}from"./tabs-WXu0DGF3.js";import{I as se}from"./index-yZSPA8A-.js";import{u as Oe}from"./useCommunityGroups-BhguYScc.js";import{C as Ue,a as Me}from"./chevron-up-CetLqit9.js";import{D as Ae,b as Le,c as Re,e as F}from"./index-BccyXWdq.js";import{f as re}from"./index-DBYwXkhh.js";import{P as oe}from"./pin-BE8SGceg.js";import{L as ae}from"./lock-Cg1e7wtp.js";import{M as pe}from"./map-pin-CZucSvvB.js";import{S as ve}from"./share-2-DVY756Il.js";import{M as Te}from"./message-circle-_vsuaFG3.js";import{E as Ge}from"./eye-DKsWSINO.js";import{C as fe}from"./calendar-Cawp_lnB.js";import{L as ne}from"./loader-2-BKFknEq3.js";import{A as ie}from"./arrow-left-D1AdHxCa.js";import{U as ce}from"./alert-DX9hSffn.js";import{M as le}from"./message-square-B_GUjDSs.js";import{C as de}from"./crown-Bxlg2RVK.js";import{S as Be}from"./search-DJSs7YT2.js";import{G as Fe,L as ze}from"./list-DiS__O6A.js";import{P as me}from"./plus-B4gpjJdq.js";import{S as We}from"./shield-CZrQFOJQ.js";import"./separator-DjSuCMYj.js";import"./index-oNALVX6M.js";import"./index-DJ86sh13.js";import"./databaseUtils-EE95jGy-.js";import"./scroll-area-BhRuPQbm.js";import"./useNotifications-BC0Dj2vc.js";import"./notificationService-BphN-zZk.js";import"./bell-BrPt3aXG.js";import"./check-DuTiAf7C.js";import"./user-etsi-1kT.js";import"./zap-BDCYOuKc.js";import"./wifi-BixKGM4R.js";import"./log-out-wiSeNNbg.js";import"./communityService-CVCrj8hw.js";import"./index-BKUehLRJ.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ue("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=ue("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),u={UP:1,DOWN:-1,NONE:0},$e=({score:r,userVote:o,onVote:t,disabled:s=!1,size:n="md",showScore:c=!0,className:x})=>{const[l,a]=Se.useState(!1),_=p=>h(void 0,null,function*(){if(!(s||l)){a(!0);try{yield t(p)}catch(d){console.error("Error voting:",d)}finally{a(!1)}}}),y=()=>{switch(n){case"sm":return"h-6 w-6";case"lg":return"h-8 w-8";default:return"h-7 w-7"}},P=()=>{switch(n){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},S=o===u.UP,k=o===u.DOWN;return e.jsxs("div",{className:L("flex flex-col items-center gap-1",x),children:[e.jsx(N,{variant:"ghost",size:"icon",className:L(y(),"hover:bg-green-50 hover:text-green-600 transition-colors",S&&"text-green-600 bg-green-50",s&&"opacity-50 cursor-not-allowed"),onClick:()=>_(u.UP),disabled:s||l,"aria-label":"Upvote",children:e.jsx(Ue,{className:"h-4 w-4"})}),c&&e.jsx("span",{className:L("font-medium select-none",P(),r>0&&"text-green-600",r<0&&"text-red-600",r===0&&"text-gray-500"),children:r}),e.jsx(N,{variant:"ghost",size:"icon",className:L(y(),"hover:bg-red-50 hover:text-red-600 transition-colors",k&&"text-red-600 bg-red-50",s&&"opacity-50 cursor-not-allowed"),onClick:()=>_(u.DOWN),disabled:s||l,"aria-label":"Downvote",children:e.jsx(Me,{className:"h-4 w-4"})})]})};class q{static voteOnPost(o,t){return h(this,null,function*(){try{const{data:{user:s}}=yield m.auth.getUser();if(!s)throw new Error("User not authenticated");const n=yield this.validateVote(s.id,"post",o,t);if(!n.is_valid)throw new Error(n.reason||"Invalid vote");const{data:c,error:x}=yield m.from("post_votes").select("vote_type").eq("post_id",o).eq("user_id",s.id).single();if(x&&x.code!=="PGRST116")throw x;let l=t;if(c){c.vote_type===t&&(l=u.NONE);const{error:a}=yield m.from("post_votes").update({vote_type:l}).eq("post_id",o).eq("user_id",s.id);if(a)throw a}else{const{error:a}=yield m.from("post_votes").insert({post_id:o,user_id:s.id,vote_type:l});if(a)throw a}return yield this.updatePostVoteCounts(o),!0}catch(s){return console.error("Error voting on post:",s),!1}})}static voteOnComment(o,t){return h(this,null,function*(){try{const{data:{user:s}}=yield m.auth.getUser();if(!s)throw new Error("User not authenticated");const n=yield this.validateVote(s.id,"comment",o,t);if(!n.is_valid)throw new Error(n.reason||"Invalid vote");const{data:c,error:x}=yield m.from("comment_votes").select("vote_type").eq("comment_id",o).eq("user_id",s.id).single();if(x&&x.code!=="PGRST116")throw x;let l=t;if(c){c.vote_type===t&&(l=u.NONE);const{error:a}=yield m.from("comment_votes").update({vote_type:l}).eq("comment_id",o).eq("user_id",s.id);if(a)throw a}else{const{error:a}=yield m.from("comment_votes").insert({comment_id:o,user_id:s.id,vote_type:l});if(a)throw a}return yield this.updateCommentVoteCounts(o),!0}catch(s){return console.error("Error voting on comment:",s),!1}})}static getUserPostVote(o){return h(this,null,function*(){try{const{data:{user:t}}=yield m.auth.getUser();if(!t)return u.NONE;const{data:s,error:n}=yield m.from("post_votes").select("vote_type").eq("post_id",o).eq("user_id",t.id).single();if(n&&n.code!=="PGRST116")throw n;return(s==null?void 0:s.vote_type)||u.NONE}catch(t){return console.error("Error getting user post vote:",t),u.NONE}})}static getUserCommentVote(o){return h(this,null,function*(){try{const{data:{user:t}}=yield m.auth.getUser();if(!t)return u.NONE;const{data:s,error:n}=yield m.from("comment_votes").select("vote_type").eq("comment_id",o).eq("user_id",t.id).single();if(n&&n.code!=="PGRST116")throw n;return(s==null?void 0:s.vote_type)||u.NONE}catch(t){return console.error("Error getting user comment vote:",t),u.NONE}})}static getPostVoteStats(o){return h(this,null,function*(){try{const{data:t,error:s}=yield m.from("community_posts").select("upvotes, downvotes, score").eq("id",o).single();if(s)throw s;const n=(t.upvotes||0)+(t.downvotes||0),c=n>0?(t.upvotes||0)/n:0;return{upvotes:t.upvotes||0,downvotes:t.downvotes||0,score:t.score||0,upvote_ratio:c}}catch(t){return console.error("Error getting post vote stats:",t),{upvotes:0,downvotes:0,score:0,upvote_ratio:0}}})}static getCommentVoteStats(o){return h(this,null,function*(){try{const{data:t,error:s}=yield m.from("comments").select("upvotes, downvotes, score").eq("id",o).single();if(s)throw s;const n=(t.upvotes||0)+(t.downvotes||0),c=n>0?(t.upvotes||0)/n:0;return{upvotes:t.upvotes||0,downvotes:t.downvotes||0,score:t.score||0,upvote_ratio:c}}catch(t){return console.error("Error getting comment vote stats:",t),{upvotes:0,downvotes:0,score:0,upvote_ratio:0}}})}static validateVote(o,t,s,n){return h(this,null,function*(){if(![u.UP,u.DOWN,u.NONE].includes(n))return{is_valid:!1,reason:"Invalid vote type"};const c=yield this.checkAntiSpamMeasures(o);return c.is_rate_limited?{is_valid:!1,reason:`Rate limited. Please wait ${c.cooldown_remaining} seconds before voting again.`}:(yield this.isOwnContent(o,t,s))?{is_valid:!1,reason:"You cannot vote on your own content"}:{is_valid:!0,user_reputation:1,vote_weight:1}})}static checkAntiSpamMeasures(o){return h(this,null,function*(){try{const t=new Date,s=new Date(t.getTime()-60*60*1e3),n=new Date(t.getTime()-24*60*60*1e3),{count:c,error:x}=yield m.from("post_votes").select("*",{count:"exact",head:!0}).eq("user_id",o).gte("created_at",s.toISOString());if(x)throw x;const{count:l,error:a}=yield m.from("post_votes").select("*",{count:"exact",head:!0}).eq("user_id",o).gte("created_at",n.toISOString());if(a)throw a;const _=(c||0)>50||(l||0)>500;return{user_id:o,vote_count_24h:l||0,vote_count_1h:c||0,is_rate_limited:_,cooldown_remaining:_?3600:0}}catch(t){return console.error("Error checking anti-spam measures:",t),{user_id:o,vote_count_24h:0,vote_count_1h:0,is_rate_limited:!1,cooldown_remaining:0}}})}static isOwnContent(o,t,s){return h(this,null,function*(){try{if(t==="post"){const{data:n,error:c}=yield m.from("community_posts").select("user_id").eq("id",s).single();if(c)throw c;return n.user_id===o}else{const{data:n,error:c}=yield m.from("comments").select("user_id").eq("id",s).single();if(c)throw c;return n.user_id===o}}catch(n){return console.error("Error checking if own content:",n),!1}})}static updatePostVoteCounts(o){return h(this,null,function*(){try{const{data:t,error:s}=yield m.from("post_votes").select("*",{count:"exact",head:!0}).eq("post_id",o).eq("vote_type",u.UP);if(s)throw s;const{data:n,error:c}=yield m.from("post_votes").select("*",{count:"exact",head:!0}).eq("post_id",o).eq("vote_type",u.DOWN);if(c)throw c;const x=t||0,l=n||0,a=x-l;yield m.from("community_posts").update({upvotes:x,downvotes:l,score:a}).eq("id",o)}catch(t){console.error("Error updating post vote counts:",t)}})}static updateCommentVoteCounts(o){return h(this,null,function*(){try{const{data:t,error:s}=yield m.from("comment_votes").select("*",{count:"exact",head:!0}).eq("comment_id",o).eq("vote_type",u.UP);if(s)throw s;const{data:n,error:c}=yield m.from("comment_votes").select("*",{count:"exact",head:!0}).eq("comment_id",o).eq("vote_type",u.DOWN);if(c)throw c;const x=t||0,l=n||0,a=x-l;yield m.from("comments").update({upvotes:x,downvotes:l,score:a}).eq("id",o)}catch(t){console.error("Error updating comment vote counts:",t)}})}static getUserVoteHistory(o,t=50){return h(this,null,function*(){try{const[s,n]=yield Promise.all([m.from("post_votes").select("*").eq("user_id",o).order("created_at",{ascending:!1}).limit(t),m.from("comment_votes").select("*").eq("user_id",o).order("created_at",{ascending:!1}).limit(t)]);return{post_votes:s.data||[],comment_votes:n.data||[]}}catch(s){return console.error("Error getting user vote history:",s),{post_votes:[],comment_votes:[]}}})}}const Je=()=>{const[r,o]=f.useState(null),{toast:t}=xe(),{user:s}=Q(),n=f.useCallback((p,d)=>h(void 0,null,function*(){if(!s)return t({title:"Error",description:"You must be logged in to vote",variant:"destructive"}),!1;try{if(o({postId:p,voteType:d}),yield q.voteOnPost(p,d)){const b=d===u.UP?"upvoted":d===u.DOWN?"downvoted":"removed vote from";return t({title:"Success",description:`Successfully ${b} post`}),!0}else throw new Error("Failed to vote on post")}catch(g){return console.error("Error voting on post:",g),t({title:"Error",description:g instanceof Error?g.message:"Failed to vote on post",variant:"destructive"}),!1}finally{o(null)}}),[s,t]),c=f.useCallback((p,d)=>h(void 0,null,function*(){if(!s)return t({title:"Error",description:"You must be logged in to vote",variant:"destructive"}),!1;try{if(o({commentId:p,voteType:d}),yield q.voteOnComment(p,d)){const b=d===u.UP?"upvoted":d===u.DOWN?"downvoted":"removed vote from";return t({title:"Success",description:`Successfully ${b} comment`}),!0}else throw new Error("Failed to vote on comment")}catch(g){return console.error("Error voting on comment:",g),t({title:"Error",description:g instanceof Error?g.message:"Failed to vote on comment",variant:"destructive"}),!1}finally{o(null)}}),[s,t]),x=f.useCallback(p=>h(void 0,null,function*(){if(!s)return u.NONE;try{return yield q.getUserPostVote(p)}catch(d){return console.error("Error getting user post vote:",d),u.NONE}}),[s]),l=f.useCallback(p=>h(void 0,null,function*(){if(!s)return u.NONE;try{return yield q.getUserCommentVote(p)}catch(d){return console.error("Error getting user comment vote:",d),u.NONE}}),[s]),a=f.useCallback(p=>h(void 0,null,function*(){try{return yield q.getPostVoteStats(p)}catch(d){return console.error("Error getting post vote stats:",d),{upvotes:0,downvotes:0,score:0,upvote_ratio:0}}}),[]),_=f.useCallback(p=>h(void 0,null,function*(){try{return yield q.getCommentVoteStats(p)}catch(d){return console.error("Error getting comment vote stats:",d),{upvotes:0,downvotes:0,score:0,upvote_ratio:0}}}),[]),y=f.useCallback((p=50)=>h(void 0,null,function*(){if(!s)return{post_votes:[],comment_votes:[]};try{return yield q.getUserVoteHistory(s.id,p)}catch(d){return console.error("Error getting user vote history:",d),{post_votes:[],comment_votes:[]}}}),[s]),P=f.useCallback((p,d,g,b="post")=>h(void 0,null,function*(){let O=g;return d===g&&(O=u.NONE),b==="post"?yield n(p,O):yield c(p,O)}),[n,c]),S=f.useCallback((p,d="post")=>r?d==="post"?r.postId===p:r.commentId===p:!1,[r]),k=f.useCallback(()=>r,[r]);return{voting:r,voteOnPost:n,voteOnComment:c,getUserPostVote:x,getUserCommentVote:l,getPostVoteStats:a,getCommentVoteStats:_,getUserVoteHistory:y,handleVoteToggle:P,isVotingOn:S,getVotingState:k,VOTE_TYPES:u}},Qe=({post:r,onVote:o,onPin:t,onLock:s,onDelete:n,showGroupInfo:c=!0,className:x})=>{var U;const l=he(),{user:a}=Q(),{voteOnPost:_,isVotingOn:y}=Je(),P=j=>h(void 0,null,function*(){return o?yield o(r.id,j):yield _(r.id,j)}),S=()=>h(void 0,null,function*(){t&&(yield t(r.id,!r.is_pinned))}),k=()=>h(void 0,null,function*(){s&&(yield s(r.id,!r.is_locked))}),p=()=>h(void 0,null,function*(){n&&(yield n(r.id))}),d=()=>{l(`/post/${r.id}`)},g=j=>{j.stopPropagation(),l(`/group/${r.group_id}`)},b=(a==null?void 0:a.id)===r.user_id,O=y(r.id,"post"),M=j=>{switch(j){case"discussion":return"bg-blue-100 text-blue-800";case"question":return"bg-green-100 text-green-800";case"announcement":return"bg-yellow-100 text-yellow-800";case"event":return"bg-purple-100 text-purple-800";case"poll":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(C,{className:L("hover:shadow-md transition-shadow cursor-pointer",r.is_pinned&&"border-l-4 border-l-blue-500",r.is_locked&&"border-l-4 border-l-red-500",x),onClick:d,children:[e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($e,{score:r.score,userVote:r.user_vote||0,onVote:P,disabled:O||r.is_locked,size:"md",className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(z,{className:"h-6 w-6",children:[e.jsx(W,{src:r.author_avatar}),e.jsx(Y,{children:(U=r.author_name)==null?void 0:U.charAt(0).toUpperCase()})]}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.author_name}),e.jsx("span",{className:"text-sm text-gray-500",children:re(new Date(r.created_at),{addSuffix:!0})}),r.is_pinned&&e.jsxs(D,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Pinned"]}),r.is_locked&&e.jsxs(D,{variant:"secondary",className:"bg-red-100 text-red-800",children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Locked"]}),e.jsx(D,{className:M(r.post_type),children:r.post_type})]}),c&&r.group_name&&e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"in"}),e.jsxs(N,{variant:"link",className:"h-auto p-0 text-sm text-blue-600 hover:text-blue-800",onClick:g,children:["r/",r.group_name]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:r.title}),e.jsx("div",{className:"text-sm text-gray-700 line-clamp-3",children:r.content}),r.location_city&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm text-gray-500",children:[e.jsx(pe,{className:"h-3 w-3"}),r.location_city,r.location_state&&`, ${r.location_state}`]})]}),e.jsxs(Ae,{children:[e.jsx(Le,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:j=>j.stopPropagation(),children:e.jsx(He,{className:"h-4 w-4"})})}),e.jsxs(Re,{align:"end",children:[e.jsxs(F,{onClick:j=>{j.stopPropagation()},children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Share"]}),b&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{onClick:j=>{j.stopPropagation(),S()},children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),r.is_pinned?"Unpin":"Pin"]}),e.jsxs(F,{onClick:j=>{j.stopPropagation(),k()},children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),r.is_locked?"Unlock":"Lock"]}),e.jsx(F,{onClick:j=>{j.stopPropagation(),p()},className:"text-red-600",children:"Delete"})]})]})]})]})}),e.jsx(E,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"h-4 w-4"}),r.comment_count," comments"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ge,{className:"h-4 w-4"}),r.view_count," views"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"h-4 w-4"}),re(new Date(r.created_at),{addSuffix:!0})]})]})})]})},Rt=()=>{const{groupId:r}=Pe(),o=he(),{user:t}=Q(),{toast:s}=xe(),{joinGroup:n,leaveGroup:c,isGroupMember:x,getUserRole:l}=Oe(),[a,_]=f.useState(null),[y,P]=f.useState([]),[S,k]=f.useState([]),[p,d]=f.useState(!0),[g,b]=f.useState(!1),[O,M]=f.useState(null),[U,j]=f.useState(!1),[ge,je]=f.useState("overview"),[H,we]=f.useState(""),[$,K]=f.useState("grid"),[X,_e]=f.useState("recent");f.useEffect(()=>{h(void 0,null,function*(){if(r)try{d(!0);const{data:w,error:I}=yield m.from("community_groups").select("*").eq("id",r).single();if(I)throw I;if(_(w),t){const[v,V]=yield Promise.all([x(r),l(r)]);b(v),M(V)}const{data:ye,error:ee}=yield m.from("group_members").select(`
            *,
            profiles:user_id (
              id,
              display_name,
              avatar_url
            )
          `).eq("group_id",r).order("joined_at",{ascending:!1});if(ee)throw ee;const be=ye.map(v=>{var V,A;return{id:v.id,user_id:v.user_id,display_name:((V=v.profiles)==null?void 0:V.display_name)||"Anonymous",avatar_url:(A=v.profiles)==null?void 0:A.avatar_url,role:v.role,joined_at:v.joined_at,total_posts:0,total_points:0}});P(be);const{data:Ce,error:te}=yield m.from("community_posts").select(`
            *,
            profiles:user_id (
              display_name,
              avatar_url
            )
          `).eq("group_id",r).order("created_at",{ascending:!1});if(te)throw te;const Ee=Ce.map(v=>{var V,A;return{id:v.id,title:v.title,content:v.content,post_type:v.post_type,user_id:v.user_id,author_name:((V=v.profiles)==null?void 0:V.display_name)||"Anonymous",author_avatar:(A=v.profiles)==null?void 0:A.avatar_url,score:v.score||0,comment_count:v.comment_count||0,view_count:v.view_count||0,is_pinned:v.is_pinned||!1,is_locked:v.is_locked||!1,created_at:v.created_at,updated_at:v.updated_at}});k(Ee)}catch(w){console.error("Error fetching group details:",w),s({title:"Error",description:"Failed to load community details",variant:"destructive"}),o("/community")}finally{d(!1)}})},[r,t,l,x,o,s]);const Ne=()=>h(void 0,null,function*(){if(!t||!r){s({title:"Authentication Required",description:"Please log in to join communities",variant:"destructive"});return}try{j(!0),g?(yield c(r))&&(b(!1),M(null),s({title:"Success",description:"You have left the community"})):(yield n(r))&&(b(!0),M("member"),s({title:"Success",description:"You have joined the community"}))}catch(i){console.error("Error handling join/leave:",i),s({title:"Error",description:"Failed to update membership",variant:"destructive"})}finally{j(!1)}}),Z=[...S.filter(i=>i.title.toLowerCase().includes(H.toLowerCase())||i.content.toLowerCase().includes(H.toLowerCase()))].sort((i,w)=>{switch(X){case"recent":return new Date(w.created_at).getTime()-new Date(i.created_at).getTime();case"popular":return w.score-i.score;case"comments":return w.comment_count-i.comment_count;case"views":return w.view_count-i.view_count;default:return 0}});return p?e.jsx(J,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading community..."})]})})}):a?e.jsx(J,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(N,{variant:"ghost",onClick:()=>o("/community"),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:a.name}),e.jsx("p",{className:"text-muted-foreground",children:a.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{variant:"outline",size:"sm",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Share"]}),g&&e.jsxs(N,{variant:"outline",size:"sm",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Settings"]}),e.jsxs(N,{className:g?"bg-red-500 hover:bg-red-600":"btn-community",onClick:Ne,disabled:U,children:[U?e.jsx(ne,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ce,{className:"w-4 h-4 mr-2"}),U?"Processing...":g?"Leave Community":"Join Community"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(C,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a.member_count||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Members"})]})]})})}),e.jsx(C,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a.post_count||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Posts"})]})]})})}),e.jsx(C,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a.location_city||"Local"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Location"})]})]})})}),e.jsx(C,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:new Date(a.created_at).getFullYear()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Founded"})]})]})})})]}),e.jsxs(qe,{value:ge,onValueChange:je,className:"space-y-4",children:[e.jsxs(De,{className:"grid w-full grid-cols-4",children:[e.jsx(G,{value:"overview",children:"Overview"}),e.jsx(G,{value:"discussions",children:"Discussions"}),e.jsx(G,{value:"members",children:"Members"}),e.jsx(G,{value:"about",children:"About"})]}),e.jsxs(B,{value:"overview",className:"space-y-4",children:[e.jsxs(C,{children:[e.jsx(R,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5 text-yellow-500"}),"Recent Activity"]})}),e.jsxs(E,{children:[S.slice(0,3).map(i=>{var w;return e.jsxs("div",{className:"flex items-center gap-3 p-3 border-b last:border-b-0",children:[e.jsxs(z,{className:"h-8 w-8",children:[e.jsx(W,{src:i.author_avatar}),e.jsx(Y,{children:(w=i.author_name)==null?void 0:w.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:i.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["by ",i.author_name," • ",new Date(i.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[i.score," points"]}),e.jsxs("span",{children:[i.comment_count," comments"]})]})]},i.id)}),S.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No posts yet. Be the first to start a discussion!"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(C,{children:[e.jsx(R,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-yellow-500"}),"Top Members"]})}),e.jsx(E,{children:y.slice(0,5).map(i=>{var w;return e.jsxs("div",{className:"flex items-center gap-3 p-2",children:[e.jsxs(z,{className:"h-8 w-8",children:[e.jsx(W,{src:i.avatar_url}),e.jsx(Y,{children:(w=i.display_name)==null?void 0:w.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:i.display_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.role})]}),e.jsxs(D,{variant:"secondary",className:"text-xs",children:[i.total_points," pts"]})]},i.id)})})]}),e.jsxs(C,{children:[e.jsx(R,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-blue-500"}),"Community Info"]})}),e.jsxs(E,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"secondary",children:["#",a.category]}),e.jsx(D,{variant:a.is_public?"default":"destructive",children:a.is_public?"Public":"Private"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Created by: ",a.created_by]}),e.jsxs("p",{children:["Location: ",a.location_city||"Local"]}),e.jsxs("p",{children:["Posts require approval: ",a.require_approval?"Yes":"No"]}),e.jsxs("p",{children:["Anonymous posts: ",a.allow_anonymous_posts?"Allowed":"Not allowed"]})]})]})]})]})]}),e.jsxs(B,{value:"discussions",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(se,{placeholder:"Search discussions...",value:H,onChange:i=>we(i.target.value),className:"pl-10 w-64"})]}),e.jsxs("select",{value:X,onChange:i=>_e(i.target.value),className:"border rounded-md px-3 py-2",children:[e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"popular",children:"Most Popular"}),e.jsx("option",{value:"comments",children:"Most Comments"}),e.jsx("option",{value:"views",children:"Most Views"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:$==="grid"?"default":"ghost",size:"sm",onClick:()=>K("grid"),children:e.jsx(Fe,{className:"w-4 h-4"})}),e.jsx(N,{variant:$==="list"?"default":"ghost",size:"sm",onClick:()=>K("list"),children:e.jsx(ze,{className:"w-4 h-4"})}),g&&e.jsxs(N,{className:"btn-community",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"New Post"]})]})]}),Z.length>0?e.jsx("div",{className:$==="grid"?"grid grid-cols-1 md:grid-cols-2 gap-4":"space-y-4",children:Z.map(i=>e.jsx(Qe,{post:i,showGroupInfo:!1},i.id))}):e.jsx(C,{className:"text-center py-12",children:e.jsxs(E,{children:[e.jsx(le,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No discussions yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:g?"Start the first discussion in this community!":"Join the community to start discussions"}),g&&e.jsxs(N,{className:"btn-community",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Create First Post"]})]})})]}),e.jsxs(B,{value:"members",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Community Members (",y.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{placeholder:"Search members...",className:"w-64"}),e.jsxs("select",{className:"border rounded-md px-3 py-2",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"moderator",children:"Moderators"}),e.jsx("option",{value:"member",children:"Members"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(i=>{var w;return e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(z,{className:"h-12 w-12",children:[e.jsx(W,{src:i.avatar_url}),e.jsx(Y,{children:(w=i.display_name)==null?void 0:w.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium",children:i.display_name}),i.role==="admin"&&e.jsx(de,{className:"w-4 h-4 text-yellow-500"}),i.role==="moderator"&&e.jsx(We,{className:"w-4 h-4 text-blue-500"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.role}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Joined ",new Date(i.joined_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:[i.total_points," pts"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.total_posts," posts"]})]})]})},i.id)})})]}),e.jsx(B,{value:"about",className:"space-y-4",children:e.jsxs(C,{children:[e.jsx(R,{children:e.jsxs(T,{children:["About ",a.name]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground",children:a.description||"No description available."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Community Rules"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Be respectful and kind to other members"}),e.jsx("li",{children:"• Stay on topic and relevant to the community"}),e.jsx("li",{children:"• No spam, advertising, or self-promotion"}),e.jsx("li",{children:"• Follow the community guidelines"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Community Settings"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Privacy:"}),e.jsx(D,{variant:a.is_public?"default":"destructive",children:a.is_public?"Public":"Private"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Post Approval:"}),e.jsx("span",{children:a.require_approval?"Required":"Not Required"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Anonymous Posts:"}),e.jsx("span",{children:a.allow_anonymous_posts?"Allowed":"Not Allowed"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Statistics"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Members:"}),e.jsx("span",{children:a.member_count||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Posts:"}),e.jsx("span",{children:a.post_count||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Created:"}),e.jsx("span",{children:new Date(a.created_at).toLocaleDateString()})]})]})]})]})]})]})})]})]})}):e.jsx(J,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Community not found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The community you're looking for doesn't exist or has been removed."}),e.jsxs(N,{onClick:()=>o("/community"),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Back to Communities"]})]})})})};export{Rt as default};
