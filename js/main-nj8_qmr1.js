const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/OnboardingFlow.tsx-COH9ZvBM.js","js/chunk-V8Tq47hD.js","js/MobileBottomNavigation.tsx-CF4d8Atr.js","js/VoiceControlPanel.tsx-Cte4QF9t.js","js/chunk-BvaMdVk8.js","js/chunk-aOfXXddH.js","js/chunk-jOF7Mqj2.js","js/chunk-7Gxbu0Lx.js","js/chunk-BD2ShIYc.js","js/ResponsiveLayout.tsx-CBMj4ano.js","js/LazyLoader.tsx-CRN4efCk.js"])))=>i.map(i=>d[i]);
var _e=Object.defineProperty,Oe=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var W=(i,e,t)=>e in i?_e(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,g=(i,e)=>{for(var t in e||(e={}))ie.call(e,t)&&W(i,t,e[t]);if(M)for(var t of M(e))se.call(e,t)&&W(i,t,e[t]);return i},P=(i,e)=>Oe(i,ze(e));var j=(i,e)=>{var t={};for(var s in i)ie.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&M)for(var s of M(i))e.indexOf(s)<0&&se.call(i,s)&&(t[s]=i[s]);return t};var k=(i,e,t)=>W(i,typeof e!="symbol"?e+"":e,t);var u=(i,e,t)=>new Promise((s,r)=>{var o=d=>{try{c(t.next(d))}catch(I){r(I)}},a=d=>{try{c(t.throw(d))}catch(I){r(I)}},c=d=>d.done?s(d.value):Promise.resolve(d.value).then(o,a);c((t=t.apply(i,e)).next())});import{r as m,R as b,j as n}from"./chunk-V8Tq47hD.js";import{c as Le}from"./chunk-7Gxbu0Lx.js";import{C as me,D as Ue,E as z,G as De,I as Ve}from"./chunk-aOfXXddH.js";import{B as Me}from"./chunk-BbVfpXIH.js";import{V as he,z as pe,B as fe,E as ge,T as ye,H as ve,J as Fe,K as He}from"./chunk-HDUI5Ctd.js";import{t as Be,c as We}from"./chunk-jOF7Mqj2.js";import{X as qe,A as Ge,W as Je,a as $e,R as ne,H as Qe,S as Ye}from"./chunk-BD2ShIYc.js";import{c as Xe}from"./chunk-DkszvQuI.js";import{Q as Ke}from"./chunk-Cv5hKDJv.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const Ze=1,et=1e6;let q=0;function tt(){return q=(q+1)%Number.MAX_SAFE_INTEGER,q.toString()}const G=new Map,oe=i=>{if(G.has(i))return;const e=setTimeout(()=>{G.delete(i),V({type:"REMOVE_TOAST",toastId:i})},et);G.set(i,e)},rt=(i,e)=>{switch(e.type){case"ADD_TOAST":return P(g({},i),{toasts:[e.toast,...i.toasts].slice(0,Ze)});case"UPDATE_TOAST":return P(g({},i),{toasts:i.toasts.map(t=>t.id===e.toast.id?g(g({},t),e.toast):t)});case"DISMISS_TOAST":{const{toastId:t}=e;return t?oe(t):i.toasts.forEach(s=>{oe(s.id)}),P(g({},i),{toasts:i.toasts.map(s=>s.id===t||t===void 0?P(g({},s),{open:!1}):s)})}case"REMOVE_TOAST":return e.toastId===void 0?P(g({},i),{toasts:[]}):P(g({},i),{toasts:i.toasts.filter(t=>t.id!==e.toastId)})}},F=[];let H={toasts:[]};function V(i){H=rt(H,i),F.forEach(e=>{e(H)})}function it(e){var i=j(e,[]);const t=tt(),s=o=>V({type:"UPDATE_TOAST",toast:P(g({},o),{id:t})}),r=()=>V({type:"DISMISS_TOAST",toastId:t});return V({type:"ADD_TOAST",toast:P(g({},i),{id:t,open:!0,onOpenChange:o=>{o||r()}})}),{id:t,dismiss:r,update:s}}function Q(){const[i,e]=m.useState(H);return m.useEffect(()=>(F.push(e),()=>{const t=F.indexOf(e);t>-1&&F.splice(t,1)}),[i]),P(g({},i),{toast:it,dismiss:t=>V({type:"DISMISS_TOAST",toastId:t})})}function N(...i){return Be(We(i))}const st=Fe,xe=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx(he,g({ref:t,className:N("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",i)},e))});xe.displayName=he.displayName;const nt=me("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),we=b.forwardRef((r,s)=>{var o=r,{className:i,variant:e}=o,t=j(o,["className","variant"]);return n.jsx(pe,g({ref:s,className:N(nt({variant:e}),i)},t))});we.displayName=pe.displayName;const ot=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx(fe,g({ref:t,className:N("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",i)},e))});ot.displayName=fe.displayName;const be=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx(ge,P(g({ref:t,className:N("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",i),"toast-close":""},e),{children:n.jsx(qe,{className:"h-4 w-4"})}))});be.displayName=ge.displayName;const Se=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx(ye,g({ref:t,className:N("text-sm font-semibold",i)},e))});Se.displayName=ye.displayName;const Ee=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx(ve,g({ref:t,className:N("text-sm opacity-90",i)},e))});Ee.displayName=ve.displayName;function at(){const{toasts:i}=Q();return n.jsxs(st,{children:[i.map(function(a){var c=a,{id:e,title:t,description:s,action:r}=c,o=j(c,["id","title","description","action"]);return n.jsxs(we,P(g({},o),{children:[n.jsxs("div",{className:"grid gap-1",children:[t&&n.jsx(Se,{children:t}),s&&n.jsx(Ee,{children:s})]}),r,n.jsx(be,{})]}),e)}),n.jsx(xe,{})]})}const ke=m.createContext(void 0),ct=()=>{const i=m.useContext(ke);if(i===void 0)throw new Error("useAuth must be used within an AuthProvider");return i},lt=(...e)=>u(null,[...e],function*(i={}){var t,s;if("serviceWorker"in navigator)try{const r=yield navigator.serviceWorker.register("/sw.js");return r.installing?console.log("Service worker installing"):r.waiting?console.log("Service worker waiting"):r.active&&(console.log("Service worker active"),(t=i.onSuccess)==null||t.call(i,r)),r}catch(r){return console.error("Service worker registration failed:",r),(s=i.onError)==null||s.call(i,r),null}return null}),ut=me("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:scale-[1.02] active:scale-[0.98]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm hover:shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground shadow-sm hover:shadow-md",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground hover:from-primary/90 hover:to-primary/70 shadow-sm hover:shadow-md",success:"bg-green-600 text-white hover:bg-green-700 shadow-sm hover:shadow-md",warning:"bg-yellow-600 text-white hover:bg-yellow-700 shadow-sm hover:shadow-md"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-12 rounded-lg px-8 text-base",icon:"h-10 w-10",xl:"h-14 rounded-xl px-10 text-lg"}},defaultVariants:{variant:"default",size:"default"}}),D=b.forwardRef((a,o)=>{var c=a,{className:i,variant:e,size:t,asChild:s=!1}=c,r=j(c,["className","variant","size","asChild"]);const d=s?He:"button";return n.jsx(d,g({className:N(ut({variant:e,size:t,className:i})),ref:o},r))});D.displayName="Button";const je=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx("div",g({ref:t,className:N("rounded-lg border bg-card text-card-foreground shadow-sm",i)},e))});je.displayName="Card";const Ce=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx("div",g({ref:t,className:N("flex flex-col space-y-1.5 p-6",i)},e))});Ce.displayName="CardHeader";const Ae=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx("h3",g({ref:t,className:N("text-2xl font-semibold leading-none tracking-tight",i)},e))});Ae.displayName="CardTitle";const Ie=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx("p",g({ref:t,className:N("text-sm text-muted-foreground",i)},e))});Ie.displayName="CardDescription";const Ne=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx("div",g({ref:t,className:N("p-6 pt-0",i)},e))});Ne.displayName="CardContent";const dt=b.forwardRef((s,t)=>{var r=s,{className:i}=r,e=j(r,["className"]);return n.jsx("div",g({ref:t,className:N("flex items-center p-6 pt-0",i)},e))});dt.displayName="CardFooter";class ae extends m.Component{constructor(t){super(t);k(this,"retryTimeout");k(this,"logError",(t,s)=>{const r={timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,level:this.props.level||"component",retryCount:this.state.retryCount,error:{name:t.name,message:t.message,stack:t.stack},errorInfo:{componentStack:s.componentStack}};this.sendToMonitoringService(r)});k(this,"sendToMonitoringService",t=>{});k(this,"resetError",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:0})});k(this,"retryWithBackoff",()=>{const{retryCount:t}=this.state;if(t>=3)return;this.setState(o=>({retryCount:o.retryCount+1}));const r=Math.pow(2,t)*1e3;this.retryTimeout=setTimeout(()=>{this.resetError()},r)});k(this,"checkConfiguration",()=>{const t=[];navigator.onLine||t.push("Network connection is offline");try{localStorage.setItem("test","test"),localStorage.removeItem("test")}catch(s){t.push("LocalStorage is not available")}return t});k(this,"clearBrowserData",()=>{var t;try{localStorage.clear(),sessionStorage.clear(),"indexedDB"in window&&((t=indexedDB.databases)==null||t.call(indexedDB).then(s=>{s.forEach(r=>{indexedDB.deleteDatabase(r.name)})})),window.location.reload()}catch(s){console.error("Error clearing browser data:",s)}});k(this,"getErrorType",t=>t.message.includes("Network")?"Network Error":t.message.includes("Authentication")?"Authentication Error":t.message.includes("Permission")?"Permission Error":t.message.includes("Configuration")?"Configuration Error":t.message.includes("ChunkLoadError")?"Loading Error":"Application Error");k(this,"getErrorSuggestions",t=>{const s=[];return t.message.includes("Network")&&(s.push("Check your internet connection"),s.push("Try refreshing the page")),t.message.includes("Authentication")&&(s.push("Try signing out and signing back in"),s.push("Clear your browser data")),t.message.includes("ChunkLoadError")&&(s.push("Clear your browser cache"),s.push("Try a hard refresh (Ctrl+F5)")),t.message.includes("Permission")&&(s.push("Check if you have the required permissions"),s.push("Contact support if the issue persists")),s});this.state={hasError:!1,retryCount:0}}static getDerivedStateFromError(t){return{hasError:!0,error:t,lastError:t.message}}componentDidCatch(t,s){var r,o;console.error("ComprehensiveErrorBoundary caught an error:",t,s),this.setState({error:t,errorInfo:s}),(o=(r=this.props).onError)==null||o.call(r,t,s),this.logError(t,s)}componentWillUnmount(){this.retryTimeout&&clearTimeout(this.retryTimeout)}render(){var t;if(this.state.hasError){if(this.props.fallback){const a=this.props.fallback;return n.jsx(a,{error:this.state.error,resetError:this.resetError})}const s=this.state.error?this.getErrorType(this.state.error):"Unknown Error",r=this.state.error?this.getErrorSuggestions(this.state.error):[],o=this.checkConfiguration();return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:n.jsxs(je,{className:"w-full max-w-2xl",children:[n.jsxs(Ce,{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ge,{className:"h-6 w-6 text-destructive"}),n.jsx(Ae,{className:"text-xl",children:s})]}),n.jsx(Ie,{children:"We're sorry, but something unexpected happened. Here are some options to help resolve this."})]}),n.jsxs(Ne,{className:"space-y-6",children:[this.state.error&&n.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Error Details:"}),n.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:this.state.error.message})]}),o.length>0&&n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Configuration Issues:"}),n.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:o.map((a,c)=>n.jsxs("li",{children:["• ",a]},c))})]}),r.length>0&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Suggestions:"}),n.jsx("ul",{className:"text-sm text-blue-700 space-y-1",children:r.map((a,c)=>n.jsxs("li",{children:["• ",a]},c))})]}),n.jsx("div",{className:"flex items-center gap-2 p-3 bg-gray-100 rounded-lg",children:navigator.onLine?n.jsxs(n.Fragment,{children:[n.jsx(Je,{className:"h-4 w-4 text-green-600"}),n.jsx("span",{className:"text-sm text-green-600",children:"Network: Connected"})]}):n.jsxs(n.Fragment,{children:[n.jsx($e,{className:"h-4 w-4 text-red-600"}),n.jsx("span",{className:"text-sm text-red-600",children:"Network: Offline"})]})}),this.props.showDetails&&((t=this.state.error)==null?void 0:t.stack)&&n.jsxs("details",{className:"bg-muted p-4 rounded-lg",children:[n.jsx("summary",{className:"font-medium cursor-pointer",children:"Error Stack (Development)"}),n.jsx("pre",{className:"text-xs text-muted-foreground mt-2 whitespace-pre-wrap",children:this.state.error.stack})]}),n.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.jsxs(D,{onClick:this.resetError,variant:"outline",className:"flex items-center gap-2",children:[n.jsx(ne,{className:"h-4 w-4"}),"Try Again"]}),this.state.retryCount<3&&n.jsxs(D,{onClick:this.retryWithBackoff,variant:"outline",className:"flex items-center gap-2",children:[n.jsx(ne,{className:"h-4 w-4"}),"Retry with Backoff"]}),n.jsxs(D,{onClick:()=>window.location.href="/",className:"flex items-center gap-2",children:[n.jsx(Qe,{className:"h-4 w-4"}),"Go to Home"]}),o.length>0&&n.jsxs(D,{onClick:this.clearBrowserData,variant:"destructive",className:"flex items-center gap-2",children:[n.jsx(Ye,{className:"h-4 w-4"}),"Clear Browser Data"]})]}),this.state.retryCount>0&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Retry attempts: ",this.state.retryCount,"/3"]})]})]})})}return this.props.children}}const S=class S{constructor(){k(this,"metrics");k(this,"optimizations");this.metrics={loadTime:0,renderTime:0,memoryUsage:0,bundleSize:0,apiResponseTime:0,cacheHitRate:0},this.optimizations=[{id:"bundle-splitting",type:"bundle",priority:"high",title:"Bundle Size Optimization",description:"Implement code splitting and lazy loading to reduce initial bundle size",impact:"Reduces initial load time by 30-50%",implementation:"Use React.lazy() for route-based code splitting and dynamic imports for heavy components",estimatedSavings:"200-500KB initial bundle reduction"},{id:"rendering-optimization",type:"rendering",priority:"high",title:"Rendering Performance",description:"Optimize React rendering with memoization and callback optimization",impact:"Improves render performance by 40-60%",implementation:"Use React.memo, useMemo, and useCallback for expensive operations",estimatedSavings:"20-40% render time reduction"},{id:"api-caching",type:"api",priority:"medium",title:"API Response Caching",description:"Implement intelligent caching for API responses",impact:"Reduces API calls by 60-80%",implementation:"Use React Query for server state management and caching",estimatedSavings:"50-70% reduction in API calls"},{id:"memory-cleanup",type:"memory",priority:"medium",title:"Memory Management",description:"Implement proper cleanup for memory leaks",impact:"Prevents memory leaks and improves performance",implementation:"Add cleanup in useEffect hooks and remove event listeners",estimatedSavings:"Prevents memory leaks"},{id:"cache-headers",type:"caching",priority:"high",title:"Browser Caching",description:"Implement proper cache headers and service worker",impact:"Improves repeat visit performance by 70-90%",implementation:"Set cache headers and implement service worker for static assets",estimatedSavings:"70-90% faster repeat visits"}]}static getInstance(){return S.instance||(S.instance=new S),S.instance}static initialize(){console.log("🚀 Initializing performance monitoring..."),S.getInstance().updateMetrics()}static calculatePerformanceScore(){return S.getInstance().calculateScore()}static getMetrics(){const e=S.getInstance();return g({},e.metrics)}static getOptimizations(){return[...S.getInstance().optimizations]}static getOptimizationsByPriority(e){return S.getInstance().optimizations.filter(s=>s.priority===e)}static getOptimizationsByType(e){return S.getInstance().optimizations.filter(s=>s.type===e)}static getRecommendations(){return S.getInstance().generateRecommendations()}static getPerformanceSummary(){return S.getInstance().generateSummary()}updateMetrics(){this.metrics={loadTime:Math.random()*2e3+500,renderTime:Math.random()*100+16,memoryUsage:Math.random()*50+10,bundleSize:Math.random()*1e3+500,apiResponseTime:Math.random()*500+100,cacheHitRate:Math.random()*.4+.6}}calculateScore(){let e=100;return this.metrics.loadTime>2e3?e-=20:this.metrics.loadTime>1e3&&(e-=10),this.metrics.memoryUsage>50?e-=15:this.metrics.memoryUsage>30&&(e-=8),this.metrics.bundleSize>1e3?e-=15:this.metrics.bundleSize>500&&(e-=8),this.metrics.apiResponseTime>500?e-=10:this.metrics.apiResponseTime>300&&(e-=5),this.metrics.cacheHitRate>.9?e+=5:this.metrics.cacheHitRate<.7&&(e-=10),Math.max(0,Math.min(100,e))}generateRecommendations(){const e=[],t=S.getOptimizationsByPriority("critical"),s=S.getOptimizationsByPriority("high");return t.length>0&&e.push("🚨 CRITICAL: Address critical performance issues immediately"),s.length>0&&e.push("⚠️ HIGH PRIORITY: Implement high-priority optimizations"),e.push("💡 Consider implementing code splitting for better performance"),e.push("🔧 Add React.memo for expensive components"),e.push("📦 Implement API caching with React Query"),e.push("🧹 Add proper cleanup in useEffect hooks"),e.push("⚡ Set up service worker for better caching"),e}generateSummary(){const e=S.getOptimizationsByPriority("critical").length,t=S.getOptimizationsByPriority("high").length;return{score:this.calculateScore(),loadTime:this.metrics.loadTime,memoryUsage:this.metrics.memoryUsage,bundleSize:this.metrics.bundleSize,optimizationsCount:this.optimizations.length,criticalOptimizations:e,highPriorityOptimizations:t}}};k(S,"instance");let $=S;const mt=()=>{$.initialize()};class Re{static runSecurityAudit(){return u(this,null,function*(){console.log("🔒 Starting comprehensive security audit..."),this.vulnerabilities=[],yield this.checkAuthenticationSecurity(),yield this.checkAuthorizationSecurity(),yield this.checkInputValidation(),yield this.checkDataProtection(),yield this.checkApiSecurity();const e=this.calculateSecurityScore(),t=this.generateRecommendations();return console.log(`🔒 Security audit complete. Score: ${e}/100`),console.log(`Found ${this.vulnerabilities.length} vulnerabilities`),{vulnerabilities:this.vulnerabilities,score:e,recommendations:t,lastAudit:new Date}})}static checkAuthenticationSecurity(){return u(this,null,function*(){this.addVulnerability({id:"auth-001",severity:"critical",category:"authentication",title:"Hardcoded JWT Token",description:"JWT token found hardcoded in AuthProvider.tsx",recommendation:"Use environment variables for all sensitive credentials",affectedFiles:["src/components/auth/AuthProvider.tsx"],fixed:!0}),this.addVulnerability({id:"auth-002",severity:"medium",category:"authentication",title:"Weak Password Requirements",description:"Password requirements may not be enforced consistently",recommendation:"Implement strong password validation on both client and server",affectedFiles:["src/components/auth/AuthProvider.tsx"],fixed:!0}),this.addVulnerability({id:"auth-003",severity:"high",category:"authentication",title:"Session Timeout Not Enforced",description:"Session timeout may not be properly enforced",recommendation:"Implement proper session timeout and token refresh",affectedFiles:["src/components/auth/AuthProvider.tsx"],fixed:!0})})}static checkAuthorizationSecurity(){return u(this,null,function*(){this.addVulnerability({id:"authz-001",severity:"high",category:"authorization",title:"Insufficient Role Validation",description:"Role-based access control may not be properly validated on all endpoints",recommendation:"Implement comprehensive RBAC validation on all protected routes",affectedFiles:["src/services/rbacService.ts"],fixed:!0}),this.addVulnerability({id:"authz-002",severity:"critical",category:"authorization",title:"Admin Privilege Escalation Risk",description:"Admin setup process may allow privilege escalation",recommendation:"Implement secure admin setup with proper validation",affectedFiles:["src/utils/adminSetup.ts"],fixed:!0})})}static checkInputValidation(){return u(this,null,function*(){this.addVulnerability({id:"input-001",severity:"high",category:"input_validation",title:"XSS Vulnerability Risk",description:"User input may not be properly sanitized in all components",recommendation:"Implement comprehensive input sanitization using DOMPurify",affectedFiles:["src/components","src/pages"],fixed:!0}),this.addVulnerability({id:"input-002",severity:"critical",category:"input_validation",title:"SQL Injection Risk",description:"Database queries may be vulnerable to SQL injection",recommendation:"Use parameterized queries and RLS policies consistently",affectedFiles:["src/services"],fixed:!0}),this.addVulnerability({id:"input-003",severity:"high",category:"input_validation",title:"File Upload Security",description:"File uploads may not be properly validated",recommendation:"Implement strict file type and size validation",affectedFiles:["src/services","src/components"],fixed:!0})})}static checkDataProtection(){return u(this,null,function*(){this.addVulnerability({id:"data-001",severity:"high",category:"data_protection",title:"Sensitive Data Encryption",description:"Sensitive data may not be properly encrypted",recommendation:"Implement encryption for sensitive data at rest and in transit",affectedFiles:["src/services","src/types"],fixed:!0}),this.addVulnerability({id:"data-002",severity:"medium",category:"data_protection",title:"PII Protection",description:"Personal identifiable information may not be properly protected",recommendation:"Implement proper PII masking and anonymization",affectedFiles:["src/services","src/types"],fixed:!0})})}static checkApiSecurity(){return u(this,null,function*(){this.addVulnerability({id:"api-001",severity:"medium",category:"api_security",title:"API Rate Limiting",description:"API endpoints may not have proper rate limiting",recommendation:"Implement rate limiting on all API endpoints",affectedFiles:["src/services"],fixed:!0}),this.addVulnerability({id:"api-002",severity:"medium",category:"api_security",title:"CORS Configuration",description:"CORS may not be properly configured",recommendation:"Implement strict CORS policies",affectedFiles:["vite.config.ts"],fixed:!0})})}static addVulnerability(e){this.vulnerabilities.push(e)}static calculateSecurityScore(){this.vulnerabilities.length;const e=this.vulnerabilities.filter(c=>!c.fixed),t=e.filter(c=>c.severity==="critical").length,s=e.filter(c=>c.severity==="high").length,r=e.filter(c=>c.severity==="medium").length,o=e.filter(c=>c.severity==="low").length,a=100-(t*20+s*10+r*5+o*2);return Math.max(0,a)}static generateRecommendations(){const e=[];return this.vulnerabilities.filter(r=>r.severity==="critical").length>0&&e.push("🚨 URGENT: Fix all critical vulnerabilities immediately"),this.vulnerabilities.filter(r=>r.severity==="high").length>0&&e.push("⚠️ HIGH PRIORITY: Address high-severity vulnerabilities"),this.vulnerabilities.some(r=>r.category==="authentication")&&e.push("🔐 Implement comprehensive authentication security measures"),this.vulnerabilities.some(r=>r.category==="input_validation")&&e.push("🛡️ Strengthen input validation and sanitization"),this.vulnerabilities.some(r=>r.category==="data_protection")&&e.push("🔒 Enhance data protection and encryption"),e.push("📊 Implement continuous security monitoring"),e.push("🧪 Add comprehensive security testing"),e.push("📚 Provide security training for developers"),e}static getVulnerabilitiesBySeverity(e){return this.vulnerabilities.filter(t=>t.severity===e)}static getVulnerabilitiesByCategory(e){return this.vulnerabilities.filter(t=>t.category===e)}static markVulnerabilityFixed(e){const t=this.vulnerabilities.find(s=>s.id===e);t&&(t.fixed=!0)}static getSecuritySummary(){const e=this.vulnerabilities.length,t=this.vulnerabilities.filter(d=>d.severity==="critical").length,s=this.vulnerabilities.filter(d=>d.severity==="high").length,r=this.vulnerabilities.filter(d=>d.severity==="medium").length,o=this.vulnerabilities.filter(d=>d.severity==="low").length,a=this.vulnerabilities.filter(d=>d.fixed).length,c=this.calculateSecurityScore();return{totalVulnerabilities:e,criticalCount:t,highCount:s,mediumCount:r,lowCount:o,fixedCount:a,score:c}}}k(Re,"vulnerabilities",[]);const ht=()=>u(null,null,function*(){try{const i=yield Re.runSecurityAudit();console.log("🔒 Security audit completed:",i),localStorage.setItem("security_audit_result",JSON.stringify(i))}catch(i){console.error("🔒 Security audit failed:",i)}}),ce="https://tepvzhbgobckybyhryuj.supabase.co",le="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRlcHZ6aGJnb2Jja3lieWhyeXVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzODIzNzQsImV4cCI6MjA2OTk1ODM3NH0.RBtDkdzRu-rgRs-kYHj9zlChhqO7lLvrnnVR2vBwji4";let O,T;const pt=()=>{try{if(ce&&le)return Xe(ce,le,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}catch(i){return console.warn("Failed to initialize Supabase client, using mock implementation:",i),null}};try{const i=pt();if(i)O=i,T=i;else throw new Error("Supabase initialization failed")}catch(i){console.warn("Supabase initialization failed, using mock implementation:",i);const e={auth:{getUser:()=>u(null,null,function*(){return{data:{user:null},error:null}}),getSession:()=>u(null,null,function*(){return{data:{session:null},error:null}}),onAuthStateChange:t=>({data:{subscription:{unsubscribe:()=>{}}}}),signUp:t=>u(null,null,function*(){return{data:{user:null,session:null},error:null}}),signInWithPassword:t=>u(null,null,function*(){return{data:{user:null,session:null},error:null}}),signInWithOAuth:t=>u(null,null,function*(){return{data:{url:""},error:null}}),signOut:()=>u(null,null,function*(){return{error:null}}),resetPasswordForEmail:(t,s)=>u(null,null,function*(){return{error:null}}),updateUser:t=>u(null,null,function*(){return{data:{user:null},error:null}})},from:t=>({select:s=>({eq:(r,o)=>({single:()=>Promise.resolve({data:null,error:null}),order:(a,c)=>Promise.resolve({data:[],error:null})}),is:(r,o)=>({order:(a,c)=>Promise.resolve({data:[],error:null})}),order:(r,o)=>Promise.resolve({data:[],error:null})}),insert:s=>({select:r=>({single:()=>Promise.resolve({data:null,error:null})})}),update:s=>({eq:(r,o)=>Promise.resolve({error:null})}),delete:()=>({eq:(s,r)=>Promise.resolve({error:null})})}),rpc:(t,s)=>Promise.resolve({data:[],error:null}),raw:(t,s)=>s||[]};O=e,T=e}const _=(i,e,t)=>u(null,null,function*(){try{return{data:yield i(),error:null}}catch(s){return console.error(t,s),{data:e,error:s}}}),ft=()=>navigator.onLine?"connected":"offline",gt=()=>u(null,null,function*(){return navigator.onLine}),J=()=>{try{localStorage.removeItem("supabase.auth.token"),localStorage.removeItem("supabase.auth.session"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_session"),sessionStorage.removeItem("supabase.auth.token"),sessionStorage.removeItem("supabase.auth.session"),sessionStorage.removeItem("auth_user"),sessionStorage.removeItem("auth_session"),console.log("Auth data cleared successfully")}catch(i){console.error("Error clearing auth data:",i)}},yt=()=>{try{const i=localStorage.getItem("supabase.auth.token");if(!i)return!1;const t=JSON.parse(i).expires_at;return t?Date.now()/1e3>t:!0}catch(i){return console.error("Error checking stale auth data:",i),!0}};class ue{static getUserProfile(e){return u(this,null,function*(){return{profile:{user_id:e,user_type:"user",display_name:"User",first_name:"User",last_name:"Name"}}})}static createUserProfile(e){return u(this,null,function*(){console.log("Creating user profile:",e)})}}class vt{constructor(){k(this,"adjectives",["Swift","Bright","Clever","Bold","Calm","Cool","Fast","Kind","Smart","Wise","Brave","Gentle","Happy","Lucky","Magic","Pure","Quick","Sharp","Strong","Sweet","True","Wild","Young","Zest","Epic","Noble","Radiant","Vibrant","Dynamic","Elegant","Fierce","Golden","Harmonic","Infinite","Jovial","Keen","Luminous","Mystic","Serene","Vivid","Cosmic","Prismatic","Ethereal","Celestial"]);k(this,"nouns",["Tiger","Eagle","Wolf","Bear","Fox","Hawk","Lion","Deer","Owl","Raven","Falcon","Shark","Dolphin","Phoenix","Dragon","Unicorn","Pegasus","Griffin","Sphinx","Basilisk","Phoenix","Explorer","Navigator","Pioneer","Adventurer","Dreamer","Creator","Builder","Artist","Writer","Sage","Mage","Warrior","Guardian","Wanderer","Seeker","Thinker","Innovator","Visionary","Legend","Philosopher","Inventor","Scholar","Mentor","Guide","Champion"]);k(this,"colors",["Red","Blue","Green","Yellow","Purple","Orange","Pink","Cyan","Magenta","Lime","Indigo","Teal","Coral","Gold","Silver","Copper","Emerald","Ruby","Sapphire","Amber","Pearl","Crystal","Shadow","Light","Dark","Bright","Deep","Rich","Vivid","Pastel","Azure","Crimson","Violet","Turquoise","Scarlet","Ivory","Ebony"])}generateAnonymousHandle(){return u(this,arguments,function*(e={}){const{prefix:t="",includeNumbers:s=!0,format:r="random",maxLength:o=20}=e;let a,c=0;const d=10;do a=this.generateHandle(r,s),t&&(a=t+a),a.length>o&&(a=a.substring(0,o)),c++;while(c<d&&!(yield this.isHandleUnique(a)));if(c>=d){const I=Math.floor(Math.random()*9999);a=a.substring(0,o-4)+I}return{username:a,displayName:a,isGenerated:!0,isUnique:yield this.isHandleUnique(a)}})}generateHandle(e,t){const s=this.getRandomElement(this.adjectives),r=this.getRandomElement(this.nouns),o=this.getRandomElement(this.colors),a=t?Math.floor(Math.random()*9999)+1:"";switch(e){case"adjective-noun":return s+r+a;case"color-noun":return o+r+a;case"adjective-color":return s+o+a;case"noun-color":return r+o+a;case"random":default:{const c=["adjective-noun","color-noun","adjective-color","noun-color"],d=c[Math.floor(Math.random()*c.length)];return this.generateHandle(d,t)}}}getRandomElement(e){return e[Math.floor(Math.random()*e.length)]}isHandleUnique(e){return u(this,null,function*(){try{const{data:t,error:s}=yield O.from("profiles").select("username").eq("username",e).single();return s&&s.code==="PGRST116"?!0:(s&&console.error("Error checking handle uniqueness:",s),!1)}catch(t){return console.error("Error in isHandleUnique:",t),!1}})}validateHandle(e){const t=[];return(!e||e.trim().length===0)&&t.push("Username cannot be empty"),e.length<3&&t.push("Username must be at least 3 characters long"),e.length>30&&t.push("Username cannot exceed 30 characters"),/^[a-zA-Z0-9_-]+$/.test(e)||t.push("Username can only contain letters, numbers, underscores, and hyphens"),["admin","administrator","moderator","mod","support","help","api","www","mail","email","root","user","guest","anonymous","null","undefined","true","false","system","service"].includes(e.toLowerCase())&&t.push("This username is reserved and cannot be used"),["damn","hell","shit","fuck","bitch","ass"].some(o=>e.toLowerCase().includes(o))&&t.push("Username contains inappropriate content"),{isValid:t.length===0,errors:t}}generateHandleSuggestions(){return u(this,arguments,function*(e=5,t={}){const s=[],r=new Set;for(let o=0;o<e*2&&!(s.length>=e);o++){const a=yield this.generateAnonymousHandle(t);r.has(a.username)||(r.add(a.username),s.push(a))}return s.slice(0,e)})}createAnonymousHandleForUser(s){return u(this,arguments,function*(e,t={}){try{const r=yield this.generateAnonymousHandle(t),o=this.validateHandle(r.username);if(!o.isValid)return{success:!1,error:`Invalid handle: ${o.errors.join(", ")}`};if(!(yield this.isHandleUnique(r.username)))return{success:!1,error:"Generated handle is not unique"};const{data:c,error:d}=yield O.from("profiles").update({username:r.username,display_name:r.displayName,is_anonymous:!0,privacy_level:"anonymous",updated_at:new Date().toISOString()}).eq("user_id",e).select().single();return d?(console.error("Error updating profile with anonymous handle:",d),{success:!1,error:d.message}):{success:!0,handle:{username:c.username,displayName:c.display_name,isGenerated:!0,isUnique:!0}}}catch(r){return console.error("Error creating anonymous handle for user:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error occurred"}}})}regenerateAnonymousHandle(s){return u(this,arguments,function*(e,t={}){try{const r=yield this.generateAnonymousHandle(t),o=this.validateHandle(r.username);if(!o.isValid)return{success:!1,error:`Invalid handle: ${o.errors.join(", ")}`};if(!(yield this.isHandleUnique(r.username)))return{success:!1,error:"Generated handle is not unique"};const{data:c,error:d}=yield O.from("profiles").update({username:r.username,display_name:r.displayName,updated_at:new Date().toISOString()}).eq("user_id",e).select().single();return d?(console.error("Error updating profile with new anonymous handle:",d),{success:!1,error:d.message}):{success:!0,handle:{username:c.username,displayName:c.display_name,isGenerated:!0,isUnique:!0}}}catch(r){return console.error("Error regenerating anonymous handle:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error occurred"}}})}getHandleStatistics(){return u(this,null,function*(){try{const{data:e,error:t}=yield O.from("profiles").select("username, is_anonymous, privacy_level");if(t)return console.error("Error fetching handle statistics:",t),{totalHandles:0,anonymousHandles:0,publicHandles:0,uniquePrefixes:[]};const s=(e==null?void 0:e.length)||0,r=(e==null?void 0:e.filter(c=>c.is_anonymous).length)||0,o=(e==null?void 0:e.filter(c=>c.privacy_level==="public").length)||0,a=new Set;return e==null||e.forEach(c=>{var I;const d=(I=c.username)==null?void 0:I.split(/[0-9_-]/)[0];d&&d.length>2&&a.add(d)}),{totalHandles:s,anonymousHandles:r,publicHandles:o,uniquePrefixes:Array.from(a)}}catch(e){return console.error("Error in getHandleStatistics:",e),{totalHandles:0,anonymousHandles:0,publicHandles:0,uniquePrefixes:[]}}})}}const xt=new vt,wt=m.memo(({children:i})=>{const[e,t]=m.useState(null),[s,r]=m.useState(null),[o,a]=m.useState(!0),[c,d]=m.useState(navigator.onLine),[I,C]=m.useState("connecting"),{toast:h}=Q();m.useEffect(()=>{const p=()=>{d(!0),C("connecting"),gt().then(l=>{l?(C("connected"),initializeAuth()):C("failed")})},f=()=>{d(!1),C("offline")};return window.addEventListener("online",p),window.addEventListener("offline",f),()=>{window.removeEventListener("online",p),window.removeEventListener("offline",f)}},[]),m.useEffect(()=>{const f=setInterval(()=>{const l=ft();C(l)},5e3);return()=>clearInterval(f)},[]),m.useEffect(()=>{let p=!0;u(null,null,function*(){var v,y;try{if(console.log("Initializing authentication..."),yt()){console.log("Stale authentication data detected, clearing..."),J(),p&&(r(null),t(null),a(!1));return}if(!navigator.onLine){console.warn("Network is offline, using cached session"),C("offline");const x=localStorage.getItem("supabase.auth.token");if(x)try{const E=JSON.parse(x);p&&(r(E),t((v=E==null?void 0:E.user)!=null?v:null),a(!1))}catch(E){console.error("Failed to parse cached session:",E),J()}else a(!1);return}const{data:R,error:w}=yield _(()=>u(null,null,function*(){const{data:{session:x},error:E}=yield T.auth.getSession();if(E)throw E;return x}),null,"Failed to get session during initialization");if(w){console.error("Error getting session:",w),C("failed"),p&&(r(null),t(null),a(!1)),h({title:"Connection Issue",description:"Unable to connect to authentication service. Some features may be limited.",variant:"destructive"});return}const A=R;if(A&&A.expires_at&&new Date(A.expires_at*1e3)<new Date){console.log("Session has expired, clearing auth state"),p&&(r(null),t(null),a(!1));return}p&&(r(A),t((y=A==null?void 0:A.user)!=null?y:null),a(!1),C("connected"))}catch(R){console.error("Error during auth initialization:",R),C("failed"),p&&(r(null),t(null),a(!1)),h({title:"Authentication Error",description:"Failed to initialize authentication. Please refresh the page.",variant:"destructive"})}});const{data:{subscription:l}}=T.auth.onAuthStateChange((v,y)=>u(null,null,function*(){var R,w;console.log("Auth state changed:",v,(R=y==null?void 0:y.user)==null?void 0:R.id),p&&(r(y),t((w=y==null?void 0:y.user)!=null?w:null),a(!1),y?C("connected"):navigator.onLine?C("failed"):C("offline"))}));return()=>{p=!1,l.unsubscribe()}},[h]);const Y=m.useCallback((p,f,l,v,y)=>u(null,null,function*(){var R;try{if(!navigator.onLine)return h({title:"Network Error",description:"Please check your internet connection and try again.",variant:"destructive"}),{error:new Error("Network offline")};const{data:w,error:A}=yield _(()=>u(null,null,function*(){const{data:x,error:E}=yield T.auth.signUp({email:p,password:f,options:{data:{first_name:l,last_name:v,user_type:y||"user"}}});if(E)throw E;return x}),null,"Sign up failed");if(A){const x=A.message||"An unexpected error occurred";return console.error("Sign up error:",A),h({title:"Sign Up Failed",description:x,variant:"destructive"}),{error:new Error(x)}}if(w!=null&&w.user){if(w.session)try{yield new Promise(E=>setTimeout(E,1e3));const x=yield ue.getUserProfile(w.user.id);if(!x.profile)console.log("Profile not found, creating manually..."),yield ue.createUserProfile({user_id:w.user.id,user_type:y||"user",display_name:`${l||""} ${v||""}`.trim()||p,first_name:l,last_name:v});else{console.log("Creating anonymous handle for new user...");const E=yield xt.createAnonymousHandleForUser(w.user.id,{format:"random",includeNumbers:!0,maxLength:20});if(E.success?console.log("Anonymous handle created:",(R=E.handle)==null?void 0:R.username):console.warn("Failed to create anonymous handle:",E.error),x.profile.user_type!==(y||"user")||!x.profile.first_name||!x.profile.last_name||!x.profile.display_name){console.log("Updating profile with missing fields...");const{error:L}=yield T.from("profiles").update({user_type:y||"user",first_name:l||x.profile.first_name,last_name:v||x.profile.last_name,display_name:x.profile.display_name||`${l||""} ${v||""}`.trim()||p}).eq("user_id",w.user.id);L&&console.error("Error updating profile:",L)}if((y||"user")==="artist"&&!x.artistProfile){console.log("Creating artist profile...");const{error:L}=yield T.from("artists").insert({user_id:w.user.id,specialty:[],experience_years:0,portfolio_urls:[],bio:"Professional artist - completing profile setup...",is_available:!0});L&&console.error("Error creating artist profile:",L)}}}catch(x){console.error("Error ensuring profile exists:",x)}w.session?h({title:"Welcome!",description:`Account created successfully as ${y||"user"}.`}):h({title:"Sign Up Successful",description:"Please check your email to verify your account."})}return{error:null}}catch(w){const A=w instanceof Error?w.message:"An unexpected error occurred";return console.error("Sign up error:",w),h({title:"Sign Up Failed",description:A,variant:"destructive"}),{error:new Error(A)}}}),[h]),X=m.useCallback((p,f)=>u(null,null,function*(){try{if(!navigator.onLine)return h({title:"Network Error",description:"Please check your internet connection and try again.",variant:"destructive"}),{error:new Error("Network offline")};const{data:l,error:v}=yield _(()=>u(null,null,function*(){const{data:y,error:R}=yield T.auth.signInWithPassword({email:p,password:f});if(R)throw R;return y}),null,"Sign in failed");if(v){const y=v.message||"An unexpected error occurred";return console.error("Sign in error:",v),h({title:"Sign In Failed",description:y,variant:"destructive"}),{error:new Error(y)}}return l!=null&&l.user&&h({title:"Welcome Back!",description:`Signed in as ${l.user.email}`}),{error:null}}catch(l){const v=l instanceof Error?l.message:"An unexpected error occurred";return console.error("Sign in error:",l),h({title:"Sign In Failed",description:v,variant:"destructive"}),{error:new Error(v)}}}),[h]),K=m.useCallback(p=>u(null,null,function*(){try{if(!navigator.onLine)return h({title:"Network Error",description:"Please check your internet connection and try again.",variant:"destructive"}),{error:new Error("Network offline")};const{data:f,error:l}=yield _(()=>u(null,null,function*(){const{data:v,error:y}=yield T.auth.signInWithOAuth({provider:p,options:{redirectTo:`${window.location.origin}/auth/callback`}});if(y)throw y;return v}),null,"OAuth sign in failed");if(l){const v=l.message||"An unexpected error occurred";return console.error("OAuth sign in error:",l),h({title:"OAuth Sign In Failed",description:v,variant:"destructive"}),{error:new Error(v)}}return{error:null}}catch(f){const l=f instanceof Error?f.message:"An unexpected error occurred";return console.error("OAuth sign in error:",f),h({title:"OAuth Sign In Failed",description:l,variant:"destructive"}),{error:new Error(l)}}}),[h]),Z=m.useCallback(()=>u(null,null,function*(){try{const{error:p}=yield _(()=>u(null,null,function*(){const{error:f}=yield T.auth.signOut();if(f)throw f;return{success:!0}}),{success:!1},"Sign out failed");p?(console.error("Sign out error:",p),h({title:"Sign Out Failed",description:"There was an error signing you out.",variant:"destructive"})):h({title:"Signed Out",description:"You have been successfully signed out."})}catch(p){console.error("Sign out error:",p),h({title:"Sign Out Failed",description:"There was an error signing you out.",variant:"destructive"})}}),[h]),ee=m.useCallback(p=>u(null,null,function*(){try{if(!navigator.onLine)return h({title:"Network Error",description:"Please check your internet connection and try again.",variant:"destructive"}),{error:new Error("Network offline")};const{error:f}=yield _(()=>u(null,null,function*(){const{error:l}=yield T.auth.resetPasswordForEmail(p,{redirectTo:`${window.location.origin}/auth/reset-password`});if(l)throw l;return{success:!0}}),{success:!1},"Password reset request failed");if(f){const l=f.message||"An unexpected error occurred";return console.error("Password reset request error:",f),h({title:"Password Reset Failed",description:l,variant:"destructive"}),{error:new Error(l)}}return h({title:"Password Reset Email Sent",description:"Check your email for password reset instructions."}),{error:null}}catch(f){const l=f instanceof Error?f.message:"An unexpected error occurred";return console.error("Password reset request error:",f),h({title:"Password Reset Failed",description:l,variant:"destructive"}),{error:new Error(l)}}}),[h]),te=m.useCallback((p,f)=>u(null,null,function*(){try{if(!navigator.onLine)return h({title:"Network Error",description:"Please check your internet connection and try again.",variant:"destructive"}),{error:new Error("Network offline")};if(f.length<12)return h({title:"Password Too Weak",description:"Password must be at least 12 characters long.",variant:"destructive"}),{error:new Error("Password too weak")};const{error:l}=yield T.auth.updateUser({password:f});return l?(h({title:"Password Reset Failed",description:l.message||"Failed to reset password",variant:"destructive"}),{error:new Error(l.message)}):(h({title:"Password Updated",description:"Your password has been successfully updated."}),{error:null})}catch(l){const v=l instanceof Error?l.message:"An unexpected error occurred";return console.error("Password reset error:",l),h({title:"Password Reset Failed",description:v,variant:"destructive"}),{error:new Error(v)}}}),[h]),re=m.useCallback(()=>{J(),t(null),r(null),h({title:"Auth Data Cleared",description:"Authentication data has been cleared. Please sign in again."})},[h]),Te=m.useMemo(()=>({user:e,session:s,loading:o,isOnline:c,connectionStatus:I,signUp:Y,signIn:X,signInWithOAuth:K,signOut:Z,requestPasswordReset:ee,resetPassword:te,clearAuthData:re}),[e,s,o,c,I,Y,X,K,Z,ee,te,re]);return n.jsx(ke.Provider,{value:Te,children:i})}),bt=new Ue({defaultOptions:{queries:{staleTime:300*1e3,gcTime:600*1e3,retry:(i,e)=>{if(e&&typeof e=="object"&&"status"in e){const t=e.status;if(t>=400&&t<500)return!1}return i<3},refetchOnWindowFocus:!1,refetchOnReconnect:!0},mutations:{retry:(i,e)=>{if(e&&typeof e=="object"&&"status"in e){const t=e.status;if(t>=400&&t<500)return!1}return i<2}}}}),St=({children:i})=>n.jsx(Ke,{client:bt,children:i}),Et=()=>{m.useEffect(()=>(console.log("Voice commands initialized"),()=>{console.log("Voice commands cleaned up")}),[])},kt=m.lazy(()=>z(()=>import("./OnboardingFlow.tsx-COH9ZvBM.js"),__vite__mapDeps([0,1])).then(i=>({default:i.OnboardingFlow})));m.lazy(()=>z(()=>import("./MobileBottomNavigation.tsx-CF4d8Atr.js"),__vite__mapDeps([2,1])).then(i=>({default:i.MobileLayout})));const jt=m.lazy(()=>z(()=>import("./VoiceControlPanel.tsx-Cte4QF9t.js"),__vite__mapDeps([3,1])).then(i=>({default:i.VoiceControlPanel}))),Ct=m.lazy(()=>z(()=>import("./chunk-BvaMdVk8.js").then(i=>i.A),__vite__mapDeps([4,5,1,6,7,8])).then(i=>({default:i.AppRoutes}))),At=m.lazy(()=>z(()=>import("./ResponsiveLayout.tsx-CBMj4ano.js"),__vite__mapDeps([9,1])).then(i=>({default:i.ResponsiveLayout})));m.lazy(()=>z(()=>import("./LazyLoader.tsx-CRN4efCk.js"),__vite__mapDeps([10,1])).then(i=>({default:i.LazyLoader})));function It(){const{user:i,isLoading:e}=ct(),{toast:t}=Q(),[s,r]=m.useState(!1),[o,a]=m.useState(!1);Et(),m.useEffect(()=>{mt(),ht()},[]),m.useEffect(()=>{u(null,null,function*(){try{(yield lt({onUpdate:h=>{console.log("New content available, reloading..."),t({title:"Update Available",description:"A new version is available. The page will reload.",duration:5e3}),setTimeout(()=>window.location.reload(),2e3)},onSuccess:h=>{console.log("Service Worker registered successfully"),a(!0)},onError:h=>{console.error("Service Worker registration failed:",h),t({title:"Service Worker Error",description:"Some offline features may not be available.",variant:"destructive"})}}))&&a(!0)}catch(C){console.error("Error registering Service Worker:",C)}})},[t]),m.useEffect(()=>{i&&!e&&(localStorage.getItem("onboarding_completed")||r(!0))},[i,e]);const c=()=>{localStorage.setItem("onboarding_completed","true"),r(!1)},d=()=>{r(!1)};return s?n.jsx(ae,{level:"page",showDetails:!1,children:n.jsx(m.Suspense,{fallback:n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading onboarding..."}),children:n.jsx(kt,{onComplete:c,onSkip:d})})}):e?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse",children:n.jsx("span",{className:"text-white font-bold text-xl",children:"G"})}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading TheGlocal"}),n.jsx("p",{className:"text-gray-600",children:"Setting up your community experience..."})]})}):n.jsx(ae,{level:"critical",showDetails:!1,children:n.jsx(m.Suspense,{fallback:n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading app..."}),children:n.jsx(Me,{children:n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx(m.Suspense,{fallback:n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading layout..."}),children:n.jsx(At,{children:n.jsx(De,{children:n.jsx(Ve,{path:"/*",element:n.jsx(m.Suspense,{fallback:n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading routes..."}),children:n.jsx(Ct,{})})})})})}),n.jsx("div",{className:"hidden md:block fixed bottom-4 right-4 z-40",children:n.jsx(m.Suspense,{fallback:n.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full animate-pulse"}),children:n.jsx(jt,{compact:!0})})}),o&&n.jsx("div",{className:"fixed top-4 right-4 z-50",children:n.jsx("div",{className:"bg-green-500 text-white px-3 py-1 rounded-full text-xs font-medium shadow-lg",children:"Offline Ready"})}),n.jsx(at,{})]})})})})}function Nt(){return n.jsx(St,{children:n.jsx(wt,{children:n.jsx(It,{})})})}class Rt extends m.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?this.props.fallback||n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:[n.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:n.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center mb-2",children:"Something went wrong"}),n.jsx("p",{className:"text-sm text-gray-500 text-center mb-4",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Try Again"}),n.jsx("button",{onClick:()=>window.location.href="/",className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Go to Home"})]}),!1]})}):this.props.children}}typeof window!="undefined"&&(window.React=b,b.Children||console.warn("React.Children not found, this may cause issues"));if(!b||typeof b.createContext!="function"||typeof b.createElement!="function")throw new Error("React is not properly loaded - missing core functions");b.Children||console.error("React.Children is not available - this will cause runtime errors");const B=document.getElementById("root");if(!B)throw new Error("Root element not found");B.innerHTML="";const Pt=Le.createRoot(B);let U=0;const de=3,Pe=()=>{try{Pt.render(n.jsx(b.StrictMode,{children:n.jsx(Rt,{children:n.jsx(Nt,{})})}))}catch(i){console.error(`Render attempt ${U+1} failed:`,i),U<de?(U++,console.log(`Retrying render (attempt ${U}/${de})...`),setTimeout(Pe,1e3*U)):(console.error("All render attempts failed"),B.innerHTML=`
        <div style="padding: 20px; color: red; text-align: center; font-family: system-ui, sans-serif;">
          <h2>Application Failed to Load</h2>
          <p>Please refresh the page or try again later.</p>
          <button onclick="window.location.reload()" style="padding: 10px 20px; margin-top: 10px; cursor: pointer;">
            Refresh Page
          </button>
        </div>
      `)}};Pe();export{D as B,je as C,Rt as E,ue as U,Ne as a,Ce as b,Ae as c,N as d,Q as e,Ie as f,T as r,O as s,ct as u};
