var Z=Object.defineProperty,K=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var G=(n,t,r)=>t in n?Z(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,M=(n,t)=>{for(var r in t||(t={}))ee.call(t,r)&&G(n,r,t[r]);if(B)for(var r of B(t))se.call(t,r)&&G(n,r,t[r]);return n},P=(n,t)=>K(n,Y(t));var S=(n,t,r)=>new Promise((p,v)=>{var l=c=>{try{o(r.next(c))}catch(g){v(g)}},j=c=>{try{o(r.throw(c))}catch(g){v(g)}},o=c=>c.done?p(c.value):Promise.resolve(c.value).then(l,j);o((r=r.apply(n,t)).next())});import{r as m,j as e}from"./chunk-V8Tq47hD.js";import{e as ae,s as te,C as z,b as H,c as Q,f as le,a as W,B as E,u as re}from"./main-nj8_qmr1.js";import{I as h}from"./chunk-CfjvP89K.js";import{L as d}from"./chunk-Ch6abJed.js";import{T as ie}from"./chunk-DiXj0jE4.js";import{S as T,a as A,b as D,c as k,d as u}from"./chunk-BJzCN5QX.js";import{ResponsiveLayout as ne}from"./ResponsiveLayout.tsx-CBMj4ano.js";import{u as ce}from"./chunk-B8PQiX0I.js";import{B as L}from"./chunk-BqqQDpKD.js";import{A as O,a as U}from"./chunk-DzbWDm6p.js";import{X as V,f as $,_ as F,v as de,A as oe,I as me,E as xe,a4 as he,c as ue,M as J,C as R,z as ve,U as je,a5 as ge,Z as pe}from"./chunk-BD2ShIYc.js";import{p as fe}from"./chunk-aOfXXddH.js";import"./chunk-7Gxbu0Lx.js";import"./chunk-BbVfpXIH.js";import"./chunk-HDUI5Ctd.js";import"./chunk-jOF7Mqj2.js";import"./chunk-DkszvQuI.js";import"./chunk-Cv5hKDJv.js";import"./chunk-DJWri4GU.js";import"./chunk-M09l3cRM.js";const Ne=({eventId:n,selectedAuthorities:t,onAuthoritiesChange:r,compact:p=!1,showContactInfo:v=!0})=>{const{toast:l}=ae(),[j,o]=m.useState([]),[c,g]=m.useState([]),[i,b]=m.useState(""),[a,f]=m.useState("all"),[N,C]=m.useState(!1);m.useEffect(()=>{I()},[I]),m.useEffect(()=>{let s=j;i.trim()&&(s=s.filter(x=>x.name.toLowerCase().includes(i.toLowerCase())||x.department.toLowerCase().includes(i.toLowerCase())||x.jurisdiction.toLowerCase().includes(i.toLowerCase()))),a!=="all"&&(s=s.filter(x=>x.level===a)),g(s)},[j,i,a]);const I=m.useCallback(()=>S(null,null,function*(){try{C(!0);const{data:s,error:x}=yield te.from("government_authorities").select("*").eq("is_active",!0).order("level",{ascending:!0}).order("name",{ascending:!0});if(x)throw x;o(s||[])}catch(s){console.error("Error loading government authorities:",s),l({title:"Error",description:"Failed to load government authorities.",variant:"destructive"})}finally{C(!1)}}),[l]),w=s=>{const x=t.includes(s)?t.filter(X=>X!==s):[...t,s];r(x)},y=s=>{switch(s){case"local":return"bg-blue-100 text-blue-800 border-blue-200";case"state":return"bg-green-100 text-green-800 border-green-200";case"national":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_=s=>{switch(s){case"local":return e.jsx(J,{className:"h-4 w-4"});case"state":return e.jsx(F,{className:"h-4 w-4"});case"national":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx(F,{className:"h-4 w-4"})}},q=()=>j.filter(s=>t.includes(s.id));return p?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{className:"text-base font-medium",children:"Tag Government Authorities"}),e.jsxs(L,{variant:"secondary",children:[t.length," selected"]})]}),t.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:q().map(s=>e.jsxs(L,{className:`${y(s.level)} flex items-center gap-1`,children:[_(s.level),s.name,e.jsx("button",{onClick:()=>w(s.id),className:"ml-1 hover:text-red-500",children:e.jsx(V,{className:"h-3 w-3"})})]},s.id))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{placeholder:"Search authorities...",value:i,onChange:s=>b(s.target.value),className:"text-sm"}),e.jsxs(T,{value:a,onValueChange:s=>f(s),children:[e.jsx(A,{className:"text-sm",children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(u,{value:"all",children:"All Levels"}),e.jsx(u,{value:"local",children:"Local"}),e.jsx(u,{value:"state",children:"State"}),e.jsx(u,{value:"national",children:"National"})]})]})]}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:c.map(s=>e.jsxs("div",{className:`p-2 border rounded cursor-pointer transition-all text-sm ${t.includes(s.id)?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>w(s.id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[_(s.level),e.jsx("span",{className:"font-medium",children:s.name})]}),t.includes(s.id)&&e.jsx($,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[s.department," • ",s.jurisdiction]})]},s.id))})]}):e.jsxs(z,{className:"w-full",children:[e.jsxs(H,{children:[e.jsxs(Q,{className:"flex items-center",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Government Authority Tagging"]}),e.jsx(le,{children:"Tag relevant government authorities for civic events, protests, or community issues"})]}),e.jsxs(W,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"search",className:"text-sm font-medium",children:"Search Authorities"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(h,{id:"search",placeholder:"Search by name, department, or jurisdiction...",value:i,onChange:s=>b(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"level-filter",className:"text-sm font-medium",children:"Filter by Level"}),e.jsxs(T,{value:a,onValueChange:s=>f(s),children:[e.jsx(A,{className:"mt-1",children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(u,{value:"all",children:"All Levels"}),e.jsx(u,{value:"local",children:"Local Government"}),e.jsx(u,{value:"state",children:"State Government"}),e.jsx(u,{value:"national",children:"National Government"})]})]})]})]}),t.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Selected Authorities (",t.length,")"]}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>r([]),children:"Clear All"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:q().map(s=>e.jsx("div",{className:`p-3 border rounded-lg ${y(s.level)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[_(s.level),e.jsx("span",{className:"font-medium",children:s.name})]}),e.jsx("p",{className:"text-sm opacity-80",children:s.department}),e.jsx("p",{className:"text-xs opacity-70",children:s.jurisdiction})]}),e.jsx("button",{onClick:()=>w(s.id),className:"ml-2 hover:text-red-500",children:e.jsx(V,{className:"h-4 w-4"})})]})},s.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Available Authorities (",c.length,")"]}),N&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading..."})]}),c.length===0&&!N&&e.jsxs(O,{children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx(U,{children:"No authorities found matching your criteria."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:c.map(s=>e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md ${t.includes(s.id)?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>w(s.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[_(s.level),e.jsx("h5",{className:"font-medium",children:s.name}),e.jsx(L,{className:y(s.level),children:s.level})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.department}),e.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["Jurisdiction: ",s.jurisdiction]}),v&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(me,{className:"h-3 w-3"}),e.jsx("span",{children:s.contact_email})]}),s.contact_phone&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{children:s.contact_phone})]})]})]}),t.includes(s.id)&&e.jsx($,{className:"h-5 w-5 text-primary ml-2"})]})},s.id))})]}),e.jsxs(O,{className:"bg-blue-50 border-blue-200",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:"When to tag government authorities:"}),e.jsxs("ul",{className:"text-sm space-y-1 ml-4",children:[e.jsx("li",{children:"• Civic events and town halls"}),e.jsx("li",{children:"• Protests and demonstrations"}),e.jsx("li",{children:"• Community issues requiring government attention"}),e.jsx("li",{children:"• Public policy discussions"}),e.jsx("li",{children:"• Environmental or safety concerns"})]})]})})]})]})]})},Ve=()=>{const n=fe(),{user:t}=re(),{createEvent:r}=ce(),[p,v]=m.useState(!1),[l,j]=m.useState({title:"",description:"",event_date:"",event_time:"",location_name:"",category:"",max_attendees:"",price:"",image_url:"",tags:""}),[o,c]=m.useState([]),g=a=>S(null,null,function*(){if(a.preventDefault(),!t){n("/signin");return}v(!0);const f={title:l.title,description:l.description,event_date:l.event_date,event_time:l.event_time,location_name:l.location_name,category:l.category||void 0,max_attendees:l.max_attendees?parseInt(l.max_attendees):void 0,price:l.price?parseFloat(l.price):0,image_url:l.image_url||void 0,tags:l.tags?l.tags.split(",").map(C=>C.trim()):void 0,government_authority_id:o.length>0?o[0]:void 0,target_authority:o.length>0?o:void 0};(yield r(f))&&n("/events"),v(!1)}),i=(a,f)=>{j(N=>P(M({},N),{[a]:f}))},b=["Art & Culture","Music","Food & Drink","Sports & Fitness","Technology","Business","Education","Health & Wellness","Community","Entertainment","Other"];return e.jsx(ne,{children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Create Event"})]}),e.jsxs(z,{children:[e.jsx(H,{children:e.jsx(Q,{children:"Event Details"})}),e.jsx(W,{children:e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"title",children:"Event Title *"}),e.jsx(h,{id:"title",value:l.title,onChange:a=>i("title",a.target.value),placeholder:"Enter event title",required:!0})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",children:"Description"}),e.jsx(ie,{id:"description",value:l.description,onChange:a=>i("description",a.target.value),placeholder:"Describe your event",rows:3})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"event_date",className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Date *"]}),e.jsx(h,{id:"event_date",type:"date",value:l.event_date,onChange:a=>i("event_date",a.target.value),min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"event_time",className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"Time *"]}),e.jsx(h,{id:"event_time",type:"time",value:l.event_time,onChange:a=>i("event_time",a.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"location_name",className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Location *"]}),e.jsx(h,{id:"location_name",value:l.location_name,onChange:a=>i("location_name",a.target.value),placeholder:"Event venue or address",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Category"}),e.jsxs(T,{value:l.category,onValueChange:a=>i("category",a),children:[e.jsx(A,{children:e.jsx(D,{placeholder:"Select category"})}),e.jsx(k,{children:b.map(a=>e.jsx(u,{value:a,children:a},a))})]})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"max_attendees",className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Max Attendees"]}),e.jsx(h,{id:"max_attendees",type:"number",value:l.max_attendees,onChange:a=>i("max_attendees",a.target.value),placeholder:"Optional",min:"1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"price",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Price (USD)"]}),e.jsx(h,{id:"price",type:"number",value:l.price,onChange:a=>i("price",a.target.value),placeholder:"0 for free events",min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"image_url",children:"Image URL"}),e.jsx(h,{id:"image_url",type:"url",value:l.image_url,onChange:a=>i("image_url",a.target.value),placeholder:"Optional event image"})]})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"tags",className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Tags"]}),e.jsx(h,{id:"tags",value:l.tags,onChange:a=>i("tags",a.target.value),placeholder:"photography, outdoor, beginner (comma separated)"})]}),e.jsx(Ne,{selectedAuthorities:o,onAuthoritiesChange:c,compact:!0,showContactInfo:!1}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(E,{type:"submit",disabled:p,className:"flex-1",children:p?"Creating...":"Create Event"}),e.jsx(E,{type:"button",variant:"outline",onClick:()=>n("/events"),children:"Cancel"})]})]})})]})]})})};export{Ve as default};
