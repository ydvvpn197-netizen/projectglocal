var e=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(s,i,t)=>i in s?e(s,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[i]=t,l=(e,s,i)=>new Promise((t,a)=>{var r=e=>{try{l(i.next(e))}catch(s){a(s)}},n=e=>{try{l(i.throw(e))}catch(s){a(s)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,n);l((i=i.apply(e,s)).next())});import{u as c,d as o,r as d,s as m,j as x,C as h,v as j,w as u,y as p,x as g,B as f,b as v,S as N}from"./main-u5iDOJMZ.js";import{R as b}from"./ResponsiveLayout-CaFEj6Sr.js";import{B as y}from"./badge-k0SsuPwB.js";import{S as w}from"./separator-BdZu64Yb.js";import{S as k}from"./scroll-area-DANvZfFy.js";import{D as _,e as B,a as C,b as P,c as D,d as S}from"./dialog-D7WpG6pZ.js";import{C as A}from"./index-B7-3ofi9.js";import{U as $}from"./user-DlaYKRnl.js";import{f as E}from"./index-azXaBhbR.js";import{M as O}from"./map-pin-CcmxiK6P.js";import{D as q}from"./dollar-sign-BB-VnfLW.js";import{M}from"./message-circle-nfkvwkJk.js";import{C as z}from"./clock-k4Wuy6bB.js";import{C as T}from"./check-circle-Unk97XuD.js";import{X as U}from"./x-circle-Dz5LHxry.js";import{T as L,a as F,b as I,c as R}from"./tabs-Dn7YRzvT.js";import{A as V,a as X,b as K,i as Q}from"./sheet-BES5Q-Ko.js";import{C as W}from"./calendar-days-DcVbDuWb.js";import"./input-d0wpgTJ2.js";import"./NotificationBell-4ukuyDx4.js";import"./Combination-D3NAapk3.js";import"./useNotifications-DNCpc7NU.js";import"./index-Dy-VqNBB.js";import"./check-CT-bNmTi.js";import"./bell-wBykza9e.js";import"./NotificationButton-QcrDLMMB.js";import"./search-BsWmJlwB.js";import"./users-BKDXsamp.js";import"./zap-BrBeKdrO.js";import"./message-square-DQ5316cR.js";import"./alert-7nHfBPfv.js";import"./wifi-DNTf1l7S.js";import"./log-out-CGc8M4_-.js";import"./index-jVOyRz7F.js";const Y=()=>{const{user:e}=c(),{toast:v}=o(),[N,b]=d.useState([]),[L,F]=d.useState(!0),I=d.useCallback(()=>l(void 0,null,function*(){if(e)try{const{data:c,error:o}=yield m.from("artist_bookings").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(o)throw o;const d=yield Promise.all((c||[]).map(e=>l(void 0,null,function*(){var l;const{data:c}=yield m.from("profiles").select("display_name, avatar_url, artist_skills").eq("user_id",e.artist_id).single();return((e,t)=>s(e,i(t)))(((e,s)=>{for(var i in s||(s={}))a.call(s,i)&&n(e,i,s[i]);if(t)for(var i of t(s))r.call(s,i)&&n(e,i,s[i]);return e})({},e),{artist_name:(null==c?void 0:c.display_name)||"Unknown Artist",artist_avatar:(null==c?void 0:c.avatar_url)||"",artist_specialty:(null==(l=null==c?void 0:c.artist_skills)?void 0:l[0])||"Artist"})})));b(d)}catch(c){v({title:"Error",description:"Failed to load your bookings",variant:"destructive"})}finally{F(!1)}}),[e,v]);d.useEffect(()=>{if(e){I();const s=m.channel("client-bookings").on("postgres_changes",{event:"UPDATE",schema:"public",table:"artist_bookings",filter:`user_id=eq.${e.id}`},()=>{I()}).subscribe();return()=>{m.removeChannel(s)}}},[e,I]);const R=e=>{switch(e){case"pending":return x.jsx(y,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"Pending"});case"accepted":return x.jsx(y,{variant:"outline",className:"text-green-600 border-green-600",children:"Accepted"});case"declined":return x.jsx(y,{variant:"outline",className:"text-red-600 border-red-600",children:"Declined"});case"completed":return x.jsx(y,{variant:"outline",className:"text-blue-600 border-blue-600",children:"Completed"});default:return x.jsx(y,{variant:"outline",children:e})}},V=e=>{switch(e){case"pending":return x.jsx(z,{className:"h-4 w-4 text-yellow-600"});case"accepted":return x.jsx(T,{className:"h-4 w-4 text-green-600"});case"declined":return x.jsx(U,{className:"h-4 w-4 text-red-600"});case"completed":return x.jsx(T,{className:"h-4 w-4 text-blue-600"});default:return x.jsx(z,{className:"h-4 w-4"})}};return e?L?x.jsxs(h,{children:[x.jsx(j,{children:x.jsx(u,{children:"My Bookings"})}),x.jsx(p,{children:x.jsx("div",{className:"flex items-center justify-center py-8",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):x.jsxs(h,{children:[x.jsxs(j,{children:[x.jsxs(u,{className:"flex items-center gap-2",children:[x.jsx(A,{className:"h-5 w-5"}),"My Bookings"]}),x.jsx(g,{children:"View and manage your booking requests"})]}),x.jsx(p,{children:0===N.length?x.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[x.jsx(A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),x.jsx("p",{children:"No bookings yet"}),x.jsx("p",{className:"text-sm",children:"Your booking requests will appear here"})]}):x.jsx(k,{className:"h-96",children:x.jsx("div",{className:"space-y-4",children:N.map(e=>x.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:x.jsx($,{className:"h-5 w-5 text-primary"})}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium",children:e.artist_name}),x.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.artist_specialty," â€¢ ",E(new Date(e.created_at),"PPp")]})]})]}),R(e.status)]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:E(new Date(e.event_date),"PPP")})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{className:"truncate",children:e.event_location||"Location TBD"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(q,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:e.budget_min&&e.budget_max?`$${e.budget_min} - $${e.budget_max}`:"Budget TBD"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[V(e.status),x.jsx("span",{className:"capitalize",children:e.status})]})]}),x.jsx("div",{className:"space-y-2",children:x.jsx("p",{className:"text-sm text-muted-foreground",children:e.event_description})}),x.jsx(w,{}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs(_,{children:[x.jsx(B,{asChild:!0,children:x.jsx(f,{variant:"outline",size:"sm",children:"View Details"})}),x.jsxs(C,{children:[x.jsxs(P,{children:[x.jsx(D,{children:"Booking Details"}),x.jsx(S,{children:"Full information about this booking"})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Artist Information"}),x.jsxs("p",{children:["Name: ",e.artist_name]}),x.jsxs("p",{children:["Specialty: ",e.artist_specialty]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Event Details"}),x.jsxs("div",{className:"space-y-1 text-sm",children:[x.jsxs("p",{children:[x.jsx("strong",{children:"Date:"})," ",E(new Date(e.event_date),"PPP")]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Location:"})," ",e.event_location]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Description:"})," ",e.event_description]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Budget:"}),e.budget_min&&e.budget_max?` $${e.budget_min} - $${e.budget_max}`:" Not specified"]}),x.jsxs("p",{children:[x.jsx("strong",{children:"Status:"})," ",x.jsx("span",{className:"capitalize",children:e.status})]})]})]})]})]})]}),x.jsxs("div",{className:"flex gap-2",children:["accepted"===e.status&&x.jsxs(f,{size:"sm",onClick:()=>window.location.href=`/chat/${e.id}`,children:[x.jsx(M,{className:"h-4 w-4 mr-1"}),"Chat with Artist"]}),"pending"===e.status&&x.jsx(f,{size:"sm",variant:"outline",onClick:()=>{v({title:"Contact Support",description:"Please contact support to cancel this booking"})},children:"Cancel Booking"})]})]})]},e.id))})})})]}):null},G=()=>{var e,s;const{user:i}=c(),t=v(),[a,r]=d.useState({totalBookings:0,pendingBookings:0,activeBookings:0,completedBookings:0}),[n,o]=d.useState(null),[w,k]=d.useState(!0),[_,B]=d.useState("bookings");d.useEffect(()=>{i&&C()},[i,C]);const C=d.useCallback(()=>l(void 0,null,function*(){if(i)try{const{data:e,error:s}=yield m.from("profiles").select("*").eq("user_id",i.id).single();if(s)throw s;o(e);const{data:t,error:a}=yield m.from("artist_bookings").select("status").eq("user_id",i.id);if(a)throw a;const n=(null==t?void 0:t.length)||0,l=(null==t?void 0:t.filter(e=>"pending"===e.status).length)||0,c=(null==t?void 0:t.filter(e=>"accepted"===e.status).length)||0,d=(null==t?void 0:t.filter(e=>"completed"===e.status).length)||0;r({totalBookings:n,pendingBookings:l,activeBookings:c,completedBookings:d})}catch(e){}finally{k(!1)}}),[i]);return i?w?x.jsx(b,{children:x.jsx("div",{className:"container max-w-6xl mx-auto p-6",children:x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})}):x.jsx(b,{children:x.jsxs("div",{className:"container max-w-6xl mx-auto p-6",children:[x.jsx("div",{className:"mb-8",children:x.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[x.jsxs(V,{className:"h-16 w-16",children:[x.jsx(X,{src:null==n?void 0:n.avatar_url}),x.jsx(K,{className:"text-lg",children:(null==(e=null==n?void 0:n.display_name)?void 0:e.charAt(0))||(null==(s=i.email)?void 0:s.charAt(0))||"U"})]}),x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold",children:(null==n?void 0:n.display_name)||"User"}),x.jsx("p",{className:"text-muted-foreground",children:i.email})]})]})}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>B("bookings"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Bookings"}),x.jsx("p",{className:"text-2xl font-bold",children:a.totalBookings})]}),x.jsx(W,{className:"h-8 w-8 text-primary"})]})})}),x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>B("bookings"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pending"}),x.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:a.pendingBookings})]}),x.jsx(z,{className:"h-8 w-8 text-yellow-600"})]})})}),x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>B("bookings"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active"}),x.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.activeBookings})]}),x.jsx(T,{className:"h-8 w-8 text-green-600"})]})})}),x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>B("bookings"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),x.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.completedBookings})]}),x.jsx(Q,{className:"h-8 w-8 text-blue-600"})]})})})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/book-artist"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x.jsx($,{className:"h-6 w-6 text-primary"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-semibold",children:"Book an Artist"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Find and book artists for your events"})]})]})})}),x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/events"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x.jsx(W,{className:"h-6 w-6 text-primary"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-semibold",children:"Browse Events"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover local events and activities"})]})]})})}),x.jsx(h,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/messages"),children:x.jsx(p,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x.jsx(M,{className:"h-6 w-6 text-primary"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-semibold",children:"Messages"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Chat with artists and organizers"})]})]})})})]}),x.jsxs(L,{value:_,onValueChange:B,className:"space-y-6",children:[x.jsxs(F,{children:[x.jsxs(I,{value:"bookings",children:["My Bookings",a.pendingBookings>0&&x.jsx(y,{variant:"destructive",className:"ml-2 h-5 w-5 rounded-full p-0 text-xs",children:a.pendingBookings})]}),x.jsx(I,{value:"profile",children:"Profile"}),x.jsx(I,{value:"settings",children:"Settings"})]}),x.jsx(R,{value:"bookings",children:x.jsx(Y,{})}),x.jsx(R,{value:"profile",children:x.jsxs(h,{children:[x.jsxs(j,{children:[x.jsx(u,{children:"Profile Information"}),x.jsx(g,{children:"Manage your profile and preferences"})]}),x.jsx(p,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Display Name"}),x.jsx("p",{className:"text-muted-foreground",children:(null==n?void 0:n.display_name)||"Not set"})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Email"}),x.jsx("p",{className:"text-muted-foreground",children:i.email})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium mb-2",children:"Bio"}),x.jsx("p",{className:"text-muted-foreground",children:(null==n?void 0:n.bio)||"No bio added yet"})]}),x.jsx(f,{onClick:()=>t("/profile"),children:"Edit Profile"})]})})]})}),x.jsx(R,{value:"settings",children:x.jsxs(h,{children:[x.jsxs(j,{children:[x.jsx(u,{children:"Account Settings"}),x.jsx(g,{children:"Manage your account preferences and security"})]}),x.jsx(p,{children:x.jsx("div",{className:"space-y-4",children:x.jsxs(f,{variant:"outline",onClick:()=>t("/settings"),children:[x.jsx(N,{className:"h-4 w-4 mr-2"}),"Account Settings"]})})})]})})]})]})}):(t("/signin"),null)};export{G as default};
