var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(s,t,i)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,c=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&r(e,t,s[t]);if(i)for(var t of i(s))n.call(s,t)&&r(e,t,s[t]);return e},l=(e,i)=>s(e,t(i)),o=(e,s,t)=>new Promise((i,a)=>{var n=e=>{try{c(t.next(e))}catch(s){a(s)}},r=e=>{try{c(t.throw(e))}catch(s){a(s)}},c=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,r);c((t=t.apply(e,s)).next())});import{c as d,r as m,u,d as h,s as x,R as React,j as f,C as j,v as p,w as g,S as v,x as y,y as N,B as _,X as w,k as b}from"./main-u5iDOJMZ.js";import{I as C}from"./input-d0wpgTJ2.js";import{T as k,a as S,b as E,c as P}from"./tabs-Dn7YRzvT.js";import{R as F}from"./ResponsiveLayout-CaFEj6Sr.js";import{L as A}from"./label-BmJUPftL.js";import{S as L}from"./switch-CjfEjYqx.js";import{S as O}from"./slider-uBq9sDOG.js";import{B as q}from"./badge-k0SsuPwB.js";import{S as D}from"./separator-BdZu64Yb.js";import{u as U}from"./useLocationManager-c3ILLQ3N.js";import{L as T}from"./loader-2-BaQ9JvXw.js";import{S as R}from"./save-CoFuto5w.js";import{T as z}from"./textarea-44C4KWaW.js";import{A as M,a as W,b as I}from"./sheet-BES5Q-Ko.js";import{U as B}from"./user-DlaYKRnl.js";import{C as J}from"./camera-C2IKr8go.js";import{P as G}from"./phone-DJVPC7BW.js";import{G as Y}from"./globe-Om9hcPSo.js";import{M as $}from"./mail-CkXFPHcI.js";import{M as H}from"./map-pin-CcmxiK6P.js";import{C as V}from"./index-B7-3ofi9.js";import{A as Z}from"./award-B-2oaJHg.js";import{B as Q}from"./bell-wBykza9e.js";import{M as K}from"./message-square-DQ5316cR.js";import{U as X}from"./users-BKDXsamp.js";import{M as ee}from"./message-circle-nfkvwkJk.js";import{M as se,T as te}from"./index-azXaBhbR.js";import{C as ie}from"./clock-k4Wuy6bB.js";import{S as ae,a as ne,b as re,c as ce,d as le}from"./select-BloqB5ko.js";import{S as oe}from"./shield-sCmGbvNz.js";import{U as de}from"./user-check-B1BXaw6U.js";import{E as me}from"./eye-rgHTj3H0.js";import{E as ue}from"./eye-off-DBLSYTPz.js";import{C as he}from"./check-circle-Unk97XuD.js";import{X as xe}from"./x-circle-Dz5LHxry.js";import{A as fe}from"./alert-triangle-lyQ4bE6N.js";import{A as je,a as pe,b as ge,c as ve,d as ye,e as Ne,f as _e,g as we,h as be}from"./alert-dialog-Djr-lEkQ.js";import{L as Ce}from"./log-out-CGc8M4_-.js";import"./index-Dy-VqNBB.js";import"./NotificationBell-4ukuyDx4.js";import"./Combination-D3NAapk3.js";import"./scroll-area-DANvZfFy.js";import"./index-jVOyRz7F.js";import"./useNotifications-DNCpc7NU.js";import"./check-CT-bNmTi.js";import"./NotificationButton-QcrDLMMB.js";import"./search-BsWmJlwB.js";import"./zap-BrBeKdrO.js";import"./alert-7nHfBPfv.js";import"./wifi-DNTf1l7S.js";import"./index-9dp5BQ5P.js";import"./locationService-DDZ4T3aM.js";import"./chevron-up-MfWNy2Yr.js";
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=d("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Se=d("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=new class{getUserSettings(e){return o(this,null,function*(){try{const[s,t]=yield Promise.all([x.from("profiles").select("*").eq("user_id",e).single(),x.from("user_notification_settings").select("*").eq("user_id",e).single()]),i=s.data||{},a=t.data||{};return{display_name:i.display_name,bio:i.bio,first_name:i.first_name,last_name:i.last_name,phone_number:i.phone_number,website_url:i.website_url,location_city:i.location_city,location_state:i.location_state,location_country:i.location_country,real_time_location_enabled:i.real_time_location_enabled,email_notifications:a.email_notifications,push_notifications:a.push_notifications,booking_notifications:a.booking_notifications,message_notifications:a.message_notifications,follower_notifications:a.follower_notifications,event_notifications:a.event_notifications,discussion_notifications:a.discussion_notifications,payment_notifications:a.payment_notifications,system_notifications:a.system_notifications,marketing_notifications:a.marketing_notifications,quiet_hours_enabled:a.quiet_hours_enabled,quiet_hours_start:a.quiet_hours_start,quiet_hours_end:a.quiet_hours_end,privacy_profile:!1,show_location:!0,show_contact_info:!0,allow_messages_from:"followers",dark_mode:!1,language:"en",timezone:"UTC",two_factor_enabled:!1,login_notifications:!0}}catch(s){throw new Error("Failed to fetch user settings")}})}updateProfileSettings(e,s){return o(this,null,function*(){try{const t={},i={};if(void 0!==s.display_name&&(t.display_name=s.display_name),void 0!==s.bio&&(t.bio=s.bio),void 0!==s.first_name&&(t.first_name=s.first_name),void 0!==s.last_name&&(t.last_name=s.last_name),void 0!==s.phone_number&&(t.phone_number=s.phone_number),void 0!==s.website_url&&(t.website_url=s.website_url),void 0!==s.location_city&&(t.location_city=s.location_city),void 0!==s.location_state&&(t.location_state=s.location_state),void 0!==s.location_country&&(t.location_country=s.location_country),void 0!==s.real_time_location_enabled&&(t.real_time_location_enabled=s.real_time_location_enabled),Object.keys(t).length>0){t.updated_at=(new Date).toISOString();const{error:s}=yield x.from("profiles").update(t).eq("user_id",e);if(s)throw s}if(Object.keys(i).length>0){i.updated_at=(new Date).toISOString();const{error:s}=yield x.from("user_notification_settings").upsert(c({user_id:e},i));if(s)throw s}return{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to update settings"}}})}updateNotificationSettings(e,s){return o(this,null,function*(){try{const t={};if(void 0!==s.email_notifications&&(t.email_notifications=s.email_notifications),void 0!==s.push_notifications&&(t.push_notifications=s.push_notifications),void 0!==s.booking_notifications&&(t.booking_notifications=s.booking_notifications),void 0!==s.message_notifications&&(t.message_notifications=s.message_notifications),void 0!==s.follower_notifications&&(t.follower_notifications=s.follower_notifications),void 0!==s.event_notifications&&(t.event_notifications=s.event_notifications),void 0!==s.discussion_notifications&&(t.discussion_notifications=s.discussion_notifications),void 0!==s.payment_notifications&&(t.payment_notifications=s.payment_notifications),void 0!==s.system_notifications&&(t.system_notifications=s.system_notifications),void 0!==s.marketing_notifications&&(t.marketing_notifications=s.marketing_notifications),void 0!==s.quiet_hours_enabled&&(t.quiet_hours_enabled=s.quiet_hours_enabled),void 0!==s.quiet_hours_start&&(t.quiet_hours_start=s.quiet_hours_start),void 0!==s.quiet_hours_end&&(t.quiet_hours_end=s.quiet_hours_end),0===Object.keys(t).length)return{success:!0};t.updated_at=(new Date).toISOString();const{error:i}=yield x.from("user_notification_settings").upsert(c({user_id:e},t));if(i)throw i;return{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to update notification settings"}}})}changePassword(e,s){return o(this,null,function*(){try{if(s.newPassword!==s.confirmPassword)return{success:!1,error:"New password and confirmation password do not match"};if(s.newPassword.length<8)return{success:!1,error:"Password must be at least 8 characters long"};const{error:e}=yield x.auth.updateUser({password:s.newPassword});if(e)throw e;return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to change password"}}})}changeEmail(e,s){return o(this,null,function*(){try{const{error:e}=yield x.auth.updateUser({email:s.newEmail});if(e)throw e;return{success:!0,data:{message:"Email change request sent. Please check your new email for confirmation."}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to change email"}}})}deleteAccount(e){return o(this,null,function*(){try{return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to delete account"}}})}getUserPreferences(e,s){return o(this,null,function*(){try{const t=yield this.getUserSettings(e),i={};return s.forEach(e=>{e in t&&(i[e]=t[e])}),i}catch(t){return{}}})}resetSettingsToDefaults(e){return o(this,null,function*(){try{const s={email_notifications:!0,push_notifications:!0,booking_notifications:!0,message_notifications:!0,follower_notifications:!0,event_notifications:!0,discussion_notifications:!0,payment_notifications:!0,system_notifications:!0,marketing_notifications:!1,quiet_hours_enabled:!1,quiet_hours_start:"22:00",quiet_hours_end:"08:00"},{error:t}=yield x.from("user_notification_settings").upsert(l(c({user_id:e},s),{updated_at:(new Date).toISOString()}));if(t)throw t;return{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to reset settings"}}})}},Pe=()=>{const{user:e}=u(),{toast:s}=h(),[t,i]=m.useState({}),[a,n]=m.useState(!0),[r,d]=m.useState(!1),[x,f]=m.useState(!1),j=m.useCallback(()=>o(void 0,null,function*(){if(null==e?void 0:e.id)try{n(!0);const s=yield Ee.getUserSettings(e.id);i(s)}catch(t){s({title:"Error",description:"Failed to load user settings",variant:"destructive"})}finally{n(!1)}else n(!1)}),[null==e?void 0:e.id,s]),p=m.useCallback(t=>o(void 0,null,function*(){if(!(null==e?void 0:e.id))return{success:!1,error:"User not authenticated"};try{d(!0);const a=yield Ee.updateProfileSettings(e.id,t);return a.success?(i(e=>c(c({},e),t)),f(!1),s({title:"Success",description:"Profile settings updated successfully"})):s({title:"Error",description:a.error||"Failed to update profile settings",variant:"destructive"}),a}catch(a){return s({title:"Error",description:"Failed to update profile settings",variant:"destructive"}),{success:!1,error:"Unknown error"}}finally{d(!1)}}),[null==e?void 0:e.id,s]),g=m.useCallback(t=>o(void 0,null,function*(){if(!(null==e?void 0:e.id))return{success:!1,error:"User not authenticated"};try{d(!0);const a=yield Ee.updateNotificationSettings(e.id,t);return a.success?(i(e=>c(c({},e),t)),f(!1),s({title:"Success",description:"Notification settings updated successfully"})):s({title:"Error",description:a.error||"Failed to update notification settings",variant:"destructive"}),a}catch(a){return s({title:"Error",description:"Failed to update notification settings",variant:"destructive"}),{success:!1,error:"Unknown error"}}finally{d(!1)}}),[null==e?void 0:e.id,s]),v=m.useCallback(t=>o(void 0,null,function*(){if(!(null==e?void 0:e.id))return{success:!1,error:"User not authenticated"};try{d(!0);const i=yield Ee.changePassword(e.id,t);return i.success?s({title:"Success",description:"Password changed successfully"}):s({title:"Error",description:i.error||"Failed to change password",variant:"destructive"}),i}catch(i){return s({title:"Error",description:"Failed to change password",variant:"destructive"}),{success:!1,error:"Unknown error"}}finally{d(!1)}}),[null==e?void 0:e.id,s]),y=m.useCallback(t=>o(void 0,null,function*(){var i;if(!(null==e?void 0:e.id))return{success:!1,error:"User not authenticated"};try{d(!0);const a=yield Ee.changeEmail(e.id,t);return a.success?s({title:"Success",description:(null==(i=a.data)?void 0:i.message)||"Email change request sent successfully"}):s({title:"Error",description:a.error||"Failed to change email",variant:"destructive"}),a}catch(a){return s({title:"Error",description:"Failed to change email",variant:"destructive"}),{success:!1,error:"Unknown error"}}finally{d(!1)}}),[null==e?void 0:e.id,s]),N=m.useCallback(()=>o(void 0,null,function*(){if(!(null==e?void 0:e.id))return{success:!1,error:"User not authenticated"};try{d(!0);const t=yield Ee.resetSettingsToDefaults(e.id);return t.success?(yield j(),f(!1),s({title:"Success",description:"Settings reset to defaults successfully"})):s({title:"Error",description:t.error||"Failed to reset settings",variant:"destructive"}),t}catch(t){return s({title:"Error",description:"Failed to reset settings",variant:"destructive"}),{success:!1,error:"Unknown error"}}finally{d(!1)}}),[null==e?void 0:e.id,s,j]),_=m.useCallback((e,s)=>{i(t=>l(c({},t),{[e]:s})),f(!0)},[]),w=m.useCallback(()=>o(void 0,null,function*(){if(!(null==e?void 0:e.id)||!x)return!0;try{d(!0);const i={},a={};Object.entries(t).forEach(([e,s])=>{e.startsWith("email_")||e.startsWith("push_")||e.startsWith("booking_")||e.startsWith("message_")||e.startsWith("follower_")||e.startsWith("event_")||e.startsWith("discussion_")||e.startsWith("payment_")||e.startsWith("system_")||e.startsWith("marketing_")||e.startsWith("quiet_hours_")?a[e]=s:i[e]=s});const[n,r]=yield Promise.all([Object.keys(i).length>0?Ee.updateProfileSettings(e.id,i):{success:!0},Object.keys(a).length>0?Ee.updateNotificationSettings(e.id,a):{success:!0}]);if(n.success&&r.success)return f(!1),s({title:"Success",description:"All settings saved successfully"}),!0;{const e=n.error||r.error||"Failed to save some settings";return s({title:"Error",description:e,variant:"destructive"}),!1}}catch(i){return s({title:"Error",description:"Failed to save settings",variant:"destructive"}),!1}finally{d(!1)}}),[null==e?void 0:e.id,t,x,s]);return m.useEffect(()=>{j()},[j]),{settings:t,loading:a,saving:r,hasChanges:x,loadSettings:j,updateProfileSettings:p,updateNotificationSettings:g,changePassword:v,changeEmail:y,resetSettingsToDefaults:N,handleSettingChange:_,saveAllChanges:w,setSettings:i}},Fe=[{id:"events",label:"Events & Activities",description:"Local events, concerts, workshops"},{id:"news",label:"Local News",description:"Community news and updates"},{id:"artists",label:"Artists & Services",description:"Local artists and service providers"},{id:"reviews",label:"Reviews & Recommendations",description:"Local business reviews"},{id:"discussions",label:"Community Discussions",description:"Local community posts and polls"},{id:"businesses",label:"Local Businesses",description:"Restaurants, shops, and services"}];function Ae({className:e=""}){const{settings:s,updateSettings:t,loading:i,error:a}=U(),[n,r]=m.useState(s),[d,u]=m.useState(!1);React.useEffect(()=>{r(s)},[s]);const h=JSON.stringify(n)!==JSON.stringify(s);return f.jsxs(j,{className:e,children:[f.jsxs(p,{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(v,{className:"h-5 w-5"}),"Location Preferences"]}),f.jsx(y,{children:"Customize your location-based experience and content preferences"})]}),f.jsxs(N,{className:"space-y-6",children:[f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{className:"text-base font-medium",children:"Location Services"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable location-based content personalization"})]}),f.jsx(L,{checked:n.enabled,onCheckedChange:e=>r(s=>l(c({},s),{enabled:e})),disabled:i})]})}),n.enabled&&f.jsxs(f.Fragment,{children:[f.jsx(D,{}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{className:"text-base font-medium",children:"Auto-Detect Location"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically update your location when you move"})]}),f.jsx(L,{checked:n.auto_detect,onCheckedChange:e=>r(s=>l(c({},s),{auto_detect:e})),disabled:i})]})}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{className:"text-base font-medium",children:"Search Radius"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Show content within ",n.radius_km,"km of your location"]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx(O,{value:[n.radius_km],onValueChange:e=>{r(s=>l(c({},s),{radius_km:e[0]}))},max:100,min:5,step:5,className:"w-full"}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"5km"}),f.jsx("span",{children:"50km"}),f.jsx("span",{children:"100km"})]})]})]}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{className:"text-base font-medium",children:"Content Categories"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose which types of content to show based on your location"})]}),f.jsx("div",{className:"grid gap-3",children:Fe.map(e=>f.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx("div",{className:"flex items-center gap-3",children:f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(A,{className:"font-medium cursor-pointer",children:e.label}),n.categories.includes(e.id)&&f.jsx(q,{variant:"secondary",className:"text-xs",children:"Active"})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})}),f.jsx(L,{checked:n.categories.includes(e.id),onCheckedChange:()=>(e=>{r(s=>l(c({},s),{categories:s.categories.includes(e)?s.categories.filter(s=>s!==e):[...s.categories,e]}))})(e.id),disabled:i})]},e.id))})]}),f.jsx(D,{}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{className:"text-base font-medium",children:"Location Notifications"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified about new content in your area"})]}),f.jsx(L,{checked:n.notifications,onCheckedChange:e=>r(s=>l(c({},s),{notifications:e})),disabled:i})]})})]}),a&&f.jsx("div",{className:"p-3 border border-destructive/20 bg-destructive/5 rounded-lg",children:f.jsx("p",{className:"text-sm text-destructive",children:a})}),h&&f.jsx("div",{className:"flex justify-end",children:f.jsx(_,{onClick:()=>o(this,null,function*(){u(!0);try{yield t(n)}catch(e){}finally{u(!1)}}),disabled:d||i,className:"flex items-center gap-2",children:d?f.jsxs(f.Fragment,{children:[f.jsx(T,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(R,{className:"h-4 w-4"}),"Save Changes"]})})}),f.jsxs("div",{className:"text-xs text-muted-foreground bg-gray-50 p-3 rounded-lg",children:[f.jsx("p",{className:"font-medium mb-1",children:"Privacy & Data Usage"}),f.jsxs("ul",{className:"space-y-1",children:[f.jsx("li",{children:"• Your location is only used to personalize content"}),f.jsx("li",{children:"• Location data is stored securely and not shared with third parties"}),f.jsx("li",{children:"• You can disable location services at any time"}),f.jsx("li",{children:"• Location data is automatically updated when you move (if auto-detect is enabled)"})]})]})]})]})}const Le=({onClose:e,showAvatar:s=!0,compact:t=!1})=>{var i,a;const{toast:n}=h(),{settings:r,saving:d,updateProfileSettings:u}=Pe(),[x,v]=m.useState(r),[b,k]=m.useState(!1),[S,E]=m.useState(null),[P,F]=m.useState(null);m.useEffect(()=>{v(r)},[r]),m.useEffect(()=>{const e=JSON.stringify(x)!==JSON.stringify(r);k(e)},[x,r]);const L=(e,s)=>{v(t=>l(c({},t),{[e]:s}))};return f.jsxs(j,{className:t?"":"w-full max-w-4xl",children:[f.jsx(p,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(B,{className:"h-5 w-5"}),"Profile Settings"]}),f.jsx(y,{children:"Update your personal information and profile details."})]}),e&&f.jsx(_,{variant:"ghost",size:"sm",onClick:e,children:f.jsx(w,{className:"h-4 w-4"})})]})}),f.jsxs(N,{className:"space-y-6",children:[s&&f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"relative",children:[f.jsxs(M,{className:"h-20 w-20",children:[f.jsx(W,{src:P||r.avatar_url||void 0,alt:"Profile avatar"}),f.jsx(I,{className:"text-lg",children:(null==(i=r.display_name)?void 0:i.charAt(0))||(null==(a=r.first_name)?void 0:a.charAt(0))||"U"})]}),f.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary text-primary-foreground rounded-full p-1 cursor-pointer hover:bg-primary/90",children:[f.jsx(J,{className:"h-3 w-3"}),f.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];if(t){E(t);const e=new FileReader;e.onload=e=>{var s;F(null==(s=e.target)?void 0:s.result)},e.readAsDataURL(t)}},className:"hidden"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-sm font-medium",children:"Profile Photo"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload a new profile photo. Recommended size: 400x400 pixels."})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Basic Information"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"first_name",children:"First Name *"}),f.jsx(C,{id:"first_name",value:x.first_name||"",onChange:e=>L("first_name",e.target.value),placeholder:"Enter your first name"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"last_name",children:"Last Name *"}),f.jsx(C,{id:"last_name",value:x.last_name||"",onChange:e=>L("last_name",e.target.value),placeholder:"Enter your last name"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"display_name",children:"Display Name"}),f.jsx(C,{id:"display_name",value:x.display_name||"",onChange:e=>L("display_name",e.target.value),placeholder:"Enter your display name"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"This is the name that will be shown to other users."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"bio",children:"Bio"}),f.jsx(z,{id:"bio",value:x.bio||"",onChange:e=>L("bio",e.target.value),placeholder:"Tell us about yourself, your interests, and what you do...",rows:4}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Share a bit about yourself with the community."})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Contact Information"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"phone_number",children:"Phone Number"}),f.jsxs("div",{className:"relative",children:[f.jsx(G,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),f.jsx(C,{id:"phone_number",value:x.phone_number||"",onChange:e=>L("phone_number",e.target.value),placeholder:"Enter your phone number",className:"pl-10"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"website_url",children:"Website"}),f.jsxs("div",{className:"relative",children:[f.jsx(Y,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),f.jsx(C,{id:"website_url",value:x.website_url||"",onChange:e=>L("website_url",e.target.value),placeholder:"https://yourwebsite.com",className:"pl-10"})]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"email",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx($,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),f.jsx(C,{id:"email",type:"email",value:x.email||"",disabled:!0,className:"pl-10"})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Email address cannot be changed here. Go to Settings → Security to change your email."})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Location"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"location_city",children:"City"}),f.jsxs("div",{className:"relative",children:[f.jsx(H,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),f.jsx(C,{id:"location_city",value:x.location_city||"",onChange:e=>L("location_city",e.target.value),placeholder:"Enter your city",className:"pl-10"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"location_state",children:"State/Province"}),f.jsx(C,{id:"location_state",value:x.location_state||"",onChange:e=>L("location_state",e.target.value),placeholder:"Enter your state"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"location_country",children:"Country"}),f.jsx(C,{id:"location_country",value:x.location_country||"",onChange:e=>L("location_country",e.target.value),placeholder:"Enter your country"})]})]})]}),"artist"===r.user_type&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Professional Information"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"experience_years",children:"Years of Experience"}),f.jsxs("div",{className:"relative",children:[f.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),f.jsx(C,{id:"experience_years",type:"number",min:"0",value:x.experience_years||"",onChange:e=>L("experience_years",parseInt(e.target.value)||0),placeholder:"0",className:"pl-10"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"education",children:"Education"}),f.jsxs("div",{className:"relative",children:[f.jsx(Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),f.jsx(C,{id:"education",value:x.education||"",onChange:e=>L("education",e.target.value),placeholder:"e.g., Bachelor's in Fine Arts",className:"pl-10"})]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"artist_skills",children:"Skills & Specialties"}),f.jsx(z,{id:"artist_skills",value:Array.isArray(x.artist_skills)?x.artist_skills.join(", "):"",onChange:e=>L("artist_skills",e.target.value.split(",").map(e=>e.trim()).filter(Boolean)),placeholder:"Enter your skills and specialties, separated by commas",rows:3})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"hourly_rate_min",children:"Minimum Hourly Rate ($)"}),f.jsx(C,{id:"hourly_rate_min",type:"number",min:"0",step:"0.01",value:x.hourly_rate_min||"",onChange:e=>L("hourly_rate_min",parseFloat(e.target.value)||0),placeholder:"0.00"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"hourly_rate_max",children:"Maximum Hourly Rate ($)"}),f.jsx(C,{id:"hourly_rate_max",type:"number",min:"0",step:"0.01",value:x.hourly_rate_max||"",onChange:e=>L("hourly_rate_max",parseFloat(e.target.value)||0),placeholder:"0.00"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"portfolio_urls",children:"Portfolio URLs"}),f.jsx(z,{id:"portfolio_urls",value:Array.isArray(x.portfolio_urls)?x.portfolio_urls.join("\n"):"",onChange:e=>L("portfolio_urls",e.target.value.split("\n").map(e=>e.trim()).filter(Boolean)),placeholder:"Enter your portfolio URLs, one per line",rows:3})]})]}),f.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[e&&f.jsx(_,{variant:"outline",onClick:()=>{v(r),E(null),F(null),e&&e()},children:"Cancel"}),f.jsxs(_,{onClick:()=>o(void 0,null,function*(){try{(yield u(x)).success&&(n({title:"Success",description:"Profile updated successfully"}),e&&e())}catch(s){n({title:"Error",description:"Failed to update profile",variant:"destructive"})}}),disabled:!b||d,className:"flex items-center gap-2",children:[f.jsx(R,{className:"h-4 w-4"}),d?"Saving...":"Save Changes"]})]})]})]})},Oe=({onClose:e,compact:s=!1})=>{const{toast:t}=h(),{settings:i,saving:a,updateNotificationSettings:n}=Pe(),[r,d]=m.useState(i),[u,x]=m.useState(!1);m.useEffect(()=>{d(i)},[i]),m.useEffect(()=>{const e=JSON.stringify(r)!==JSON.stringify(i);x(e)},[r,i]);const k=(e,s)=>{d(t=>l(c({},t),{[e]:s}))};return f.jsxs(j,{className:s?"":"w-full",children:[f.jsx(p,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(Q,{className:"h-5 w-5"}),"Notification Preferences"]}),f.jsx(y,{children:"Choose what notifications you want to receive and when."})]}),e&&f.jsx(_,{variant:"ghost",size:"sm",onClick:e,children:f.jsx(w,{className:"h-4 w-4"})})]})}),f.jsxs(N,{className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(v,{className:"h-4 w-4"}),"General Notifications"]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Email Notifications"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive updates and announcements via email."})]}),f.jsx(L,{checked:!1!==r.email_notifications,onCheckedChange:e=>k("email_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Push Notifications"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified about new messages and activity."})]}),f.jsx(L,{checked:!1!==r.push_notifications,onCheckedChange:e=>k("push_notifications",e)})]})]}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(Q,{className:"h-4 w-4"}),"Specific Notifications"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(V,{className:"h-3 w-3"}),"Booking Updates"]})}),f.jsx(L,{checked:!1!==r.booking_notifications,onCheckedChange:e=>k("booking_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(K,{className:"h-3 w-3"}),"New Messages"]})}),f.jsx(L,{checked:!1!==r.message_notifications,onCheckedChange:e=>k("message_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(X,{className:"h-3 w-3"}),"New Followers"]})}),f.jsx(L,{checked:!1!==r.follower_notifications,onCheckedChange:e=>k("follower_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(V,{className:"h-3 w-3"}),"Event Updates"]})}),f.jsx(L,{checked:!1!==r.event_notifications,onCheckedChange:e=>k("event_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(ee,{className:"h-3 w-3"}),"Discussion Activity"]})}),f.jsx(L,{checked:!1!==r.discussion_notifications,onCheckedChange:e=>k("discussion_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(ke,{className:"h-3 w-3"}),"Payment Updates"]})}),f.jsx(L,{checked:!1!==r.payment_notifications,onCheckedChange:e=>k("payment_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(v,{className:"h-3 w-3"}),"System Messages"]})}),f.jsx(L,{checked:!1!==r.system_notifications,onCheckedChange:e=>k("system_notifications",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"space-y-0.5",children:f.jsxs(A,{className:"text-sm flex items-center gap-2",children:[f.jsx(se,{className:"h-3 w-3"}),"Marketing"]})}),f.jsx(L,{checked:r.marketing_notifications||!1,onCheckedChange:e=>k("marketing_notifications",e)})]})]})]}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(ie,{className:"h-4 w-4"}),"Quiet Hours"]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Enable Quiet Hours"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Pause notifications during specific hours."})]}),f.jsx(L,{checked:r.quiet_hours_enabled||!1,onCheckedChange:e=>k("quiet_hours_enabled",e)})]}),r.quiet_hours_enabled&&f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{children:"Start Time"}),f.jsx(C,{type:"time",value:r.quiet_hours_start||"22:00",onChange:e=>k("quiet_hours_start",e.target.value)})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{children:"End Time"}),f.jsx(C,{type:"time",value:r.quiet_hours_end||"08:00",onChange:e=>k("quiet_hours_end",e.target.value)})]})]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[f.jsx("div",{className:"flex items-center gap-3",children:f.jsxs(_,{variant:"outline",onClick:()=>{const e={email_notifications:!0,push_notifications:!0,booking_notifications:!0,message_notifications:!0,follower_notifications:!0,event_notifications:!0,discussion_notifications:!0,payment_notifications:!0,system_notifications:!0,marketing_notifications:!1,quiet_hours_enabled:!1,quiet_hours_start:"22:00",quiet_hours_end:"08:00"};d(s=>c(c({},s),e))},disabled:a,className:"flex items-center gap-2",children:[f.jsx(b,{className:"h-4 w-4"}),"Reset to Defaults"]})}),f.jsxs("div",{className:"flex items-center gap-3",children:[e&&f.jsx(_,{variant:"outline",onClick:()=>{d(i),e&&e()},children:"Cancel"}),f.jsxs(_,{onClick:()=>o(void 0,null,function*(){try{(yield n(r)).success&&(t({title:"Success",description:"Notification settings updated successfully"}),e&&e())}catch(s){t({title:"Error",description:"Failed to update notification settings",variant:"destructive"})}}),disabled:!u||a,className:"flex items-center gap-2",children:[f.jsx(R,{className:"h-4 w-4"}),a?"Saving...":"Save Changes"]})]})]})]})]})},qe=({onClose:e,compact:s=!1})=>{const{toast:t}=h(),{settings:i,saving:a,updateProfileSettings:n}=Pe(),[r,d]=m.useState(i),[u,x]=m.useState(!1);m.useEffect(()=>{d(i)},[i]),m.useEffect(()=>{const e=JSON.stringify(r)!==JSON.stringify(i);x(e)},[r,i]);const v=(e,s)=>{d(t=>l(c({},t),{[e]:s}))};return f.jsxs(j,{className:s?"":"w-full",children:[f.jsx(p,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(oe,{className:"h-5 w-5"}),"Privacy Controls"]}),f.jsx(y,{children:"Manage your privacy and data sharing preferences."})]}),e&&f.jsx(_,{variant:"ghost",size:"sm",onClick:e,children:f.jsx(w,{className:"h-4 w-4"})})]})}),f.jsxs(N,{className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(de,{className:"h-4 w-4"}),"Profile Privacy"]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Private Profile"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Make your profile visible only to approved followers."})]}),f.jsx(L,{checked:r.privacy_profile||!1,onCheckedChange:e=>v("privacy_profile",e)})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{children:"Who can send you messages"}),f.jsxs(ae,{value:r.allow_messages_from||"followers",onValueChange:e=>v("allow_messages_from",e),children:[f.jsx(ne,{children:f.jsx(re,{})}),f.jsxs(ce,{children:[f.jsx(le,{value:"all",children:"Everyone"}),f.jsx(le,{value:"followers",children:"Followers Only"}),f.jsx(le,{value:"none",children:"No One"})]})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Control who can send you direct messages."})]})]}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(me,{className:"h-4 w-4"}),"Information Visibility"]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Show Location"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow others to see your general location."})]}),f.jsx(L,{checked:!1!==r.show_location,onCheckedChange:e=>v("show_location",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Show Contact Info"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow others to see your contact information."})]}),f.jsx(L,{checked:!1!==r.show_contact_info,onCheckedChange:e=>v("show_contact_info",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Show Phone Number"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Display your phone number on your profile."})]}),f.jsx(L,{checked:!1!==r.show_phone_number,onCheckedChange:e=>v("show_phone_number",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Show Website"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Display your website URL on your profile."})]}),f.jsx(L,{checked:!1!==r.show_website,onCheckedChange:e=>v("show_website",e)})]})]}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(Y,{className:"h-4 w-4"}),"Data Sharing"]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Analytics & Improvement"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Help improve the app by sharing anonymous usage data."})]}),f.jsx(L,{checked:!1!==r.analytics_enabled,onCheckedChange:e=>v("analytics_enabled",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Personalized Recommendations"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow the app to provide personalized content and suggestions."})]}),f.jsx(L,{checked:!1!==r.personalization_enabled,onCheckedChange:e=>v("personalization_enabled",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Social Features"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable social features like following, sharing, and community interactions."})]}),f.jsx(L,{checked:!1!==r.social_features_enabled,onCheckedChange:e=>v("social_features_enabled",e)})]})]}),f.jsx(D,{}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[f.jsx(de,{className:"h-4 w-4"}),"Search & Discovery"]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Appear in Search Results"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow others to find you through search."})]}),f.jsx(L,{checked:!1!==r.searchable,onCheckedChange:e=>v("searchable",e)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Show in Recommendations"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow the app to suggest your profile to others."})]}),f.jsx(L,{checked:!1!==r.recommendable,onCheckedChange:e=>v("recommendable",e)})]})]}),f.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[e&&f.jsx(_,{variant:"outline",onClick:()=>{d(i),e&&e()},children:"Cancel"}),f.jsxs(_,{onClick:()=>o(void 0,null,function*(){try{(yield n(r)).success&&(t({title:"Success",description:"Privacy settings updated successfully"}),e&&e())}catch(s){t({title:"Error",description:"Failed to update privacy settings",variant:"destructive"})}}),disabled:!u||a,className:"flex items-center gap-2",children:[f.jsx(R,{className:"h-4 w-4"}),a?"Saving...":"Save Changes"]})]})]})]})},De=({onClose:e,compact:s=!1})=>{const{toast:t}=h(),{settings:i,saving:a,changePassword:n,updateProfileSettings:r}=Pe(),[d,u]=m.useState(i),[x,v]=m.useState(!1),[w,b]=m.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[k,S]=m.useState(!1),[E,P]=m.useState({score:0,feedback:"",color:"text-gray-400"});m.useEffect(()=>{u(i)},[i]),m.useEffect(()=>{const e=JSON.stringify(d)!==JSON.stringify(i);v(e)},[d,i]);const F=(e,s)=>{u(t=>l(c({},t),{[e]:s}))};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs(j,{children:[f.jsxs(p,{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(Se,{className:"h-5 w-5"}),"Change Password"]}),f.jsx(y,{children:"Update your account password for enhanced security."})]}),f.jsxs(N,{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"currentPassword",children:"Current Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(C,{id:"currentPassword",type:k?"text":"password",value:w.currentPassword,onChange:e=>b(s=>l(c({},s),{currentPassword:e.target.value})),placeholder:"Enter current password"}),f.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>S(!k),children:k?f.jsx(ue,{className:"h-4 w-4"}):f.jsx(me,{className:"h-4 w-4"})})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"newPassword",children:"New Password"}),f.jsx("div",{className:"relative",children:f.jsx(C,{id:"newPassword",type:k?"text":"password",value:w.newPassword,onChange:e=>{b(s=>l(c({},s),{newPassword:e.target.value})),(e=>{let s=0,t="";e.length>=8&&s++,e.length>=12&&s++,/[a-z]/.test(e)&&s++,/[A-Z]/.test(e)&&s++,/[0-9]/.test(e)&&s++,/[^A-Za-z0-9]/.test(e)&&s++,s<=2?(t="Weak",P({score:s,feedback:t,color:"text-red-500"})):s<=4?(t="Fair",P({score:s,feedback:t,color:"text-yellow-500"})):s<=5?(t="Good",P({score:s,feedback:t,color:"text-blue-500"})):(t="Strong",P({score:s,feedback:t,color:"text-green-500"}))})(e.target.value)},placeholder:"Enter new password"})}),w.newPassword&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`text-sm ${E.color}`,children:E.feedback}),f.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>f.jsx("div",{className:`h-2 w-8 rounded ${e<=E.score?E.color.replace("text-","bg-"):"bg-gray-200"}`},e))})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Password must be at least 8 characters long."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(A,{htmlFor:"confirmPassword",children:"Confirm New Password"}),f.jsx("div",{className:"relative",children:f.jsx(C,{id:"confirmPassword",type:k?"text":"password",value:w.confirmPassword,onChange:e=>b(s=>l(c({},s),{confirmPassword:e.target.value})),placeholder:"Confirm new password"})}),w.confirmPassword&&f.jsxs("div",{className:"flex items-center gap-2",children:[w.newPassword===w.confirmPassword?f.jsx(he,{className:"h-4 w-4 text-green-500"}):f.jsx(xe,{className:"h-4 w-4 text-red-500"}),f.jsx("span",{className:"text-sm "+(w.newPassword===w.confirmPassword?"text-green-600":"text-red-600"),children:w.newPassword===w.confirmPassword?"Passwords match":"Passwords do not match"})]})]}),f.jsx(_,{onClick:()=>o(void 0,null,function*(){if(w.newPassword!==w.confirmPassword)return void t({title:"Error",description:"New password and confirmation password do not match.",variant:"destructive"});if(w.newPassword.length<8)return void t({title:"Error",description:"Password must be at least 8 characters long.",variant:"destructive"});(yield n(w)).success&&(b({currentPassword:"",newPassword:"",confirmPassword:""}),t({title:"Success",description:"Password changed successfully"}))}),disabled:!w.currentPassword||!w.newPassword||!w.confirmPassword||a,className:"w-full",children:"Update Password"})]})]}),f.jsxs(j,{children:[f.jsxs(p,{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(oe,{className:"h-5 w-5"}),"Security Features"]}),f.jsx(y,{children:"Additional security features for your account."})]}),f.jsxs(N,{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Two-Factor Authentication"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add an extra layer of security to your account."})]}),f.jsx(L,{checked:d.two_factor_enabled||!1,onCheckedChange:e=>F("two_factor_enabled",e)})]}),f.jsx(D,{}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Login Notifications"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when someone logs into your account."})]}),f.jsx(L,{checked:!1!==d.login_notifications,onCheckedChange:e=>F("login_notifications",e)})]}),f.jsx(D,{}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Session Management"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow you to manage active sessions across devices."})]}),f.jsx(L,{checked:!1!==d.session_management_enabled,onCheckedChange:e=>F("session_management_enabled",e)})]}),f.jsx(D,{}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Account Recovery"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable account recovery options for lost access."})]}),f.jsx(L,{checked:!1!==d.account_recovery_enabled,onCheckedChange:e=>F("account_recovery_enabled",e)})]})]})]}),f.jsxs(j,{children:[f.jsxs(p,{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx(fe,{className:"h-5 w-5"}),"Security Alerts"]}),f.jsx(y,{children:"Configure security alerts and notifications."})]}),f.jsxs(N,{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Suspicious Activity Alerts"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified about unusual account activity."})]}),f.jsx(L,{checked:!1!==d.suspicious_activity_alerts,onCheckedChange:e=>F("suspicious_activity_alerts",e)})]}),f.jsx(D,{}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"Password Change Alerts"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications when your password is changed."})]}),f.jsx(L,{checked:!1!==d.password_change_alerts,onCheckedChange:e=>F("password_change_alerts",e)})]}),f.jsx(D,{}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(A,{children:"New Device Alerts"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when your account is accessed from a new device."})]}),f.jsx(L,{checked:!1!==d.new_device_alerts,onCheckedChange:e=>F("new_device_alerts",e)})]})]})]}),f.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[e&&f.jsx(_,{variant:"outline",onClick:()=>{u(i),b({currentPassword:"",newPassword:"",confirmPassword:""}),e&&e()},children:"Cancel"}),f.jsxs(_,{onClick:()=>o(void 0,null,function*(){try{(yield r(d)).success&&(t({title:"Success",description:"Security settings updated successfully"}),e&&e())}catch(s){t({title:"Error",description:"Failed to update security settings",variant:"destructive"})}}),disabled:!x||a,className:"flex items-center gap-2",children:[f.jsx(R,{className:"h-4 w-4"}),a?"Saving...":"Save Changes"]})]})]})},Ue=()=>{const{user:e,signOut:s}=u(),{toast:t}=h(),{deleteAccount:i,testEdgeFunction:a,isDeleting:n}=(()=>{const[e,s]=m.useState(!1),{signOut:t}=u(),{toast:i}=h();return{deleteAccount:()=>o(void 0,null,function*(){try{s(!0);const{data:e,error:a}=yield x.functions.invoke("delete-user-account",{method:"POST",headers:{"Content-Type":"application/json"}});if(a)throw a;return i({title:"Account Deleted",description:"Your account has been permanently deleted."}),yield t(),{success:!0}}catch(e){let s="Failed to delete account. Please try again.",t="";if(e instanceof Error&&e.message)s=e.message,t=e.message;else if("object"==typeof e&&null!==e&&"error"in e){const i=e;s=i.error,t=i.error}if("object"==typeof e&&null!==e&&"details"in e){const s=e;t+=` | Details: ${JSON.stringify(s.details)}`}return i({title:"Error",description:s,variant:"destructive"}),{success:!1,error:s}}finally{s(!1)}}),testEdgeFunction:()=>o(void 0,null,function*(){try{const{data:e,error:s}=yield x.functions.invoke("delete-user-account",{method:"GET"});i(s?{title:"Function Test Failed",description:`Error: ${s.message}`,variant:"destructive"}:{title:"Function Test Successful",description:"Edge function is accessible"})}catch(e){i({title:"Test Error",description:e instanceof Error?e.message:"Unknown error occurred",variant:"destructive"})}}),isDeleting:e}})(),{loading:r,saving:d,hasChanges:w,saveAllChanges:A,changeEmail:L,resetSettingsToDefaults:O}=Pe(),[q,D]=m.useState(""),[U,T]=m.useState({newEmail:"",currentPassword:""});return r?f.jsx(F,{children:f.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):f.jsx(F,{children:f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(v,{className:"h-6 w-6 text-primary"}),f.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),f.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings and preferences."}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs(_,{onClick:()=>o(void 0,null,function*(){(yield A())&&t({title:"Success",description:"All settings have been saved successfully."})}),disabled:!w||d,className:"flex items-center gap-2",children:[f.jsx(R,{className:"h-4 w-4"}),d?"Saving...":"Save All Changes"]}),f.jsxs(_,{variant:"outline",onClick:()=>o(void 0,null,function*(){(yield O()).success&&t({title:"Success",description:"Settings have been reset to defaults."})}),disabled:d,className:"flex items-center gap-2",children:[f.jsx(b,{className:"h-4 w-4"}),"Reset to Defaults"]}),w&&f.jsx("span",{className:"text-sm text-amber-600 font-medium",children:"You have unsaved changes"})]})]}),f.jsxs(k,{defaultValue:"account",className:"space-y-6",children:[f.jsxs(S,{className:"grid w-full grid-cols-5",children:[f.jsx(E,{value:"account",children:"Account"}),f.jsx(E,{value:"location",children:"Location"}),f.jsx(E,{value:"privacy",children:"Privacy"}),f.jsx(E,{value:"notifications",children:"Notifications"}),f.jsx(E,{value:"security",children:"Security"})]}),f.jsxs(P,{value:"account",className:"space-y-6",children:[f.jsx(Le,{showAvatar:!0,compact:!1}),f.jsxs(j,{children:[f.jsxs(p,{children:[f.jsxs(g,{className:"flex items-center gap-2",children:[f.jsx($,{className:"h-5 w-5"}),"Email Settings"]}),f.jsx(y,{children:"Change your email address or manage email preferences."})]}),f.jsxs(N,{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Label,{htmlFor:"currentEmail",children:"Current Email"}),f.jsx(C,{id:"currentEmail",type:"email",value:(null==e?void 0:e.email)||"",disabled:!0}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Your current email address."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Label,{htmlFor:"newEmail",children:"New Email Address"}),f.jsx(C,{id:"newEmail",type:"email",value:U.newEmail,onChange:e=>T(s=>l(c({},s),{newEmail:e.target.value})),placeholder:"Enter new email address"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Label,{htmlFor:"emailPassword",children:"Current Password"}),f.jsx(C,{id:"emailPassword",type:"password",value:U.currentPassword,onChange:e=>T(s=>l(c({},s),{currentPassword:e.target.value})),placeholder:"Enter your current password"})]}),f.jsx(_,{onClick:()=>o(void 0,null,function*(){if(!U.newEmail||!U.currentPassword)return void t({title:"Error",description:"Please fill in all fields.",variant:"destructive"});(yield L(U)).success&&T({newEmail:"",currentPassword:""})}),disabled:!U.newEmail||!U.currentPassword||d,className:"w-full",children:"Change Email Address"})]})]})]}),f.jsx(P,{value:"location",className:"space-y-6",children:f.jsx(Ae,{})}),f.jsx(P,{value:"privacy",className:"space-y-6",children:f.jsx(qe,{})}),f.jsx(P,{value:"notifications",className:"space-y-6",children:f.jsx(Oe,{})}),f.jsxs(P,{value:"security",className:"space-y-6",children:[f.jsx(De,{}),f.jsxs(j,{children:[f.jsxs(p,{children:[f.jsx(g,{className:"text-destructive",children:"Danger Zone"}),f.jsx(y,{children:"Irreversible and destructive actions."})]}),f.jsxs(N,{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border border-destructive/20 rounded-lg",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Label,{children:"Sign Out"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Sign out of your account on this device."})]}),f.jsxs(_,{variant:"outline",onClick:()=>o(void 0,null,function*(){try{yield s(),t({title:"Signed Out",description:"You have been signed out successfully."})}catch(e){t({title:"Error",description:"Failed to sign out.",variant:"destructive"})}}),children:[f.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border border-destructive/20 rounded-lg",children:[f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Label,{className:"text-destructive",children:"Delete Account"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Permanently delete your account and all associated data."})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(_,{variant:"outline",onClick:a,className:"text-xs",children:"Test Function"}),f.jsxs(je,{children:[f.jsx(pe,{asChild:!0,children:f.jsxs(_,{variant:"destructive",children:[f.jsx(te,{className:"h-4 w-4 mr-2"}),"Delete Account"]})}),f.jsxs(ge,{children:[f.jsxs(ve,{children:[f.jsxs(ye,{className:"flex items-center gap-2",children:[f.jsx(fe,{className:"h-5 w-5 text-destructive"}),"Delete Account"]}),f.jsx(Ne,{children:"This action cannot be undone. This will permanently delete your account and remove all your data from our servers including:"})]}),f.jsx("div",{className:"space-y-2 text-sm text-muted-foreground",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Your profile and personal information"}),f.jsx("li",{children:"All your posts and comments"}),f.jsx("li",{children:"Chat conversations and messages"}),f.jsx("li",{children:"Event bookings and artist profiles"}),f.jsx("li",{children:"Follow relationships and notifications"}),f.jsx("li",{children:"All other account data"})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Label,{htmlFor:"deleteConfirmation",className:"text-sm font-medium",children:'Type "DELETE" to confirm'}),f.jsx(C,{id:"deleteConfirmation",value:q,onChange:e=>D(e.target.value),placeholder:"DELETE",className:"border-destructive/50 focus:border-destructive"})]}),f.jsxs(_e,{children:[f.jsx(we,{onClick:()=>D(""),children:"Cancel"}),f.jsx(be,{onClick:()=>o(void 0,null,function*(){if("DELETE"!==q)return void t({title:"Invalid Confirmation",description:"Please type 'DELETE' to confirm account deletion.",variant:"destructive"});(yield i()).success&&D("")}),disabled:"DELETE"!==q||n,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:n?"Deleting...":"Delete Account"})]})]})]})]})]})]})]})]})]})]})})};export{Ue as default};
