import{M as J,f as K,u as Q,g as X,r,j as e,B as a,C as n,p as c,q as d,v as l}from"./main-jfCIwKxb.js";import{R as N,S as Z,A as ee,b as se,c as ae}from"./ResponsiveLayout-Dd-U-XTf.js";import{B as w}from"./badge-Cxniq3nT.js";import{S as te}from"./separator-CQeeh5sy.js";import{D as _,a as E,b as M,c as T,d as S}from"./dialog-Db9VuKsi.js";import{T as ie}from"./textarea-Dm2RgXBl.js";import{L as z}from"./label-BhjyL16S.js";import{u as re}from"./useEvents-CAnjBAj3.js";import{A}from"./arrow-left-BUiGB43w.js";import{C as B}from"./calendar-CXbnSY_4.js";import{C as D}from"./clock-CT2ky6hG.js";import{M as O}from"./map-pin-B5hnRU36.js";import{H as ne}from"./plus-Bi3vU8QF.js";import{S as le}from"./share-2-DOcEOH4v.js";import{U as P}from"./alert-f_BC70aV.js";import{T as ce}from"./tag-C0MzzUCH.js";import{T as I}from"./ticket-DYf4TAln.js";import{M as b}from"./message-circle-BzbuDOEE.js";import{U as R}from"./user-cZSM4iEh.js";import{f as de}from"./index-DCmZQWeX.js";import"./index-DGobKVbi.js";import"./index-D6sgUugm.js";import"./index-CaL9moq2.js";import"./databaseUtils-Cc-GydU0.js";import"./scroll-area-Bsyy6uVd.js";import"./tabs-Bho2AISw.js";import"./useNotifications-DlynYvan.js";import"./notificationService-DPR46Nx3.js";import"./bell-CXNc_0l5.js";import"./check-CWeqS_MX.js";import"./search-DIpOLffQ.js";import"./zap-C2TAeX5H.js";import"./message-square-oWFCH1Pi.js";import"./wifi-Ue5kLFZw.js";import"./log-out-CxjypOOW.js";import"./useLocation-Dro6x-la.js";import"./locationService-D_4XBFWa.js";import"./pointsService-BEnKQBdP.js";const Ke=()=>{const{eventId:p}=J(),u=K(),{events:g,loading:F,toggleAttendance:L}=re(),{user:k}=Q(),{toast:o}=X(),[s,$]=r.useState(null),[H,m]=r.useState(!1),[U,x]=r.useState(!1),[i,C]=r.useState(1),[f,y]=r.useState(""),[oe,me]=r.useState(0);r.useEffect(()=>{if(p&&g.length>0){const t=g.find(j=>j.id===p);$(t)}},[p,g]);const v=t=>{try{return de(new Date(t),"EEEE, MMMM dd, yyyy")}catch(j){return t}},h=t=>t===0?"Free":`$${t}`,q=()=>{if(!k){o({title:"Authentication Required",description:"Please sign in to book this event",variant:"destructive"});return}m(!0)},V=()=>{if(!k){o({title:"Authentication Required",description:"Please sign in to chat with the organizer",variant:"destructive"});return}x(!0)},Y=()=>{f.trim()&&(o({title:"Message Sent",description:"Your message has been sent to the organizer"}),y(""),x(!1))},G=()=>{s&&u(`/profile/${s.user_id}`)};if(F)return e.jsx(N,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/4 mb-4"}),e.jsx("div",{className:"h-96 bg-muted rounded-lg mb-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-full"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})]})})});if(!s)return e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Event Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"The event you're looking for doesn't exist or has been removed."}),e.jsxs(a,{onClick:()=>u("/events"),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Back to Events"]})]})});const W=s.price===0?0:s.price*i;return e.jsx(N,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(a,{variant:"ghost",onClick:()=>u("/events"),className:"mb-4",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Back to Events"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"}),v(s.event_date)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),s.event_time]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"w-4 h-4"}),s.location_name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"bg-orange-500 text-white font-semibold",children:h(s.price)}),Math.random()>.7&&e.jsxs(w,{className:"bg-blue-500 text-white",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Verified"]})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&h=400&fit=crop",alt:s.title,className:"w-full h-96 object-cover rounded-lg"}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(a,{variant:"ghost",size:"sm",className:"bg-white/20 hover:bg-white/30 text-white",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx(a,{variant:"ghost",size:"sm",className:"bg-white/20 hover:bg-white/30 text-white",children:e.jsx(le,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(n,{children:[e.jsx(c,{children:e.jsx(d,{children:"About This Event"})}),e.jsx(l,{children:e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.description||"No description available for this event."})})]}),e.jsxs(n,{children:[e.jsx(c,{children:e.jsx(d,{children:"Event Details"})}),e.jsx(l,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Date"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v(s.event_date)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Time"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.event_time})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Location"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.location_name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Attendees"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.attendees_count," / ",s.max_attendees||"âˆž"," attending"]})]})]})]})})]}),s.tags&&s.tags.length>0&&e.jsxs(n,{children:[e.jsx(c,{children:e.jsx(d,{children:"Tags"})}),e.jsx(l,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((t,j)=>e.jsxs(w,{variant:"secondary",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),t]},j))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(a,{className:"w-full",variant:s.user_attending?"default":"outline",onClick:()=>L(s.id),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),s.user_attending?"Attending":"Attend Event"]}),e.jsxs(a,{className:"w-full btn-event",onClick:q,children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Book Tickets"]}),e.jsxs(a,{variant:"outline",className:"w-full",onClick:V,children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Chat with Organizer"]})]})})}),e.jsxs(n,{children:[e.jsx(c,{children:e.jsx(d,{children:"Event Organizer"})}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted transition-colors cursor-pointer",onClick:G,children:[e.jsxs(ee,{className:"w-12 h-12",children:[e.jsx(se,{src:s.organizer_avatar}),e.jsx(ae,{children:(s.organizer_name||"E")[0]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.organizer_name||"Event Organizer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Event Creator"})]}),e.jsx(R,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsx(te,{className:"my-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Send Message"]}),e.jsxs(a,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"View Profile"]})]})]})]}),e.jsxs(n,{children:[e.jsx(c,{children:e.jsx(d,{children:"Pricing"})}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Ticket Price"}),e.jsx("span",{className:"text-2xl font-bold text-orange-500",children:h(s.price)})]}),s.price>0&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Price per ticket"})]})]})]})]}),e.jsx(_,{open:H,onOpenChange:m,children:e.jsxs(E,{className:"max-w-2xl",children:[e.jsxs(M,{children:[e.jsxs(T,{children:["Book Tickets - ",s.title]}),e.jsx(S,{children:"Select the number of tickets you'd like to book"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 p-4 bg-muted rounded-lg",children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&h=400&fit=crop",alt:s.title,className:"w-20 h-16 rounded object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v(s.event_date)," at ",s.event_time]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.location_name})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{htmlFor:"tickets",children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"General Admission"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[h(s.price)," per ticket"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"outline",size:"sm",onClick:()=>C(Math.max(1,i-1)),disabled:i<=1,children:"-"}),e.jsx("span",{className:"w-8 text-center",children:i}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>C(Math.min(s.max_attendees-s.attendees_count,i+1)),disabled:i>=s.max_attendees-s.attendees_count,children:"+"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-xl font-bold",children:h(W)})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(a,{className:"flex-1 btn-event",onClick:()=>{o({title:"Booking Successful",description:`You've booked ${i} ticket(s) for ${s.title}`}),m(!1)},children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),s.price===0?"Reserve Spot":"Book Tickets"]}),e.jsx(a,{variant:"outline",onClick:()=>m(!1),children:"Cancel"})]})]})]})}),e.jsx(_,{open:U,onOpenChange:x,children:e.jsxs(E,{className:"max-w-2xl",children:[e.jsxs(M,{children:[e.jsxs(T,{children:["Chat with ",s.organizer_name||"Event Organizer"]}),e.jsx(S,{children:"Send a message to the event organizer"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"message",children:"Your Message"}),e.jsx(ie,{id:"message",placeholder:"Type your message here...",value:f,onChange:t=>y(t.target.value),rows:4})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(a,{className:"flex-1",onClick:Y,disabled:!f.trim(),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Send Message"]}),e.jsx(a,{variant:"outline",onClick:()=>x(!1),children:"Cancel"})]})]})]})})]})})};export{Ke as default};
