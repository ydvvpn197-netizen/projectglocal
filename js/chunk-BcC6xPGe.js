var Ye=Object.defineProperty,Je=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ve=(n,r,a)=>r in n?Ye(n,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[r]=a,x=(n,r)=>{for(var a in r||(r={}))ye.call(r,a)&&ve(n,a,r[a]);if(X)for(var a of X(r))je.call(r,a)&&ve(n,a,r[a]);return n},q=(n,r)=>Je(n,Xe(r));var b=(n,r)=>{var a={};for(var s in n)ye.call(n,s)&&r.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&X)for(var s of X(n))r.indexOf(s)<0&&je.call(n,s)&&(a[s]=n[s]);return a};var c=(n,r,a)=>new Promise((s,t)=>{var o=l=>{try{d(a.next(l))}catch(w){t(w)}},u=l=>{try{d(a.throw(l))}catch(w){t(w)}},d=l=>l.done?s(l.value):Promise.resolve(l.value).then(o,u);d((a=a.apply(n,r)).next())});import{r as p,bM as Ze,bN as ea,bO as aa,R as f,j as e,bP as qe,S as W,bQ as ra,u as sa,n as ta,a1 as _,p as ee,a2 as Te,_ as na,o as Le,U as ze,x as ce,bR as ia,bS as oa,bT as la,aF as Ne,bb as _e,H as da,I as ca,bd as ua,G as Ue,ai as ma,bU as ha,bV as pa,ao as ga,bc as xa,w as Pe,t as fa,aj as Se,m as Oe,at as ba,h as wa,M as ie,f as ke,a6 as va,q as ya,aQ as ja}from"./chunk-COTa-BBv.js";import{e as g,B as S,a as Na,u as _a,C as ae,b as re,c as Sa,d as ka}from"./main-BMj1NFFE.js";import{B as oe}from"./chunk-BCSLz2CJ.js";import{A as Ca,a as Ea,b as Aa}from"./chunk-mExNus9E.js";import{D as Ce,a as Ee,b as Ae,e as Me,d as se,c as z}from"./chunk-B55Wu1Wu.js";import{S as le,a as de,b as B,c as Re,d as Ma,e as Ra,f as Ia,N as Da,P as qa}from"./chunk-CtVZ7_EZ.js";import{V as Ta}from"./chunk-BlluHz2J.js";import{I as La}from"./chunk-BQur_cHm.js";import{S as za}from"./chunk-CKr6gYyv.js";import{S as Ie}from"./chunk-DQMKfNBV.js";import{s as h}from"./chunk-CasIWBEQ.js";import{m as te}from"./chunk-COG8KeUH.js";import{A as Ua,a as Pa}from"./chunk-CE0O3dYU.js";const ne=768;function Oa(){const[n,r]=p.useState(void 0);return p.useEffect(()=>{const a=window.matchMedia(`(max-width: ${ne-1}px)`),s=()=>{r(window.innerWidth<ne)};return a.addEventListener("change",s),r(window.innerWidth<ne),()=>a.removeEventListener("change",s)},[]),!!n}const Ba=Ze,Ga=ea,$a=aa,Be=f.forwardRef((t,s)=>{var o=t,{className:n,sideOffset:r=4}=o,a=b(o,["className","sideOffset"]);return e.jsx(qe,x({ref:s,sideOffset:r,className:g("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n)},a))});Be.displayName=qe.displayName;const Ge=p.createContext(null);function K(){const n=p.useContext(Ge);if(!n)throw new Error("useSidebar must be used within a SidebarProvider.");return n}const Fa="sidebar:state",Ha=3600*24*7,Va="16rem",Wa="18rem",Ka="3rem",Qa="b",$e=f.forwardRef((l,d)=>{var w=l,{defaultOpen:n=!0,open:r,onOpenChange:a,className:s,style:t,children:o}=w,u=b(w,["defaultOpen","open","onOpenChange","className","style","children"]);const m=Oa(),[C,E]=p.useState(!1),[I,A]=p.useState(n),M=r!=null?r:I,R=p.useCallback(v=>{const j=typeof v=="function"?v(M):v;a?a(j):A(j),document.cookie=`${Fa}=${j}; path=/; max-age=${Ha}`},[a,M]),y=p.useCallback(()=>m?E(v=>!v):R(v=>!v),[m,R,E]);p.useEffect(()=>{const v=j=>{j.key===Qa&&(j.metaKey||j.ctrlKey)&&(j.preventDefault(),y())};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[y]);const k=M?"expanded":"collapsed",T=f.useMemo(()=>({state:k,open:M,setOpen:R,isMobile:m,openMobile:C,setOpenMobile:E,toggleSidebar:y}),[k,M,R,m,C,E,y]);return e.jsx(Ge.Provider,{value:T,children:e.jsx(Ba,{delayDuration:0,children:e.jsx("div",q(x({style:x({"--sidebar-width":Va,"--sidebar-width-icon":Ka},t),className:g("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",s),ref:d},u),{children:o}))})})});$e.displayName="SidebarProvider";const Fe=f.forwardRef((d,u)=>{var l=d,{side:n="left",variant:r="sidebar",collapsible:a="offcanvas",className:s,children:t}=l,o=b(l,["side","variant","collapsible","className","children"]);const{isMobile:w,state:m,openMobile:C,setOpenMobile:E}=K();return a==="none"?e.jsx("div",q(x({className:g("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",s),ref:u},o),{children:t})):w?e.jsx(le,{open:C,onOpenChange:E,children:e.jsx(de,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":Wa},side:n,children:e.jsx("div",{className:"flex h-full w-full flex-col",children:t})})}):e.jsxs("div",{ref:u,className:"group peer hidden md:block text-sidebar-foreground","data-state":m,"data-collapsible":m==="collapsed"?a:"","data-variant":r,"data-side":n,children:[e.jsx("div",{className:g("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",r==="floating"||r==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),e.jsx("div",q(x({className:g("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",n==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",r==="floating"||r==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",s)},o),{children:e.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:t})}))]})});Fe.displayName="Sidebar";const Ya=f.forwardRef((t,s)=>{var o=t,{className:n,onClick:r}=o,a=b(o,["className","onClick"]);const{toggleSidebar:u}=K();return e.jsxs(S,q(x({ref:s,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:g("h-7 w-7",n),onClick:d=>{r==null||r(d),u()}},a),{children:[e.jsx(ra,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]}))});Ya.displayName="SidebarTrigger";const Ja=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);const{toggleSidebar:o}=K();return e.jsx("button",x({ref:a,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:o,title:"Toggle Sidebar",className:g("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",n)},r))});Ja.displayName="SidebarRail";const He=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("main",x({ref:a,className:g("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.1))] md:peer-data-[variant=inset]:m-0 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-none md:peer-data-[variant=inset]:shadow-none",n)},r))});He.displayName="SidebarInset";const Xa=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx(La,x({ref:a,"data-sidebar":"input",className:g("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",n)},r))});Xa.displayName="SidebarInput";const Za=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("div",x({ref:a,"data-sidebar":"header",className:g("flex flex-col gap-2 p-2",n)},r))});Za.displayName="SidebarHeader";const er=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("div",x({ref:a,"data-sidebar":"footer",className:g("flex flex-col gap-2 p-2",n)},r))});er.displayName="SidebarFooter";const ar=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx(za,x({ref:a,"data-sidebar":"separator",className:g("mx-2 w-auto bg-sidebar-border",n)},r))});ar.displayName="SidebarSeparator";const Ve=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("div",x({ref:a,"data-sidebar":"content",className:g("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",n)},r))});Ve.displayName="SidebarContent";const G=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("div",x({ref:a,"data-sidebar":"group",className:g("relative flex w-full min-w-0 flex-col p-2",n)},r))});G.displayName="SidebarGroup";const $=f.forwardRef((t,s)=>{var o=t,{className:n,asChild:r=!1}=o,a=b(o,["className","asChild"]);const u=r?W:"div";return e.jsx(u,x({ref:s,"data-sidebar":"group-label",className:g("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",n)},a))});$.displayName="SidebarGroupLabel";const rr=f.forwardRef((t,s)=>{var o=t,{className:n,asChild:r=!1}=o,a=b(o,["className","asChild"]);const u=r?W:"button";return e.jsx(u,x({ref:s,"data-sidebar":"group-action",className:g("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",n)},a))});rr.displayName="SidebarGroupAction";const F=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("div",x({ref:a,"data-sidebar":"group-content",className:g("w-full text-sm",n)},r))});F.displayName="SidebarGroupContent";const H=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("ul",x({ref:a,"data-sidebar":"menu",className:g("flex w-full min-w-0 flex-col gap-1",n)},r))});H.displayName="SidebarMenu";const V=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("li",x({ref:a,"data-sidebar":"menu-item",className:g("group/menu-item relative",n)},r))});V.displayName="SidebarMenuItem";const sr=Ta("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),U=f.forwardRef((l,d)=>{var w=l,{asChild:n=!1,isActive:r=!1,variant:a="default",size:s="default",tooltip:t,className:o}=w,u=b(w,["asChild","isActive","variant","size","tooltip","className"]);const m=n?W:"button",{isMobile:C,state:E}=K(),I=e.jsx(m,x({ref:d,"data-sidebar":"menu-button","data-size":s,"data-active":r,className:g(sr({variant:a,size:s}),o)},u));return t?(typeof t=="string"&&(t={children:t}),e.jsxs(Ga,{children:[e.jsx($a,{asChild:!0,children:I}),e.jsx(Be,x({side:"right",align:"center",hidden:E!=="collapsed"||C},t))]})):I});U.displayName="SidebarMenuButton";const tr=f.forwardRef((o,t)=>{var u=o,{className:n,asChild:r=!1,showOnHover:a=!1}=u,s=b(u,["className","asChild","showOnHover"]);const d=r?W:"button";return e.jsx(d,x({ref:t,"data-sidebar":"menu-action",className:g("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",n)},s))});tr.displayName="SidebarMenuAction";const nr=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("div",x({ref:a,"data-sidebar":"menu-badge",className:g("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n)},r))});nr.displayName="SidebarMenuBadge";const ir=f.forwardRef((t,s)=>{var o=t,{className:n,showIcon:r=!1}=o,a=b(o,["className","showIcon"]);const u=f.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return e.jsxs("div",q(x({ref:s,"data-sidebar":"menu-skeleton",className:g("rounded-md h-8 flex gap-2 px-2 items-center",n)},a),{children:[r&&e.jsx(Ie,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),e.jsx(Ie,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":u}})]}))});ir.displayName="SidebarMenuSkeleton";const or=f.forwardRef((s,a)=>{var t=s,{className:n}=t,r=b(t,["className"]);return e.jsx("ul",x({ref:a,"data-sidebar":"menu-sub",className:g("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",n)},r))});or.displayName="SidebarMenuSub";const lr=f.forwardRef((a,r)=>{var n=b(a,[]);return e.jsx("li",x({ref:r},n))});lr.displayName="SidebarMenuSubItem";const dr=f.forwardRef((u,o)=>{var d=u,{asChild:n=!1,size:r="md",isActive:a,className:s}=d,t=b(d,["asChild","size","isActive","className"]);const l=n?W:"a";return e.jsx(l,x({ref:o,"data-sidebar":"menu-sub-button","data-size":r,"data-active":a,className:g("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",r==="sm"&&"text-xs",r==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",s)},t))});dr.displayName="SidebarMenuSubButton";class cr{isAdmin(){return c(this,null,function*(){try{const{data:{user:r}}=yield h.auth.getUser();if(!r)return!1;const{data:a,error:s}=yield h.from("admin_users").select("id").eq("user_id",r.id).eq("is_active",!0).single();return s?!1:!!a}catch(r){return console.error("Error checking admin status:",r),!1}})}checkAdminExists(r){return c(this,null,function*(){try{const{data:a,error:s}=yield h.from("admin_users").select("id").eq("email",r).eq("is_active",!0).single();return s?!1:!!a}catch(a){return console.error("Error checking admin exists:",a),!1}})}createAdminSession(r,a){return c(this,null,function*(){try{const{data:s,error:t}=yield h.from("admin_users").select("id, password_hash, email").eq("email",r).eq("is_active",!0).single();if(t||!s)throw new Error("Invalid admin credentials");if(!(yield this.verifyPassword(a,s.password_hash)))throw new Error("Invalid admin credentials");const u=this.generateSessionToken(),{error:d}=yield h.from("admin_sessions").insert({admin_id:s.id,session_token:u,expires_at:new Date(Date.now()+1440*60*1e3).toISOString(),created_at:new Date().toISOString()});return d?(console.error("Error creating admin session:",d),null):u}catch(s){return console.error("Error creating admin session:",s),null}})}verifyAdminSession(r){return c(this,null,function*(){try{const{data:a,error:s}=yield h.from("admin_sessions").select("id, expires_at").eq("session_token",r).eq("is_active",!0).single();return s||!a?!1:new Date(a.expires_at)<new Date?(yield h.from("admin_sessions").update({is_active:!1}).eq("id",a.id),!1):!0}catch(a){return console.error("Error verifying admin session:",a),!1}})}getAdminBySession(r){return c(this,null,function*(){try{const{data:a,error:s}=yield h.from("admin_sessions").select(`
          admin_users!inner(
            *,
            role:admin_roles(*),
            profile:profiles(username, full_name, email, avatar_url)
          )
        `).eq("session_token",r).eq("is_active",!0).single();return s||!a?null:a.admin_users}catch(a){return console.error("Error getting admin by session:",a),null}})}invalidateAdminSession(r){return c(this,null,function*(){try{yield h.from("admin_sessions").update({is_active:!1}).eq("session_token",r)}catch(a){console.error("Error invalidating admin session:",a)}})}generateSessionToken(){return"admin_"+Math.random().toString(36).substring(2)+Date.now().toString(36)}verifyPassword(r,a){return c(this,null,function*(){return r===a})}getCurrentAdminUser(){return c(this,null,function*(){try{const{data:{user:r}}=yield h.auth.getUser();if(!r)return null;const{data:a,error:s}=yield h.from("admin_users").select(`
          *,
          role:admin_roles(*),
          profile:profiles(username, full_name, email, avatar_url)
        `).eq("user_id",r.id).eq("is_active",!0).single();return s?(console.error("Error fetching admin user:",s),null):a}catch(r){return console.error("Error getting current admin user:",r),null}})}checkPermission(r){return c(this,null,function*(){try{const{data:{user:a}}=yield h.auth.getUser();if(!a)return!1;const{data:s,error:t}=yield h.rpc("check_admin_permission",{required_permission:r,user_uuid:a.id});return t?(console.error("Error checking permission:",t),!1):s}catch(a){return console.error("Error checking permission:",a),!1}})}logAction(r,a,s,t){return c(this,null,function*(){try{const{data:{user:o}}=yield h.auth.getUser();if(!o)return null;const{data:u}=yield h.from("admin_users").select("id").eq("user_id",o.id).eq("is_active",!0).single();if(!u)return null;const{data:d,error:l}=yield h.from("admin_actions").insert({admin_user_id:u.id,action_type:r,resource_type:a,resource_id:s,details:t||{}}).select("id").single();return l?(console.error("Error logging admin action:",l),null):d.id}catch(o){return console.error("Error logging admin action:",o),null}})}getAdminUsers(r=1,a=20,s){return c(this,null,function*(){try{let t=h.from("admin_users").select(`
          *,
          role:admin_roles(*),
          profile:profiles(username, full_name, email, avatar_url)
        `,{count:"exact"});s!=null&&s.search&&(t=t.or(`profile.username.ilike.%${s.search}%,profile.full_name.ilike.%${s.search}%`)),s!=null&&s.role_id&&(t=t.eq("role_id",s.role_id)),(s==null?void 0:s.is_active)!==void 0&&(t=t.eq("is_active",s.is_active));const o=(r-1)*a;t=t.range(o,o+a-1),t=t.order("created_at",{ascending:!1});const{data:u,error:d,count:l}=yield t;if(d)throw d;return{data:u||[],pagination:{page:r,limit:a,total:l||0,total_pages:Math.ceil((l||0)/a)}}}catch(t){throw console.error("Error fetching admin users:",t),t}})}createAdminUser(r,a,s){return c(this,null,function*(){try{const{data:t,error:o}=yield h.from("admin_users").insert({user_id:r,role_id:a,two_factor_enabled:(s==null?void 0:s.twoFactorEnabled)||!1,ip_whitelist:(s==null?void 0:s.ipWhitelist)||[]}).select(`
          *,
          role:admin_roles(*),
          profile:profiles(username, full_name, email, avatar_url)
        `).single();if(o)throw o;return yield this.logAction("create","admin_user",t.id,{user_id:r,role_id:a}),t}catch(t){throw console.error("Error creating admin user:",t),t}})}updateAdminUser(r,a){return c(this,null,function*(){try{const{data:s,error:t}=yield h.from("admin_users").update(q(x({},a),{updated_at:new Date().toISOString()})).eq("id",r).select(`
          *,
          role:admin_roles(*),
          profile:profiles(username, full_name, email, avatar_url)
        `).single();if(t)throw t;return yield this.logAction("update","admin_user",r,a),s}catch(s){throw console.error("Error updating admin user:",s),s}})}deleteAdminUser(r){return c(this,null,function*(){try{const{error:a}=yield h.from("admin_users").delete().eq("id",r);if(a)throw a;yield this.logAction("delete","admin_user",r)}catch(a){throw console.error("Error deleting admin user:",a),a}})}getAdminRoles(){return c(this,null,function*(){try{const{data:r,error:a}=yield h.from("admin_roles").select("*").eq("is_active",!0).order("display_name");if(a)throw a;return r||[]}catch(r){throw console.error("Error fetching admin roles:",r),r}})}createAdminRole(r){return c(this,null,function*(){try{const{data:a,error:s}=yield h.from("admin_roles").insert(r).select().single();if(s)throw s;return yield this.logAction("create","admin_role",a.id,r),a}catch(a){throw console.error("Error creating admin role:",a),a}})}updateAdminRole(r,a){return c(this,null,function*(){try{const{data:s,error:t}=yield h.from("admin_roles").update(q(x({},a),{updated_at:new Date().toISOString()})).eq("id",r).select().single();if(t)throw t;return yield this.logAction("update","admin_role",r,a),s}catch(s){throw console.error("Error updating admin role:",s),s}})}deleteAdminRole(r){return c(this,null,function*(){try{const{error:a}=yield h.from("admin_roles").delete().eq("id",r);if(a)throw a;yield this.logAction("delete","admin_role",r)}catch(a){throw console.error("Error deleting admin role:",a),a}})}getAdminActions(r=1,a=50,s){return c(this,null,function*(){try{let t=h.from("admin_actions").select(`
          *,
          admin_user:admin_users(
            id,
            profile:profiles(username, full_name)
          )
        `,{count:"exact"});s!=null&&s.action_type&&(t=t.eq("action_type",s.action_type)),s!=null&&s.resource_type&&(t=t.eq("resource_type",s.resource_type)),s!=null&&s.admin_user_id&&(t=t.eq("admin_user_id",s.admin_user_id)),s!=null&&s.date_from&&(t=t.gte("created_at",s.date_from)),s!=null&&s.date_to&&(t=t.lte("created_at",s.date_to));const o=(r-1)*a;t=t.range(o,o+a-1),t=t.order("created_at",{ascending:!1});const{data:u,error:d,count:l}=yield t;if(d)throw d;return{data:u||[],pagination:{page:r,limit:a,total:l||0,total_pages:Math.ceil((l||0)/a)}}}catch(t){throw console.error("Error fetching admin actions:",t),t}})}updateLastLogin(r){return c(this,null,function*(){try{const{error:a}=yield h.from("admin_users").update({last_login_at:new Date().toISOString(),login_count:h.sql`login_count + 1`}).eq("id",r);if(a)throw a}catch(a){throw console.error("Error updating last login:",a),a}})}getDashboardStats(){return c(this,null,function*(){try{return{totalUsers:1250,activeUsers:890,newUsersToday:45,totalContent:3456,pendingReports:23,totalEvents:567,totalPosts:2345,totalReviews:544}}catch(r){throw console.error("Error fetching dashboard stats:",r),r}})}getSystemSettings(){return c(this,null,function*(){try{const{data:r,error:a}=yield h.from("system_settings").select("*").order("setting_key");if(a)throw a;return r||[]}catch(r){throw console.error("Error fetching system settings:",r),r}})}updateSystemSettings(r){return c(this,null,function*(){try{for(const a of r){const{error:s}=yield h.from("system_settings").upsert({setting_key:a.setting_key,setting_value:a.setting_value,setting_type:a.setting_type,description:a.description,is_public:a.is_public});if(s)throw s}}catch(a){throw console.error("Error updating system settings:",a),a}})}getUsers(r){return c(this,null,function*(){try{let a=h.from("profiles").select("*",{count:"exact"});r.search&&(a=a.or(`full_name.ilike.%${r.search}%,email.ilike.%${r.search}%`)),r.role&&(a=a.eq("role",r.role)),r.status&&(a=a.eq("status",r.status));const{data:s,error:t,count:o}=yield a.range((r.page-1)*r.limit,r.page*r.limit-1).order("created_at",{ascending:!1});if(t)throw t;return{data:s||[],total:o||0}}catch(a){throw console.error("Error fetching users:",a),a}})}getContentReports(r){return c(this,null,function*(){try{let a=h.from("content_reports").select(`
          *,
          reporter:profiles!content_reports_reporter_id_fkey(*)
        `,{count:"exact"});r.search&&(a=a.or(`report_reason.ilike.%${r.search}%,report_details.ilike.%${r.search}%`)),r.contentType&&(a=a.eq("content_type",r.contentType)),r.reportStatus&&(a=a.eq("report_status",r.reportStatus)),r.reportReason&&(a=a.eq("report_reason",r.reportReason));const{data:s,error:t,count:o}=yield a.range((r.page-1)*r.limit,r.page*r.limit-1).order("created_at",{ascending:!1});if(t)throw t;return{data:s||[],total:o||0}}catch(a){throw console.error("Error fetching content reports:",a),a}})}resolveContentReport(r,a,s){return c(this,null,function*(){try{const{error:t}=yield h.from("content_reports").update({report_status:a==="approve"?"resolved":a==="reject"?"dismissed":"escalated",resolution_notes:s,reviewed_at:new Date().toISOString()}).eq("id",r);if(t)throw t}catch(t){throw console.error("Error resolving content report:",t),t}})}getUserAnalytics(r){return c(this,null,function*(){try{return{totalUsers:1250,activeUsers:890,newUsers:45,previousPeriodUsers:1205,dailyActiveUsers:234,weeklyActiveUsers:567,monthlyActiveUsers:890,usersWithLocation:78.5,verifiedUsers:92.3,day1Retention:65.2,day7Retention:42.1,day30Retention:28.7}}catch(a){throw console.error("Error fetching user analytics:",a),a}})}getContentAnalytics(r){return c(this,null,function*(){try{return{totalContent:3456,newContent:123,previousPeriodContent:3333,posts:2345,events:567,reviews:544,avgViewsPerPost:45,avgLikesPerPost:12,avgCommentsPerPost:8,reportedContent:23,removedContent:5,contentApprovalRate:98.5}}catch(a){throw console.error("Error fetching content analytics:",a),a}})}getPlatformMetrics(r){return c(this,null,function*(){try{return{engagementRate:67.8,avgSessionDuration:4.5,totalViews:125e3,totalLikes:34500,totalShares:8900,pagesPerSession:3.2,bounceRate:23.4,uptime:99.9,avgResponseTime:150,errorRate:.1}}catch(a){throw console.error("Error fetching platform metrics:",a),a}})}suspendUser(r){return c(this,null,function*(){try{const{error:a}=yield h.from("profiles").update({status:"suspended"}).eq("id",r);if(a)throw a}catch(a){throw console.error("Error suspending user:",a),a}})}activateUser(r){return c(this,null,function*(){try{const{error:a}=yield h.from("profiles").update({status:"active"}).eq("id",r);if(a)throw a}catch(a){throw console.error("Error activating user:",a),a}})}deleteUser(r){return c(this,null,function*(){try{const{error:a}=yield h.rpc("delete_user_account",{user_uuid:r});if(a)throw a}catch(a){throw console.error("Error deleting user:",a),a}})}}const ur=()=>{const[n,r]=p.useState(null),[a,s]=p.useState(null),[t,o]=p.useState(!0),[u,d]=p.useState(null),[l,w]=p.useState(null),m=p.useMemo(()=>new cr,[]),C=p.useCallback(()=>c(null,null,function*(){var y;try{o(!0),d(null);const k=localStorage.getItem("admin_session_token");if(!k){r(null),s(null),w(null);return}if(!(yield m.verifyAdminSession(k))){localStorage.removeItem("admin_session_token"),r(null),s(null),w(null);return}const v=yield m.getAdminBySession(k);v?(r(v),s(((y=v.role)==null?void 0:y.permissions)||null),w(k),yield m.updateLastLogin(v.id)):(localStorage.removeItem("admin_session_token"),r(null),s(null),w(null))}catch(k){console.error("Error checking admin status:",k),d("Failed to verify admin status"),r(null),s(null),w(null),localStorage.removeItem("admin_session_token")}finally{o(!1)}}),[m]),E=p.useCallback((y,k)=>c(null,null,function*(){var T;try{if(o(!0),d(null),!(yield m.checkAdminExists(y)))throw new Error("Access denied. Admin privileges required.");const j=yield m.createAdminSession(y,k);if(!j)throw new Error("Invalid admin credentials");localStorage.setItem("admin_session_token",j),w(j);const N=yield m.getAdminBySession(j);if(N)r(N),s(((T=N.role)==null?void 0:T.permissions)||null),yield m.updateLastLogin(N.id);else throw new Error("Failed to load admin data")}catch(v){throw console.error("Admin login error:",v),d(v instanceof Error?v.message:"Login failed"),v}finally{o(!1)}}),[m]),I=p.useCallback(()=>c(null,null,function*(){try{o(!0),d(null),n&&l&&(yield m.logAction("logout","admin_session",n.id),yield m.invalidateAdminSession(l)),localStorage.removeItem("admin_session_token"),r(null),s(null),w(null)}catch(y){console.error("Admin logout error:",y),d("Logout failed")}finally{o(!1)}}),[m,n,l]),A=p.useCallback(y=>a?a[y]===!0:!1,[a]),M=p.useCallback(y=>n!=null&&n.role?n.role.name===y:!1,[n]),R=p.useCallback(()=>M("super_admin"),[M]);return p.useEffect(()=>{C()},[C]),{adminUser:n,permissions:a,isLoading:t,error:u,login:E,logout:I,checkPermission:A,hasRole:M,isSuperAdmin:R,checkAdminStatus:C,isAuthenticated:!!n&&!!l}},mr=p.createContext(void 0),hr=()=>{const n=p.useContext(mr);if(n===void 0)throw new Error("useEnhancedTheme must be used within an EnhancedThemeProvider");return n},pr=[{label:"Feed",href:"/feed",icon:da,priority:"high",group:"main",mobile:!0},{label:"Discover",href:"/discover",icon:Te,priority:"high",group:"main",mobile:!0},{label:"Events",href:"/events",icon:Le,priority:"high",group:"main",mobile:!0},{label:"Community",href:"/community",icon:ze,priority:"high",group:"main",mobile:!0},{label:"Book Artists",href:"/book-artist",icon:ca,priority:"high",group:"main",mobile:!0},{label:"News",href:"/news",icon:ua,priority:"medium",group:"explore",mobile:!0},{label:"Public Square",href:"/public-square",icon:Ue,priority:"low",group:"explore"},{label:"Local Communities",href:"/communities",icon:ma,priority:"low",group:"explore"},{label:"Local Businesses",href:"/businesses",icon:ha,priority:"low",group:"explore"},{label:"Polls",href:"/polls",icon:pa,priority:"low",group:"explore"},{label:"Civic Engagement",href:"/civic-engagement",icon:ga,priority:"low",group:"explore"},{label:"Legal Assistant",href:"/legal-assistant",icon:xa,group:"features"},{label:"Life Wishes",href:"/life-wish",icon:Pe,group:"features"},{label:"Trending",href:"/feed?tab=trending",icon:fa,featured:!0,group:"features"},{label:"My Dashboard",href:"/my-dashboard",icon:Se,group:"account"},{label:"Messages",href:"/messages",icon:ce,group:"account"},{label:"Profile",href:"/profile",icon:Se,group:"account"},{label:"Privacy",href:"/privacy",icon:Oe,group:"account"},{label:"Subscription",href:"/subscription",icon:ba,group:"account"},{label:"Settings",href:"/settings",icon:wa,group:"account"},{label:"About",href:"/about",icon:ie,group:"account"}],gr=[{label:"Admin Dashboard",href:"/admin",icon:Oe,admin:!0,group:"account"}],De=({className:n,variant:r="sidebar",showSearch:a=!0,showNotifications:s=!0,showUserMenu:t=!0,showMobileMenu:o=!0,notifications:u=0,onSearch:d,onThemeToggle:l,onNotificationClick:w})=>{var ge,xe,fe,be,we;const{user:m,signOut:C}=Na(),{adminUser:E}=ur(),I=sa(),A=ta(),{toast:M}=_a(),{theme:R,setTheme:y}=hr(),{state:k}=K(),[T,v]=p.useState(!1),[j,N]=p.useState(!1),[P,Z]=p.useState(""),[We,ue]=p.useState(!1),[fr,me]=p.useState(!1),Ke=p.useRef(null),L=k==="collapsed";p.useEffect(()=>{c(null,null,function*(){if(m)try{const{data:J}=yield h.from("artists").select("id").eq("user_id",m.id).single();me(!!J)}catch(J){me(!1)}})},[m]),p.useEffect(()=>{const i=()=>{v(window.scrollY>10)};return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[]);const D=i=>pr.filter(J=>J.group===i),Q=()=>{const i=D("account");return E?[...i,...gr]:i},he=i=>{i.preventDefault(),P.trim()&&(d==null||d(P),A(`/search?q=${encodeURIComponent(P)}`),Z(""))},Qe=()=>{y(R==="dark"?"light":R==="light"?"system":"dark"),l==null||l()},pe=()=>c(null,null,function*(){try{yield C(),M({title:"Signed out successfully",description:"Come back soon!"}),A("/")}catch(i){M({title:"Error signing out",description:"Please try again.",variant:"destructive"})}}),O=i=>i==="/"?I.pathname==="/":I.pathname.startsWith(i),Y=({isActive:i})=>i?"bg-sidebar-accent text-sidebar-accent-foreground font-medium":"hover:bg-sidebar-accent/50";return r==="sidebar"?e.jsx(Fe,{className:L?"w-14":"w-60",collapsible:"icon",children:e.jsxs(Ve,{children:[!L&&e.jsx("div",{className:"p-1 border-b border-sidebar-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-bold text-sidebar-foreground flex items-center gap-2",children:[e.jsx("img",{src:"/logo.png",alt:"TheGlocal Logo",className:"h-5 w-5 object-contain"}),"TheGlocal"]}),m?e.jsx(B,{}):e.jsx(B,{})]})}),e.jsx("div",{className:"p-1",children:e.jsx(U,{asChild:!0,children:e.jsxs(_,{to:"/create",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(ee,{className:"h-4 w-4"}),!L&&e.jsx("span",{children:"Create Post"})]})})}),e.jsxs(G,{children:[e.jsx($,{children:"Main"}),e.jsx(F,{children:e.jsx(H,{children:D("main").map(i=>e.jsx(V,{children:e.jsx(U,{asChild:!0,children:e.jsxs(_,{to:i.href,end:!0,className:Y,children:[e.jsx(i.icon,{className:"h-4 w-4"}),!L&&e.jsx("span",{children:i.label})]})})},i.label))})})]}),!L&&e.jsxs(G,{children:[e.jsx($,{children:"Explore"}),e.jsx(F,{children:e.jsx(H,{children:D("explore").slice(0,3).map(i=>e.jsx(V,{children:e.jsx(U,{asChild:!0,children:e.jsxs(_,{to:i.href,end:!0,className:Y,children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label})]})})},i.label))})})]}),e.jsxs(G,{children:[e.jsx($,{children:"New Features"}),e.jsx(F,{children:e.jsx(H,{children:D("features").map(i=>e.jsx(V,{children:e.jsx(U,{asChild:!0,children:e.jsxs(_,{to:i.href,end:!0,className:Y,children:[e.jsx(i.icon,{className:"h-4 w-4"}),!L&&e.jsx("span",{children:i.label})]})})},i.label))})})]}),e.jsxs(G,{children:[e.jsx($,{children:"Account"}),e.jsx(F,{children:e.jsx(H,{children:Q().map(i=>e.jsx(V,{children:e.jsx(U,{asChild:!0,children:e.jsxs(_,{to:i.href,end:!0,className:Y,children:[e.jsx(i.icon,{className:"h-4 w-4"}),!L&&e.jsx("span",{children:i.label})]})})},i.label))})})]})]})}):r==="header"?e.jsx(te.nav,{className:g("sticky top-0 z-50 w-full transition-all duration-300","bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",T&&"shadow-md bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80",n),initial:{y:-100},animate:{y:0},transition:{duration:.3},children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsx(_,{to:"/",className:"flex items-center space-x-2",children:e.jsxs(te.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center space-x-2",children:[e.jsx("img",{src:"/logo.png",alt:"Glocal Logo",className:"h-8 w-8 object-contain"}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-primary to-primary/80 bg-clip-text text-transparent",children:"TheGlocal"})]})}),e.jsx("div",{className:"hidden md:flex items-center space-x-1",children:D("main").filter(i=>i.mobile).map(i=>e.jsxs(_,{to:i.href,className:g("relative px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center space-x-2",O(i.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label}),i.badge&&e.jsx(oe,{variant:"secondary",className:"ml-1 h-5 w-5 rounded-full p-0 text-xs",children:i.badge}),i.featured&&e.jsx(te.div,{className:"absolute -top-1 -right-1 h-2 w-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}})]},i.href))}),a&&e.jsx("div",{className:"hidden md:flex items-center flex-1 max-w-md mx-4",children:e.jsxs("form",{onSubmit:he,className:"relative w-full",children:[e.jsx("input",{ref:Ke,type:"text",placeholder:"Search events, people, places...",value:P,onChange:i=>Z(i.target.value),onFocus:()=>ue(!0),onBlur:()=>ue(!1),className:g("w-full pl-10 pr-4 py-2 rounded-full border bg-background text-sm transition-all duration-200",We?"border-primary ring-2 ring-primary/20":"border-input hover:border-primary/50")}),e.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Ce,{children:[e.jsx(Ee,{asChild:!0,children:e.jsxs(S,{size:"sm",className:"hidden md:flex",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Create"]})}),e.jsxs(Ae,{align:"end",className:"w-48",children:[e.jsx(Me,{children:"Create New"}),e.jsx(se,{}),e.jsxs(z,{onClick:()=>A("/create"),children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),"Post"]}),e.jsxs(z,{onClick:()=>A("/create-event"),children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Event"]}),e.jsxs(z,{onClick:()=>A("/community/create-group"),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Group"]}),e.jsxs(z,{onClick:()=>A("/community/create-discussion"),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Discussion"]})]})]}),s&&(m?e.jsx(B,{notifications:u}):e.jsx(B,{notifications:u,onClick:w})),e.jsx(S,{variant:"ghost",size:"sm",onClick:Qe,className:"hidden md:flex",children:R==="dark"?e.jsx(ia,{className:"h-4 w-4"}):R==="light"?e.jsx(oa,{className:"h-4 w-4"}):e.jsx(la,{className:"h-4 w-4"})}),t&&m?e.jsxs(Ce,{children:[e.jsx(Ee,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",className:"relative",children:e.jsxs(Ca,{className:"h-8 w-8",children:[e.jsx(Ea,{src:(ge=m.user_metadata)==null?void 0:ge.avatar_url}),e.jsx(Aa,{children:((fe=(xe=m.user_metadata)==null?void 0:xe.full_name)==null?void 0:fe[0])||((be=m.email)==null?void 0:be[0])||"U"})]})})}),e.jsxs(Ae,{align:"end",className:"w-56",children:[e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:((we=m.user_metadata)==null?void 0:we.full_name)||"User"}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:m.email})]})}),e.jsx(se,{}),Q().map(i=>e.jsxs(z,{onClick:()=>A(i.href),children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:i.label})]},i.href)),e.jsx(se,{}),e.jsxs(z,{onClick:pe,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]}):e.jsx(S,{size:"sm",onClick:()=>A("/signin"),children:"Sign In"}),o&&e.jsxs(le,{open:j,onOpenChange:N,children:[e.jsx(Re,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",className:"md:hidden",children:e.jsx(_e,{className:"h-4 w-4"})})}),e.jsxs(de,{side:"right",className:"w-[300px] sm:w-[400px]",children:[e.jsxs(Ma,{children:[e.jsx(Ra,{children:"Menu"}),e.jsx(Ia,{children:"Navigate through the app"})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[a&&e.jsx("div",{className:"space-y-2",children:e.jsx("form",{onSubmit:he,children:e.jsx("input",{type:"text",placeholder:"Search...",value:P,onChange:i=>Z(i.target.value),className:"w-full px-3 py-2 border rounded-md"})})}),e.jsx("div",{className:"space-y-2",children:D("main").filter(i=>i.mobile).map(i=>e.jsxs(_,{to:i.href,onClick:()=>N(!1),className:g("flex items-center space-x-3 px-3 py-2 rounded-md text-sm transition-colors",O(i.href)?"bg-primary text-primary-foreground":"hover:bg-accent"),children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label}),i.badge&&e.jsx(oe,{variant:"secondary",className:"ml-auto",children:i.badge})]},i.href))}),m&&e.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[Q().map(i=>e.jsxs(_,{to:i.href,onClick:()=>N(!1),className:"flex items-center space-x-3 px-3 py-2 rounded-md text-sm hover:bg-accent",children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label})]},i.href)),e.jsxs("button",{onClick:()=>{pe(),N(!1)},className:"flex items-center space-x-3 px-3 py-2 rounded-md text-sm hover:bg-accent w-full text-left",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{children:"Sign Out"})]})]})]})]})]})]})]})})}):r==="mobile"?e.jsx("div",{className:g("lg:hidden",n),children:e.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex h-14 items-center justify-between px-4",children:[e.jsxs(_,{to:"/",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-br from-primary to-primary/80 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"G"})}),e.jsx("span",{className:"text-lg font-bold",children:"Glocal"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m?e.jsx(B,{}):null,e.jsxs(le,{open:j,onOpenChange:N,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(S,{variant:"ghost",size:"icon",children:[e.jsx(_e,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsx(de,{side:"right",className:"w-[280px] sm:w-[350px]",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Navigation"}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>N(!1),children:"Ã—"})]}),e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Main"}),e.jsx("nav",{className:"space-y-1",children:D("main").filter(i=>i.mobile).map(i=>e.jsxs(_,{to:i.href,onClick:()=>N(!1),className:g("flex items-center space-x-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",O(i.href)?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground"),children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label})]},i.label))})]}),e.jsx("div",{className:"py-2",children:e.jsxs(_,{to:"/create",onClick:()=>N(!1),className:"flex items-center space-x-3 w-full px-3 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Create Post"})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Explore"}),e.jsx("nav",{className:"space-y-1",children:D("explore").slice(0,4).map(i=>e.jsxs(_,{to:i.href,onClick:()=>N(!1),className:g("flex items-center space-x-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",O(i.href)?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground"),children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label})]},i.label))})]}),m&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Account"}),e.jsx("nav",{className:"space-y-1",children:Q().map(i=>e.jsxs(_,{to:i.href,onClick:()=>N(!1),className:g("flex items-center space-x-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",O(i.href)?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground"),children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.label})]},i.label))})]})]})]})})]})]})]})})}):null},xr=({className:n})=>{const[r,a]=p.useState(!0),[s,t]=p.useState(null),[o,u]=p.useState([]);p.useEffect(()=>{const l=setTimeout(()=>{a(!1),u([{id:"1",title:"Local Community Event This Weekend",summary:"Join us for a community gathering featuring local artists and food vendors.",source:"Local News",publishedAt:new Date().toISOString(),imageUrl:null,city:"Delhi",country:"India"},{id:"2",title:"New Infrastructure Development Announced",summary:"City officials announce plans for improved public transportation.",source:"City News",publishedAt:new Date(Date.now()-36e5).toISOString(),imageUrl:null,city:"Delhi",country:"India"}])},2e3);return()=>clearTimeout(l)},[]);const d=()=>{a(!0),t(null),setTimeout(()=>{a(!1)},1e3)};return r?e.jsxs("div",{className:`px-4 py-8 ${n}`,children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Local News"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Delhi, India"})]})]}),e.jsxs(S,{onClick:d,disabled:r,variant:"outline",size:"sm",children:[e.jsx(ke,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})}),e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((l,w)=>e.jsx(ae,{className:"overflow-hidden",children:e.jsx(re,{className:"p-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg flex-shrink-0 animate-pulse"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-1/2"}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("div",{className:"h-6 w-16 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),e.jsx("div",{className:"h-6 w-20 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]})]})]})})},w))})]}):s?e.jsx("div",{className:`px-4 py-8 ${n}`,children:e.jsx(Ua,{children:e.jsx(Pa,{children:s})})}):e.jsxs("div",{className:`px-4 py-8 ${n}`,children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Local News"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Delhi, India"})]})]}),e.jsxs(S,{onClick:d,disabled:r,variant:"outline",size:"sm",children:[e.jsx(ke,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})}),e.jsx("div",{className:"space-y-6",children:o.length===0?e.jsx(ae,{children:e.jsxs(re,{className:"p-8 text-center",children:[e.jsx(Ue,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No news found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Try refreshing or check back later for updates."})]})}):o.map(l=>e.jsxs(ae,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx(Sa,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(ka,{className:"text-xl mb-2 line-clamp-2",children:l.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(va,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(l.publishedAt).toLocaleDateString()})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{children:l.source})}),e.jsx(oe,{variant:"secondary",className:"text-xs",children:l.city})]})]})})}),e.jsxs(re,{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:l.summary}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(S,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-red-600",children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Like"]}),e.jsxs(S,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-blue-600",children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"Comment"]}),e.jsxs(S,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-green-600",children:[e.jsx(ya,{className:"h-4 w-4 mr-1"}),"Share"]}),e.jsxs(S,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-purple-600",children:[e.jsx(ja,{className:"h-4 w-4 mr-1"}),"Poll"]})]})})]})]},l.id))})]})};function Ir({children:n,showNewsFeed:r=!0}){return e.jsxs(e.Fragment,{children:[e.jsx(De,{variant:"mobile"}),e.jsx($e,{children:e.jsxs("div",{className:"min-h-screen bg-background flex",children:[e.jsx(Da,{}),e.jsx(qa,{position:"top",variant:"default",maxCampaigns:1,className:"z-40"}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(De,{variant:"sidebar"})}),e.jsx(He,{className:"flex-1",children:e.jsx("main",{className:"flex-1 overflow-auto bg-background",children:e.jsx("div",{className:"w-full px-4 py-4 lg:px-6 lg:py-6 pt-16 lg:pt-4",children:r?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3 min-h-0",children:n}),e.jsx("div",{className:"hidden lg:block lg:col-span-1",children:e.jsx("div",{className:"sticky top-6",children:e.jsx(xr,{className:"max-h-[calc(100vh-3rem)] overflow-y-auto"})})})]}):e.jsx("div",{className:"w-full max-w-7xl mx-auto",children:n})})})})]})})]})}export{Ir as M};
