const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ConsolidatedIndex.tsx-Br9mp9xD.js","js/chunk-V8Tq47hD.js","js/main-nj8_qmr1.js","js/chunk-7Gxbu0Lx.js","js/chunk-aOfXXddH.js","js/chunk-jOF7Mqj2.js","js/chunk-BbVfpXIH.js","js/chunk-HDUI5Ctd.js","js/chunk-BD2ShIYc.js","js/chunk-DkszvQuI.js","js/chunk-Cv5hKDJv.js","css/main-CIOjpg5z.css","js/ResponsiveLayout.tsx-CBMj4ano.js","js/AnimatedCard.tsx-cuCj4bgn.js","js/chunk-axyawUmi.js","js/chunk-BqqQDpKD.js","js/chunk-CJL1E-Mt.js","js/chunk-Dqojk3_S.js","js/chunk-B8PQiX0I.js","js/chunk-DJWri4GU.js","js/chunk-M09l3cRM.js","js/chunk-e6ItqUv0.js","js/ConsolidatedEvents.tsx-dLEXpVzZ.js","js/chunk-CfjvP89K.js","js/chunk-BJzCN5QX.js","js/chunk-B-6hVeMl.js","js/chunk-CHdjBz-i.js","js/chunk-Bz-NoICJ.js","js/EventDetails.tsx-CCUzxUKx.js","js/chunk-CNC7STIA.js","js/chunk-DiXj0jE4.js","js/chunk-Ch6abJed.js","js/chunk-YEhQLQCo.js","js/chunk-CgjdgoZs.js","js/CreateEvent.tsx-437Yc5Cd.js","js/chunk-DzbWDm6p.js","js/ConsolidatedCommunity.tsx-C0tY_UAn.js","js/ConsolidatedProfile.tsx-pmsgBe5i.js","js/chunk-mpNmbJ1v.js","js/chunk-BvELcnIN.js","js/chunk-DulDdbSN.js","js/chunk-DATMY4N7.js","js/EnhancedMessages.tsx-B89NUnYT.js","js/chunk-DG7cS-OT.js","js/NotificationsPage.tsx-D5ED-OOp.js","js/chunk-DeZlcMLt.js","js/chunk-CPfOm2rf.js","js/ConsolidatedSettings.tsx-jljEU_f5.js","js/About.tsx-DEUWelt2.js","js/Discover.tsx-B4h64Apf.js","js/chunk-DX5IT3-R.js","js/News.tsx-ihCiESQ0.js","js/chunk-Bwe9R7Wr.js","js/ConsolidatedFeed.tsx-CN7g5Eux.js","js/chunk-Bj_o6l4t.js","js/ConsolidatedDashboard.tsx-DCbqTq-F.js","js/SignIn.tsx-CFtnkbOe.js","js/SignUp.tsx-9adcikbR.js","js/ConsolidatedCommunityInsights.tsx-AfVnYdrY.js","js/LegalAssistant.tsx-ZzOj3EDE.js","js/chunk-DzHNM671.js","js/LifeWish.tsx-DKtfkpv2.js"])))=>i.map(i=>d[i]);
var W=Object.defineProperty;var G=(i,s,r)=>s in i?W(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r;var T=(i,s,r)=>G(i,typeof s!="symbol"?s+"":s,r);var c=(i,s,r)=>new Promise((o,u)=>{var p=_=>{try{n(r.next(_))}catch(g){u(g)}},v=_=>{try{n(r.throw(_))}catch(g){u(g)}},n=_=>_.done?o(_.value):Promise.resolve(_.value).then(p,v);n((r=r.apply(i,s)).next())});import{q as J,J as V,G as Y,I as l,E as d}from"./chunk-aOfXXddH.js";import{r as t,j as e}from"./chunk-V8Tq47hD.js";import{s as x,u as z,C as U,a as O,b as B,c as K,E as Q}from"./main-nj8_qmr1.js";import{L as X,b as Z,c as ee}from"./chunk-BD2ShIYc.js";const y=class y{static getInstance(){return y.instance||(y.instance=new y),y.instance}getUserRole(){return c(this,null,function*(){const{data:{user:s}}=yield x.auth.getUser();if(!s)return null;const{data:r,error:o}=yield x.from("roles").select("role").eq("user_id",s.id).single();return o?(console.error("Error fetching user role:",o),null):(r==null?void 0:r.role)||"user"})}isAdmin(){return c(this,null,function*(){const s=yield this.getUserRole();return s==="admin"||s==="super_admin"})}isSuperAdmin(){return c(this,null,function*(){return(yield this.getUserRole())==="super_admin"})}isModerator(){return c(this,null,function*(){const s=yield this.getUserRole();return s==="moderator"||s==="admin"||s==="super_admin"})}hasRole(s){return c(this,null,function*(){const r=yield this.getUserRole();if(!r)return!1;const o={user:0,moderator:1,admin:2,super_admin:3};return o[r]>=o[s]})}getAllUsersWithRoles(){return c(this,null,function*(){const{data:s,error:r}=yield x.from("admin_dashboard").select("*").order("role_created_at",{ascending:!1});if(r)throw r;return s||[]})}promoteUser(s,r){return c(this,null,function*(){const{data:o,error:u}=yield x.rpc("promote_user_to_admin",{target_user_id:s,new_role:r});if(u)throw u})}demoteUser(s){return c(this,null,function*(){const{data:r,error:o}=yield x.rpc("demote_user",{target_user_id:s});if(o)throw o})}getAuditLogs(s=50,r=0){return c(this,null,function*(){const{data:o,error:u}=yield x.from("audit_logs").select(`
        *,
        admin_user:admin_user_id (
          email,
          profiles (
            display_name,
            avatar_url
          )
        )
      `).order("created_at",{ascending:!1}).range(r,r+s-1);if(u)throw u;return o||[]})}logAdminAction(s,r,o,u){return c(this,null,function*(){const{error:p}=yield x.rpc("log_admin_action",{action_type:s,target_type:r,target_uuid:o,action_details:u,client_ip:null,client_user_agent:null});p&&console.error("Error logging admin action:",p)})}canEditEvent(s){return c(this,null,function*(){const{data:{user:r}}=yield x.auth.getUser();return r?r.id===s?!0:yield this.isAdmin():!1})}canDeleteEvent(s){return c(this,null,function*(){return yield this.canEditEvent(s)})}canFeatureEvent(){return c(this,null,function*(){return yield this.isAdmin()})}canModerateContent(){return c(this,null,function*(){return yield this.isModerator()})}canAccessAdminPanel(){return c(this,null,function*(){return yield this.isAdmin()})}canManageUsers(){return c(this,null,function*(){return yield this.isSuperAdmin()})}getRoleDisplayName(s){return{user:"User",moderator:"Moderator",admin:"Administrator",super_admin:"Super Administrator"}[s]}getRoleColor(s){return{user:"gray",moderator:"blue",admin:"green",super_admin:"purple"}[s]}getRoleDescription(s){return{user:"Regular user with basic permissions",moderator:"Can moderate content and manage community",admin:"Can manage events, users, and platform settings",super_admin:"Full platform access including user management"}[s]}getRolePermissions(s){return{user:["create_events","edit_own_events","delete_own_events","create_posts","comment_on_posts","like_content","use_legal_assistant","create_life_wishes"],moderator:["all_user_permissions","moderate_content","delete_any_posts","ban_users","manage_reports"],admin:["all_moderator_permissions","feature_events","manage_events","access_admin_panel","view_analytics","manage_platform_settings"],super_admin:["all_admin_permissions","manage_users","promote_users","demote_users","view_audit_logs","full_platform_control"]}[s]}};T(y,"instance");let L=y;L.getInstance();const se={getUserPlanInfo(i){return c(this,null,function*(){return{is_premium:!1,plan_type:"free",can_create_services:!1,can_feature_events:!1,features:[]}})}};function M(i){return{user:{canCreatePosts:!0,canEditPosts:!1,canDeletePosts:!1,canModerateContent:!1,canManageUsers:!1,canAccessAnalytics:!1,canManageSettings:!1,canAccessAdminPanel:!1},artist:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!1,canModerateContent:!1,canManageUsers:!1,canAccessAnalytics:!1,canManageSettings:!1,canAccessAdminPanel:!1},moderator:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!0,canModerateContent:!0,canManageUsers:!1,canAccessAnalytics:!0,canManageSettings:!1,canAccessAdminPanel:!1},admin:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!0,canModerateContent:!0,canManageUsers:!0,canAccessAnalytics:!0,canManageSettings:!0,canAccessAdminPanel:!0},super_admin:{canCreatePosts:!0,canEditPosts:!0,canDeletePosts:!0,canModerateContent:!0,canManageUsers:!0,canAccessAnalytics:!0,canManageSettings:!0,canAccessAdminPanel:!0}}[i]}function te(){const{user:i}=z(),[s,r]=t.useState({hasRole:!1,role:null,permissions:M("user")}),[o,u]=t.useState(!0),[p,v]=t.useState(null),[n,_]=t.useState(null),[g,w]=t.useState(!0),[q,I]=t.useState(null),P=t.useCallback(()=>c(null,null,function*(){if(!i){r({hasRole:!1,role:null,permissions:M("user")}),u(!1);return}try{u(!0),v(null);const a=yield L.checkUserRole(i.id);r(a)}catch(a){v(a instanceof Error?a.message:"Failed to fetch role"),r({hasRole:!1,role:null,permissions:M("user")})}finally{u(!1)}}),[i]),A=t.useCallback(()=>c(null,null,function*(){if(!i){_(null),w(!1);return}try{w(!0),I(null);const a=yield se.getUserPlanInfo(i.id);_(a)}catch(a){console.error("Error loading user plan info:",a),I(a instanceof Error?a.message:"Failed to load plan information")}finally{w(!1)}}),[i]);t.useEffect(()=>{P(),A()},[P,A]);const j=s.role==="admin"||s.role==="super_admin",E=s.role==="super_admin",N=s.role==="moderator"||j,R=(n==null?void 0:n.is_premium)||!1,S=t.useMemo(()=>({canCreateServices:(n==null?void 0:n.can_create_services)||!1,canFeatureEvents:(n==null?void 0:n.can_feature_events)||!1,canAccessAnalytics:(n==null?void 0:n.is_premium)||!1,canModerateContent:N,canManageUsers:j,canAccessAPI:(n==null?void 0:n.is_premium)||!1,canCreatePolls:(n==null?void 0:n.is_premium)||!1,canAccessVoiceControl:(n==null?void 0:n.is_premium)||!1}),[n,N,j]),C=t.useCallback(a=>{if(!s.hasRole)return!1;const m={user:0,artist:1,moderator:2,admin:3,super_admin:4},h=m[s.role||"user"],b=m[a];return h>=b},[s]),k=t.useCallback(a=>s.permissions[a]||!1,[s.permissions]),D=t.useCallback(a=>S[a]||!1,[S]),F=t.useCallback(a=>{if(o||g)return{hasAccess:!1,loading:!0};if(!i)return{hasAccess:!1,loading:!1,reason:"Not authenticated"};const m=[],h=[];if(a.requiredRole){const f=C(a.requiredRole);m.push(f),f||h.push(`Requires ${a.requiredRole} role`)}if(a.requiredPermission){const f=k(a.requiredPermission);m.push(f),f||h.push(`Requires ${a.requiredPermission} permission`)}if(a.requiredProPermission){const f=D(a.requiredProPermission);m.push(f),f||h.push(`Requires ${a.requiredProPermission} pro permission`)}a.requireAdmin&&(m.push(j),j||h.push("Requires admin access")),a.requireSuperAdmin&&(m.push(E),E||h.push("Requires super admin access")),a.requirePro&&(m.push(R),R||h.push("Requires pro subscription"));const b=m.length===0?!0:a.requireAny?m.some(f=>f):m.every(f=>f);return{hasAccess:b,loading:!1,reason:b?void 0:h.join(", ")}},[o,g,i,C,k,D,j,E,R]),$=t.useCallback(()=>c(null,null,function*(){yield Promise.all([P(),A()])}),[P,A]),H=t.useCallback(()=>c(null,null,function*(){yield A()}),[A]);return{role:s.role,hasRole:s.hasRole,permissions:s.permissions,loading:o||g,error:p||q,isAdmin:j,isSuperAdmin:E,isModerator:N,proPermissions:S,isPro:R,planInfo:n,hasRequiredRole:C,hasPermission:k,hasProPermission:D,checkAccess:F,refetch:$,refreshPlanInfo:H}}function re(){const{isAdmin:i,loading:s}=te();return{isAdmin:i,loading:s}}const ae=({children:i,requireSuperAdmin:s=!1})=>{const{user:r,loading:o}=z(),{isAdmin:u,loading:p}=re(),v=J();return o||p?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(U,{className:"w-full max-w-md mx-4",children:e.jsxs(O,{className:"text-center py-8",children:[e.jsx(X,{className:"animate-spin h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Verifying admin access..."})]})})}):r?u?e.jsx(e.Fragment,{children:i}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs(U,{className:"w-full max-w-md mx-4",children:[e.jsxs(B,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Z,{className:"w-6 h-6 text-red-600"})}),e.jsx(K,{className:"text-xl font-semibold text-gray-900",children:"Administrator Access Required"})]}),e.jsx(O,{className:"text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"This page requires administrator privileges to access. You do not have sufficient permissions to view this content."}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Admin or Super Admin role required"})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-400",children:"If you believe this is an error, please contact your system administrator."})})]})})]})}):e.jsx(V,{to:"/signin",state:{from:v},replace:!0})},ne=t.lazy(()=>d(()=>import("./ConsolidatedIndex.tsx-Br9mp9xD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),ie=t.lazy(()=>d(()=>import("./ConsolidatedEvents.tsx-dLEXpVzZ.js"),__vite__mapDeps([22,1,12,2,3,4,5,6,7,8,9,10,11,23,15,16,17,24,25,26,18,19,20,21,27,14]))),ce=t.lazy(()=>d(()=>import("./EventDetails.tsx-CCUzxUKx.js"),__vite__mapDeps([28,1,12,2,3,4,5,6,7,8,9,10,11,15,16,29,25,26,30,31,18,19,20,32,33]))),oe=t.lazy(()=>d(()=>import("./CreateEvent.tsx-437Yc5Cd.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,23,31,30,24,12,18,19,20,15,35]))),le=t.lazy(()=>d(()=>import("./ConsolidatedCommunity.tsx-C0tY_UAn.js"),__vite__mapDeps([36,1,12,2,3,4,5,6,7,8,9,10,11,23,15,16,17,24,25,26,30,31,19,20]))),de=t.lazy(()=>d(()=>import("./ConsolidatedProfile.tsx-pmsgBe5i.js"),__vite__mapDeps([37,1,12,2,3,4,5,6,7,8,9,10,11,15,17,16,38,25,26,30,23,31,39,40,18,19,20,21,27,41,14]))),ue=t.lazy(()=>d(()=>import("./EnhancedMessages.tsx-B89NUnYT.js"),__vite__mapDeps([42,1,12,2,3,4,5,6,7,8,9,10,11,15,16,23,17,43]))),me=t.lazy(()=>d(()=>import("./NotificationsPage.tsx-D5ED-OOp.js"),__vite__mapDeps([44,1,2,3,4,5,6,7,8,9,10,11,15,23,17,33,45,26,46,14]))),fe=t.lazy(()=>d(()=>import("./ConsolidatedSettings.tsx-jljEU_f5.js"),__vite__mapDeps([47,1,12,2,3,4,5,6,7,8,9,10,11,23,31,30,16,40,15,32,14]))),_e=t.lazy(()=>d(()=>import("./About.tsx-DEUWelt2.js"),__vite__mapDeps([48,1,12,2,3,4,5,6,7,8,9,10,11,15]))),he=t.lazy(()=>d(()=>import("./Discover.tsx-B4h64Apf.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,10,11,15,17,12,19,20,23,50,24,31,16,33]))),pe=t.lazy(()=>d(()=>import("./News.tsx-ihCiESQ0.js"),__vite__mapDeps([51,1,12,17,7,3,4,5,2,6,8,9,10,11,23,52,35,15,16,14,25,26,31,38,30,32,24,50]))),xe=t.lazy(()=>d(()=>import("./ConsolidatedFeed.tsx-CN7g5Eux.js"),__vite__mapDeps([53,1,12,6,3,4,5,2,7,8,9,10,11,16,54,26,15,35,20,45,33,17,46,23,14,21,18,19,41,27]))),ge=t.lazy(()=>d(()=>import("./ConsolidatedDashboard.tsx-DCbqTq-F.js"),__vite__mapDeps([55,1,12,2,3,4,5,6,7,8,9,10,11,15,29,33,25,26,43,39,16,17,38]))),je=t.lazy(()=>d(()=>import("./SignIn.tsx-CFtnkbOe.js"),__vite__mapDeps([56,1,2,3,4,5,6,7,8,9,10,11,23,31,17,29,12,30,24]))),ye=t.lazy(()=>d(()=>import("./SignUp.tsx-9adcikbR.js"),__vite__mapDeps([57,1,6,3,4,5,2,7,8,9,10,11,23,31]))),ve=t.lazy(()=>d(()=>import("./ConsolidatedCommunityInsights.tsx-AfVnYdrY.js"),__vite__mapDeps([58,1,2,3,4,5,6,7,8,9,10,11,15,17]))),Ae=t.lazy(()=>d(()=>import("./LegalAssistant.tsx-ZzOj3EDE.js"),__vite__mapDeps([59,1,60,6,3,4,5,2,7,8,9,10,11,15,16,45,26,54,35,20,23,29,52,14,17,30,24]))),Pe=t.lazy(()=>d(()=>import("./LifeWish.tsx-DKtfkpv2.js"),__vite__mapDeps([61,1,60,6,3,4,5,2,7,8,9,10,11,15,16,45,26,54,35,20,23,29,52,14,17,30,24]))),Ee=()=>e.jsxs(Y,{children:[e.jsx(l,{path:"/",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(ne,{})})}),e.jsx(l,{path:"/feed",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading feed..."}),children:e.jsx(xe,{})})}),e.jsx(l,{path:"/dashboard",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading dashboard..."}),children:e.jsx(ge,{})})}),e.jsx(l,{path:"/events",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading events..."}),children:e.jsx(ie,{})})}),e.jsx(l,{path:"/event/:eventId",element:e.jsx(Q,{children:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading event..."}),children:e.jsx(ce,{})})})}),e.jsx(l,{path:"/create-event",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(oe,{})})}),e.jsx(l,{path:"/community",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading community..."}),children:e.jsx(le,{})})}),e.jsx(l,{path:"/profile/:userId?",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading profile..."}),children:e.jsx(de,{})})}),e.jsx(l,{path:"/messages",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading messages..."}),children:e.jsx(ue,{})})}),e.jsx(l,{path:"/notifications",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading notifications..."}),children:e.jsx(me,{})})}),e.jsx(l,{path:"/settings",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading settings..."}),children:e.jsx(fe,{})})}),e.jsx(l,{path:"/discover",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading discover..."}),children:e.jsx(he,{})})}),e.jsx(l,{path:"/news",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading news..."}),children:e.jsx(pe,{})})}),e.jsx(l,{path:"/signin",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(je,{})})}),e.jsx(l,{path:"/signup",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:e.jsx(ye,{})})}),e.jsx(l,{path:"/about",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading about..."}),children:e.jsx(_e,{})})}),e.jsx(l,{path:"/legal-assistant",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading legal assistant..."}),children:e.jsx(Ae,{})})}),e.jsx(l,{path:"/life-wish",element:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading life wishes..."}),children:e.jsx(Pe,{})})}),e.jsx(l,{path:"/community-insights",element:e.jsx(ae,{children:e.jsx(t.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading community insights..."}),children:e.jsx(ve,{})})})}),e.jsx(l,{path:"*",element:e.jsx(V,{to:"/",replace:!0})})]}),Se=Object.freeze(Object.defineProperty({__proto__:null,AppRoutes:Ee},Symbol.toStringTag,{value:"Module"}));export{Se as A,re as u};
