var C=Object.defineProperty;var S=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var m=(r,o,t)=>o in r?C(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t,a=(r,o)=>{for(var t in o||(o={}))A.call(o,t)&&m(r,t,o[t]);if(S)for(var t of S(o))F.call(o,t)&&m(r,t,o[t]);return r};var u=(r,o,t)=>new Promise((P,c)=>{var h=i=>{try{d(t.next(i))}catch(g){c(g)}},f=i=>{try{d(t.throw(i))}catch(g){c(g)}},d=i=>i.done?P(i.value):Promise.resolve(i.value).then(h,f);d((t=t.apply(r,o)).next())});import{r as l}from"./chunk-V8Tq47hD.js";import{u as D,U as p}from"./main-nj8_qmr1.js";const R=()=>{const{user:r}=D(),[o,t]=l.useState(null),[P,c]=l.useState(null),[h,f]=l.useState(null),[d,i]=l.useState(!0),[g,y]=l.useState(null),E=l.useCallback(()=>u(null,null,function*(){if(!(r!=null&&r.id)){t(null),c(null),f(null),i(!1);return}try{i(!0),y(null);const[s,e]=yield Promise.all([p.getUserProfile(r.id),p.getUserSettings(r.id)]);if(s.error)throw new Error(s.error);e.error&&console.warn("Error fetching settings:",e.error),t(s.profile),c(s.artistProfile||null),f(e.settings||null)}catch(s){console.error("Error fetching user profile:",s),y(s instanceof Error?s.message:"Failed to fetch user profile")}finally{i(!1)}}),[r==null?void 0:r.id]);l.useEffect(()=>{E()},[E]);const w=l.useCallback(s=>u(null,null,function*(){if(!(r!=null&&r.id))return{success:!1,error:"No user ID"};try{const e=yield p.updateUserProfile(r.id,s);return e.success&&t(n=>n?a(a({},n),s):null),e}catch(e){return console.error("Error updating profile:",e),{success:!1,error:e instanceof Error?e.message:"Failed to update profile"}}}),[r==null?void 0:r.id]),U=l.useCallback(s=>u(null,null,function*(){if(!(r!=null&&r.id))return{success:!1,error:"No user ID"};try{const e=yield p.updateArtistProfile(r.id,s);return e.success&&c(n=>n?a(a({},n),s):null),e}catch(e){return console.error("Error updating artist profile:",e),{success:!1,error:e instanceof Error?e.message:"Failed to update artist profile"}}}),[r==null?void 0:r.id]),b=l.useCallback(s=>u(null,null,function*(){if(!(r!=null&&r.id))return{success:!1,error:"No user ID"};try{const e=yield p.updateUserSettings(r.id,s);return e.success&&f(n=>n?a(a({},n),s):null),e}catch(e){return console.error("Error updating settings:",e),{success:!1,error:e instanceof Error?e.message:"Failed to update settings"}}}),[r==null?void 0:r.id]),k=l.useCallback(()=>u(null,null,function*(){yield E()}),[E]);return{profile:o,artistProfile:P,settings:h,loading:d,error:g,updateProfile:w,updateArtistProfile:U,updateSettings:b,refreshProfile:k}};export{R as u};
