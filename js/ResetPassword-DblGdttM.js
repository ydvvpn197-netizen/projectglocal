var f=(d,o,n)=>new Promise((m,h)=>{var c=e=>{try{t(n.next(e))}catch(i){h(i)}},u=e=>{try{t(n.throw(e))}catch(i){h(i)}},t=e=>e.done?m(e.value):Promise.resolve(e.value).then(c,u);t((n=n.apply(d,o)).next())});import{w as z,r,u as I,f as R,j as s,C as j,p as g,q as N,t as v,v as y,B as l}from"./main-jfCIwKxb.js";import{I as P}from"./index-DGobKVbi.js";import{L as b}from"./label-BhjyL16S.js";import{U as C}from"./UniformHeader-Bapf2pDd.js";import{L as D}from"./lock-rlvFoI-t.js";import{A as F}from"./arrow-left-BUiGB43w.js";import{E as S}from"./eye-off-BZA63c1R.js";import{E as k}from"./eye-CYa_iGA4.js";import"./useLocationManager-FvdWdASY.js";import"./locationService-D_4XBFWa.js";import"./databaseUtils-Cc-GydU0.js";import"./badge-Cxniq3nT.js";import"./index-CaL9moq2.js";import"./scroll-area-Bsyy6uVd.js";import"./index-DCmZQWeX.js";import"./tabs-Bho2AISw.js";import"./check-CWeqS_MX.js";import"./useNotifications-DlynYvan.js";import"./notificationService-DPR46Nx3.js";import"./bell-CXNc_0l5.js";import"./user-cZSM4iEh.js";import"./search-DIpOLffQ.js";import"./map-pin-B5hnRU36.js";import"./log-out-CxjypOOW.js";const ds=()=>{const[d]=z(),[o,n]=r.useState(""),[m,h]=r.useState(""),[c,u]=r.useState(!1),[t,e]=r.useState(!1),[i,x]=r.useState(!1),[E,L]=r.useState(!1),[B,A]=r.useState(""),{resetPassword:U}=I(),p=R();r.useEffect(()=>{const a=d.get("token");a?A(a):p("/forgot-password")},[d,p]);const q=a=>f(void 0,null,function*(){if(a.preventDefault(),o!==m){alert("Passwords do not match");return}if(o.length<6){alert("Password must be at least 6 characters long");return}x(!0);try{const{error:w}=yield U(B,o);w||L(!0)}catch(w){console.error("Password reset error:",w)}finally{x(!1)}});return E?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5",children:[s.jsx(C,{showAuthButtons:!1,showLocationButton:!1}),s.jsx("div",{className:"flex items-center justify-center p-4 pt-12",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs(j,{children:[s.jsxs(g,{className:"space-y-1 text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(D,{className:"h-6 w-6 text-green-600"})}),s.jsx(N,{className:"text-2xl",children:"Password Updated"}),s.jsx(v,{children:"Your password has been successfully updated. You can now sign in with your new password."})]}),s.jsx(y,{children:s.jsx(l,{onClick:()=>p("/signin"),className:"w-full",children:"Sign In"})})]})})})]}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5",children:[s.jsx(C,{showAuthButtons:!1,showLocationButton:!1}),s.jsx("div",{className:"flex items-center justify-center p-4 pt-12",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs(j,{children:[s.jsxs(g,{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(l,{variant:"ghost",size:"sm",onClick:()=>p("/forgot-password"),className:"p-0 h-auto",children:s.jsx(F,{className:"h-4 w-4"})}),s.jsx(N,{className:"text-2xl",children:"Reset Password"})]}),s.jsx(v,{children:"Enter your new password below."})]}),s.jsx(y,{children:s.jsxs("form",{onSubmit:q,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{htmlFor:"password",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(P,{id:"password",type:c?"text":"password",placeholder:"Enter your new password",value:o,onChange:a=>n(a.target.value),required:!0}),s.jsx(l,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>u(!c),children:c?s.jsx(S,{className:"h-4 w-4"}):s.jsx(k,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{htmlFor:"confirmPassword",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(P,{id:"confirmPassword",type:t?"text":"password",placeholder:"Confirm your new password",value:m,onChange:a=>h(a.target.value),required:!0}),s.jsx(l,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>e(!t),children:t?s.jsx(S,{className:"h-4 w-4"}):s.jsx(k,{className:"h-4 w-4"})})]})]}),s.jsx(l,{type:"submit",className:"w-full",disabled:i,children:i?"Updating...":"Update Password"})]})})]})})})]})};export{ds as default};
