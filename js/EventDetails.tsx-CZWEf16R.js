var Ve=Object.defineProperty,Ge=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var je=Object.getOwnPropertySymbols;var He=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var ke=(v,t,s)=>t in v?Ve(v,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):v[t]=s,J=(v,t)=>{for(var s in t||(t={}))He.call(t,s)&&ke(v,s,t[s]);if(je)for(var s of je(t))Ke.call(t,s)&&ke(v,s,t[s]);return v},X=(v,t)=>Ge(v,We(t));var m=(v,t,s)=>new Promise((a,c)=>{var n=l=>{try{r(s.next(l))}catch(k){c(k)}},u=l=>{try{r(s.throw(l))}catch(k){c(k)}},r=l=>l.done?a(l.value):Promise.resolve(l.value).then(n,u);r((s=s.apply(v,t)).next())});import{r as h,j as e,a9 as we,aa as xe,ab as Je,w as ge,ac as Xe,ad as Qe,ae as Ze,X as es,x as Z,af as ss,n as ts,ag as Ne,o as ye,a6 as be,M as Ee,z as rs,q as Ce,U as Se,ah as as,ai as ze,y as oe,aj as qe,ak as ns,al as is,am as os,an as cs,a8 as ls}from"./chunk-COTa-BBv.js";import{ResponsiveLayout as ce}from"./ResponsiveLayout.tsx-wqK2pe-W.js";import{a as fe,u as ve,C as y,c as $,d as T,b,B as x,f as ds}from"./main-BMj1NFFE.js";import{B as ee}from"./chunk-BCSLz2CJ.js";import{A as se,a as te,b as re}from"./chunk-mExNus9E.js";import{S as us}from"./chunk-CKr6gYyv.js";import{D as le,a as de,b as ue,c as me,d as he}from"./chunk-DAuIGAgW.js";import{T as W}from"./chunk-egW852rZ.js";import{L as ae}from"./chunk-UbFD0_dp.js";import{u as ms}from"./chunk-BHNn8WBs.js";import{S as Ue}from"./chunk-qg8sq3rE.js";import{s as o}from"./chunk-CasIWBEQ.js";import{f as Be,a as hs}from"./chunk-DJzzOJWe.js";import{S as xs}from"./chunk-D-G76ObT.js";import"./chunk-DvlvDbdf.js";import"./chunk-BlluHz2J.js";import"./chunk-BA32w1ww.js";import"./chunk-DYZWJdwa.js";import"./chunk-DmQrF9DI.js";import"./chunk-C4jjqBrH.js";class G{static fetchEventDiscussions(t){return m(this,null,function*(){try{const{data:s,error:a}=yield o.from("event_discussions").select(`
          *,
          profiles!event_discussions_user_id_fkey(display_name, avatar_url),
          discussion_likes!left(user_id)
        `).eq("event_id",t).is("parent_id",null).order("created_at",{ascending:!1});if(a)throw a;const c=(s||[]).map(n=>{var u,r,l;return{id:n.id,event_id:n.event_id,user_id:n.user_id,content:n.content,parent_id:n.parent_id,likes_count:n.likes_count||0,is_anonymous:n.is_anonymous,created_at:n.created_at,updated_at:n.updated_at,author_name:n.is_anonymous?"Anonymous":(u=n.profiles)==null?void 0:u.display_name,author_avatar:n.is_anonymous?null:(r=n.profiles)==null?void 0:r.avatar_url,user_liked:((l=n.discussion_likes)==null?void 0:l.length)>0}});for(const n of c){const{data:u,error:r}=yield o.from("event_discussions").select(`
            *,
            profiles!event_discussions_user_id_fkey(display_name, avatar_url),
            discussion_likes!left(user_id)
          `).eq("parent_id",n.id).order("created_at",{ascending:!0});!r&&u&&(n.replies=u.map(l=>{var k,w,E;return{id:l.id,event_id:l.event_id,user_id:l.user_id,content:l.content,parent_id:l.parent_id,likes_count:l.likes_count||0,is_anonymous:l.is_anonymous,created_at:l.created_at,updated_at:l.updated_at,author_name:l.is_anonymous?"Anonymous":(k=l.profiles)==null?void 0:k.display_name,author_avatar:l.is_anonymous?null:(w=l.profiles)==null?void 0:w.avatar_url,user_liked:((E=l.discussion_likes)==null?void 0:E.length)>0}}))}return{discussions:c,error:null}}catch(s){return console.error("Error fetching event discussions:",s),{discussions:[],error:s instanceof Error?s.message:"Unknown error"}}})}static createDiscussion(t){return m(this,null,function*(){try{const{data:s,error:a}=yield o.from("event_discussions").insert({event_id:t.event_id,content:t.content,parent_id:t.parent_id||null,is_anonymous:t.is_anonymous||!1}).select().single();if(a)throw a;return{success:!0,discussionId:s.id}}catch(s){return console.error("Error creating discussion:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}})}static toggleDiscussionLike(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{success:!1,error:"Not authenticated"};const{data:a}=yield o.from("discussion_likes").select("id").eq("discussion_id",t).eq("user_id",s.id).single();if(a){const{error:c}=yield o.from("discussion_likes").delete().eq("discussion_id",t).eq("user_id",s.id);if(c)throw c;const{error:n}=yield o.from("event_discussions").update({likes_count:o.raw("likes_count - 1")}).eq("id",t);if(n)throw n}else{const{error:c}=yield o.from("discussion_likes").insert({discussion_id:t,user_id:s.id});if(c)throw c;const{error:n}=yield o.from("event_discussions").update({likes_count:o.raw("likes_count + 1")}).eq("id",t);if(n)throw n}return{success:!0}}catch(s){return console.error("Error toggling discussion like:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}})}static deleteDiscussion(t){return m(this,null,function*(){try{const{error:s}=yield o.from("event_discussions").delete().eq("id",t);if(s)throw s;return{success:!0}}catch(s){return console.error("Error deleting discussion:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}})}static updateDiscussion(t,s){return m(this,null,function*(){try{const{error:a}=yield o.from("event_discussions").update({content:s,updated_at:new Date().toISOString()}).eq("id",t);if(a)throw a;return{success:!0}}catch(a){return console.error("Error updating discussion:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}})}static getEventDiscussionStats(t){return m(this,null,function*(){try{const{data:s,error:a}=yield o.from("event_discussions").select("id, likes_count, created_at").eq("event_id",t);if(a)throw a;return{stats:{total_discussions:s.length,total_likes:s.reduce((n,u)=>n+(u.likes_count||0),0),recent_discussions:s.filter(n=>{const u=new Date(n.created_at),r=new Date(Date.now()-1440*60*1e3);return u>r}).length},error:null}}catch(s){return console.error("Error getting discussion stats:",s),{stats:null,error:s instanceof Error?s.message:"Unknown error"}}})}}const gs=({eventId:v,className:t=""})=>{const{user:s}=fe(),{toast:a}=ve(),[c,n]=h.useState([]),[u,r]=h.useState(!1),[l,k]=h.useState(!1),[w,E]=h.useState(""),[C,q]=h.useState(!1),[L,F]=h.useState(null),[S,j]=h.useState(""),[D,U]=h.useState(null),[B,A]=h.useState(""),z=h.useCallback(()=>m(null,null,function*(){try{r(!0);const{discussions:i,error:g}=yield G.fetchEventDiscussions(v);if(g){a({title:"Error",description:g,variant:"destructive"});return}n(i)}catch(i){console.error("Error fetching discussions:",i),a({title:"Error",description:"Failed to load discussions.",variant:"destructive"})}finally{r(!1)}}),[v,a]);h.useEffect(()=>{z()},[z]);const M=()=>m(null,null,function*(){if(!s){a({title:"Login Required",description:"Please sign in to participate in discussions.",variant:"destructive"});return}if(!w.trim()){a({title:"Error",description:"Please enter a message.",variant:"destructive"});return}try{k(!0);const i={event_id:v,content:w.trim(),is_anonymous:C},g=yield G.createDiscussion(i);g.success?(a({title:"Success",description:"Discussion posted successfully!"}),E(""),q(!1),z()):a({title:"Error",description:g.error||"Failed to post discussion.",variant:"destructive"})}catch(i){console.error("Error submitting discussion:",i),a({title:"Error",description:"Failed to post discussion.",variant:"destructive"})}finally{k(!1)}}),O=i=>m(null,null,function*(){if(!s){a({title:"Login Required",description:"Please sign in to reply to discussions.",variant:"destructive"});return}if(!S.trim()){a({title:"Error",description:"Please enter a reply.",variant:"destructive"});return}try{k(!0);const g={event_id:v,content:S.trim(),parent_id:i,is_anonymous:C},Y=yield G.createDiscussion(g);Y.success?(a({title:"Success",description:"Reply posted successfully!"}),j(""),F(null),z()):a({title:"Error",description:Y.error||"Failed to post reply.",variant:"destructive"})}catch(g){console.error("Error submitting reply:",g),a({title:"Error",description:"Failed to post reply.",variant:"destructive"})}finally{k(!1)}}),I=i=>m(null,null,function*(){if(!s){a({title:"Login Required",description:"Please sign in to like discussions.",variant:"destructive"});return}try{const g=yield G.toggleDiscussionLike(i);g.success?z():a({title:"Error",description:g.error||"Failed to like discussion.",variant:"destructive"})}catch(g){console.error("Error liking discussion:",g),a({title:"Error",description:"Failed to like discussion.",variant:"destructive"})}}),d=i=>m(null,null,function*(){if(!B.trim()){a({title:"Error",description:"Please enter content to edit.",variant:"destructive"});return}try{const g=yield G.updateDiscussion(i,B.trim());g.success?(a({title:"Success",description:"Discussion updated successfully!"}),U(null),A(""),z()):a({title:"Error",description:g.error||"Failed to update discussion.",variant:"destructive"})}catch(g){console.error("Error updating discussion:",g),a({title:"Error",description:"Failed to update discussion.",variant:"destructive"})}}),_=i=>m(null,null,function*(){if(confirm("Are you sure you want to delete this discussion?"))try{const g=yield G.deleteDiscussion(i);g.success?(a({title:"Success",description:"Discussion deleted successfully!"}),z()):a({title:"Error",description:g.error||"Failed to delete discussion.",variant:"destructive"})}catch(g){console.error("Error deleting discussion:",g),a({title:"Error",description:"Failed to delete discussion.",variant:"destructive"})}}),N=({discussion:i,isReply:g=!1})=>{var Y;return e.jsxs("div",{className:`${g?"ml-8 border-l-2 border-muted pl-4":""}`,children:[e.jsx(y,{className:"mb-4",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(se,{className:"h-8 w-8",children:[e.jsx(te,{src:i.author_avatar}),e.jsx(re,{children:i.is_anonymous?"A":((Y=i.author_name)==null?void 0:Y[0])||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium text-sm",children:i.is_anonymous?"Anonymous":i.author_name}),i.is_anonymous&&e.jsxs(ee,{variant:"secondary",className:"text-xs",children:[e.jsx(Je,{className:"h-3 w-3 mr-1"}),"Anonymous"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Be(new Date(i.created_at),{addSuffix:!0})})]}),D===i.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{value:B,onChange:P=>A(P.target.value),placeholder:"Edit your discussion...",className:"min-h-[80px]"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{size:"sm",onClick:()=>d(i.id),children:"Save"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>{U(null),A("")},children:"Cancel"})]})]}):e.jsx("p",{className:"text-sm text-foreground mb-3",children:i.content}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>I(i.id),className:`flex items-center gap-1 ${i.user_liked?"text-red-500":""}`,children:[e.jsx(ge,{className:`h-4 w-4 ${i.user_liked?"fill-current":""}`}),e.jsx("span",{children:i.likes_count})]}),!g&&e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>{F(i.id),j("")},className:"flex items-center gap-1",children:[e.jsx(Xe,{className:"h-4 w-4"}),"Reply"]}),(s==null?void 0:s.id)===i.user_id&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>{U(i.id),A(i.content)},children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>_(i.id),className:"text-destructive hover:text-destructive",children:e.jsx(Ze,{className:"h-4 w-4"})})]})]})]})]})})}),L===i.id&&e.jsx(y,{className:"mb-4 ml-8",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(W,{value:S,onChange:P=>j(P.target.value),placeholder:"Write a reply...",className:"min-h-[80px]"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{id:"anonymous-reply",checked:C,onCheckedChange:q}),e.jsx(ae,{htmlFor:"anonymous-reply",className:"text-sm",children:"Post anonymously"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>{F(null),j("")},children:"Cancel"}),e.jsxs(x,{size:"sm",onClick:()=>O(i.id),disabled:l,children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Reply"]})]})]})]})})}),i.replies&&i.replies.length>0&&e.jsx("div",{className:"space-y-2",children:i.replies.map(P=>e.jsx(N,{discussion:P,isReply:!0},P.id))})]})};return e.jsx("div",{className:t,children:e.jsxs(y,{children:[e.jsx($,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"Event Discussions (",c.length,")"]})}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(W,{value:w,onChange:i=>E(i.target.value),placeholder:"Share your thoughts about this event...",className:"min-h-[100px]"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{id:"anonymous",checked:C,onCheckedChange:q}),e.jsx(ae,{htmlFor:"anonymous",className:"text-sm",children:"Post anonymously"})]}),e.jsxs(x,{onClick:M,disabled:l||!w.trim(),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),l?"Posting...":"Post Discussion"]})]})]}),u?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((i,g)=>e.jsx(y,{className:"animate-pulse",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-muted rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-full"}),e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"})]})]})})},g))}):c.length>0?e.jsx("div",{className:"space-y-4",children:c.map(i=>e.jsx(N,{discussion:i},i.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(we,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Discussions Yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Be the first to start a discussion about this event!"})]})]})]})})};class Q{static getOrCreateChat(t,s){return m(this,null,function*(){try{const{data:{user:a}}=yield o.auth.getUser();if(!a)return{chat:null,error:"Not authenticated"};const{data:c,error:n}=yield o.from("event_organizer_chat").select(`
          *,
          event:events(id, title, image_url),
          attendee:profiles!event_organizer_chat_attendee_id_fkey(id, display_name, avatar_url),
          organizer:profiles!event_organizer_chat_organizer_id_fkey(id, display_name, avatar_url)
        `).eq("event_id",t).eq("attendee_id",a.id).eq("organizer_id",s).single();if(c&&!n){const{count:l}=yield o.from("event_organizer_messages").select("*",{count:"exact",head:!0}).eq("chat_id",c.id).eq("is_read",!1).neq("sender_id",a.id);return{chat:X(J({},c),{unread_count:l||0}),error:null}}const{data:u,error:r}=yield o.from("event_organizer_chat").insert({event_id:t,attendee_id:a.id,organizer_id:s}).select(`
          *,
          event:events(id, title, image_url),
          attendee:profiles!event_organizer_chat_attendee_id_fkey(id, display_name, avatar_url),
          organizer:profiles!event_organizer_chat_organizer_id_fkey(id, display_name, avatar_url)
        `).single();if(r)throw r;return{chat:X(J({},u),{unread_count:0}),error:null}}catch(a){return console.error("Error getting or creating chat:",a),{chat:null,error:a instanceof Error?a.message:"Unknown error"}}})}static getUserChats(){return m(this,null,function*(){try{const{data:{user:t}}=yield o.auth.getUser();if(!t)return{chats:[],error:"Not authenticated"};const{data:s,error:a}=yield o.from("event_organizer_chat").select(`
          *,
          event:events(id, title, image_url),
          attendee:profiles!event_organizer_chat_attendee_id_fkey(id, display_name, avatar_url),
          organizer:profiles!event_organizer_chat_organizer_id_fkey(id, display_name, avatar_url)
        `).or(`attendee_id.eq.${t.id},organizer_id.eq.${t.id}`).order("last_message_at",{ascending:!1,nullsFirst:!1});if(a)throw a;return{chats:yield Promise.all((s||[]).map(n=>m(null,null,function*(){const{count:u}=yield o.from("event_organizer_messages").select("*",{count:"exact",head:!0}).eq("chat_id",n.id).eq("is_read",!1).neq("sender_id",t.id);return X(J({},n),{unread_count:u||0})}))),error:null}}catch(t){return console.error("Error getting user chats:",t),{chats:[],error:t instanceof Error?t.message:"Unknown error"}}})}static getChatMessages(t){return m(this,null,function*(){try{const{data:s,error:a}=yield o.from("event_organizer_messages").select(`
          *,
          sender:profiles!event_organizer_messages_sender_id_fkey(id, display_name, avatar_url)
        `).eq("chat_id",t).order("created_at",{ascending:!0});if(a)throw a;return{messages:s||[],error:null}}catch(s){return console.error("Error getting chat messages:",s),{messages:[],error:s instanceof Error?s.message:"Unknown error"}}})}static sendMessage(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{message:null,error:"Not authenticated"};const{data:a,error:c}=yield o.from("event_organizer_messages").insert({chat_id:t.chat_id,sender_id:s.id,message:t.message,message_type:t.message_type||"text"}).select(`
          *,
          sender:profiles!event_organizer_messages_sender_id_fkey(id, display_name, avatar_url)
        `).single();if(c)throw c;return{message:a,error:null}}catch(s){return console.error("Error sending message:",s),{message:null,error:s instanceof Error?s.message:"Unknown error"}}})}static markMessagesAsRead(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{success:!1,error:"Not authenticated"};const{error:a}=yield o.from("event_organizer_messages").update({is_read:!0}).eq("chat_id",t).neq("sender_id",s.id).eq("is_read",!1);if(a)throw a;return{success:!0,error:null}}catch(s){return console.error("Error marking messages as read:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}})}static closeChat(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{success:!1,error:"Not authenticated"};const{error:a}=yield o.from("event_organizer_chat").update({status:"closed"}).eq("id",t).or(`attendee_id.eq.${s.id},organizer_id.eq.${s.id}`);if(a)throw a;return{success:!0,error:null}}catch(s){return console.error("Error closing chat:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}})}static getChatStats(){return m(this,null,function*(){try{const{data:{user:t}}=yield o.auth.getUser();if(!t)return{stats:null,error:"Not authenticated"};const{count:s}=yield o.from("event_organizer_chat").select("*",{count:"exact",head:!0}).or(`attendee_id.eq.${t.id},organizer_id.eq.${t.id}`),{count:a}=yield o.from("event_organizer_chat").select("*",{count:"exact",head:!0}).or(`attendee_id.eq.${t.id},organizer_id.eq.${t.id}`).eq("status","active"),{data:c}=yield o.from("event_organizer_chat").select("id").or(`attendee_id.eq.${t.id},organizer_id.eq.${t.id}`);let n=0;if(c&&c.length>0){const u=c.map(l=>l.id),{count:r}=yield o.from("event_organizer_messages").select("*",{count:"exact",head:!0}).in("chat_id",u).eq("is_read",!1).neq("sender_id",t.id);n=r||0}return{stats:{total_chats:s||0,unread_messages:n,active_chats:a||0},error:null}}catch(t){return console.error("Error getting chat stats:",t),{stats:null,error:t instanceof Error?t.message:"Unknown error"}}})}}const fs=({eventId:v,organizerId:t,organizerName:s="Event Organizer",organizerAvatar:a,isOpen:c,onClose:n,className:u=""})=>{const{user:r}=fe(),{toast:l}=ve(),[k,w]=h.useState(null),[E,C]=h.useState([]),[q,L]=h.useState(""),[F,S]=h.useState(!1),[j,D]=h.useState(!1),U=h.useRef(null);h.useEffect(()=>{c&&v&&t&&A()},[c,v,t,A]),h.useEffect(()=>{B()},[E]);const B=()=>{var d;(d=U.current)==null||d.scrollIntoView({behavior:"smooth"})},A=h.useCallback(()=>m(null,null,function*(){try{S(!0);const{chat:d,error:_}=yield Q.getOrCreateChat(v,t);if(_){l({title:"Error",description:_,variant:"destructive"});return}d&&(w(d),yield z(d.id),yield M(d.id))}catch(d){console.error("Error initializing chat:",d),l({title:"Error",description:"Failed to initialize chat.",variant:"destructive"})}finally{S(!1)}}),[v,t,l,z]),z=h.useCallback(d=>m(null,null,function*(){try{const{messages:_,error:N}=yield Q.getChatMessages(d);if(N){l({title:"Error",description:N,variant:"destructive"});return}C(_)}catch(_){console.error("Error loading messages:",_)}}),[l]),M=d=>m(null,null,function*(){try{yield Q.markMessagesAsRead(d)}catch(_){console.error("Error marking messages as read:",_)}}),O=()=>m(null,null,function*(){if(!(!q.trim()||!k||j))try{D(!0);const{message:d,error:_}=yield Q.sendMessage({chat_id:k.id,message:q.trim(),message_type:"text"});if(_){l({title:"Error",description:_,variant:"destructive"});return}d&&(C(N=>[...N,d]),L(""))}catch(d){console.error("Error sending message:",d),l({title:"Error",description:"Failed to send message.",variant:"destructive"})}finally{D(!1)}}),I=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),O())};return c?e.jsx("div",{className:`fixed inset-0 bg-black/50 flex items-center justify-center z-50 ${u}`,children:e.jsxs(y,{className:"w-full max-w-2xl h-[600px] flex flex-col",children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(se,{className:"h-10 w-10",children:[e.jsx(te,{src:a}),e.jsx(re,{children:s.charAt(0).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-lg",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Event Organizer"})]})]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:n,children:e.jsx(es,{className:"h-4 w-4"})})]}),e.jsxs(b,{className:"flex-1 flex flex-col p-0",children:[e.jsx(xs,{className:"flex-1 p-4",children:F?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):E.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Start a Conversation"}),e.jsxs("p",{className:"text-muted-foreground",children:["Send a message to ",s," about this event."]})]}):e.jsxs("div",{className:"space-y-4",children:[E.map(d=>{var _,N,i;return e.jsx("div",{className:`flex ${d.sender_id===(r==null?void 0:r.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-start space-x-2 max-w-[80%] ${d.sender_id===(r==null?void 0:r.id)?"flex-row-reverse space-x-reverse":""}`,children:[e.jsxs(se,{className:"h-8 w-8 flex-shrink-0",children:[e.jsx(te,{src:(_=d.sender)==null?void 0:_.avatar_url}),e.jsx(re,{children:((i=(N=d.sender)==null?void 0:N.display_name)==null?void 0:i.charAt(0))||"U"})]}),e.jsxs("div",{className:`rounded-lg px-3 py-2 ${d.sender_id===(r==null?void 0:r.id)?"bg-primary text-primary-foreground":"bg-muted"}`,children:[e.jsx("p",{className:"text-sm",children:d.message}),e.jsx("p",{className:`text-xs mt-1 ${d.sender_id===(r==null?void 0:r.id)?"text-primary-foreground/70":"text-muted-foreground"}`,children:Be(new Date(d.created_at),{addSuffix:!0})})]})]})},d.id)}),e.jsx("div",{ref:U})]})}),e.jsx("div",{className:"border-t p-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(W,{value:q,onChange:d=>L(d.target.value),onKeyPress:I,placeholder:"Type your message...",className:"min-h-[40px] max-h-[120px] resize-none",disabled:j}),e.jsx(x,{onClick:O,disabled:!q.trim()||j,size:"sm",className:"self-end",children:e.jsx(xe,{className:"h-4 w-4"})})]})})]})]})}):null};class De{static createBooking(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{booking:null,error:"Not authenticated"};const{data:a}=yield o.from("event_bookings").select("id").eq("event_id",t.event_id).eq("user_id",s.id).eq("status","confirmed").single();if(a)return{booking:null,error:"You already have a booking for this event"};const{data:c}=yield o.from("posts").select("max_attendees, attendees_count").eq("id",t.event_id).eq("type","event").single();if(c&&c.max_attendees){const l=c.max_attendees-(c.attendees_count||0);if(t.tickets_count>l)return{booking:null,error:`Only ${l} spots available`}}const n=`EVENT_${t.event_id}_${s.id}_${Date.now()}`,{data:u,error:r}=yield o.from("event_bookings").insert({event_id:t.event_id,user_id:s.id,tickets_count:t.tickets_count,total_amount:t.total_amount,payment_intent_id:t.payment_intent_id,qr_code:n,status:"pending"}).select(`
          *,
          event:posts!event_bookings_event_id_fkey(id, title, event_date, event_time, location_name, price, image_url),
          user:profiles!event_bookings_user_id_fkey(id, display_name)
        `).single();if(r)throw r;return yield o.from("posts").update({attendees_count:o.raw("attendees_count + ?",[t.tickets_count])}).eq("id",t.event_id).eq("type","event"),{booking:u,error:null}}catch(s){return console.error("Error creating booking:",s),{booking:null,error:s instanceof Error?s.message:"Unknown error"}}})}static getUserBookings(){return m(this,null,function*(){try{const{data:{user:t}}=yield o.auth.getUser();if(!t)return{bookings:[],error:"Not authenticated"};const{data:s,error:a}=yield o.from("event_bookings").select(`
          *,
          event:posts!event_bookings_event_id_fkey(id, title, event_date, event_time, location_name, price, image_url)
        `).eq("user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;return{bookings:s||[],error:null}}catch(t){return console.error("Error getting user bookings:",t),{bookings:[],error:t instanceof Error?t.message:"Unknown error"}}})}static getEventBookings(t){return m(this,null,function*(){try{const{data:s,error:a}=yield o.from("event_bookings").select(`
          *,
          user:profiles!event_bookings_user_id_fkey(id, display_name, email)
        `).eq("event_id",t).order("created_at",{ascending:!1});if(a)throw a;return{bookings:s||[],error:null}}catch(s){return console.error("Error getting event bookings:",s),{bookings:[],error:s instanceof Error?s.message:"Unknown error"}}})}static updateBookingStatus(t,s){return m(this,null,function*(){try{const{error:a}=yield o.from("event_bookings").update({status:s,updated_at:new Date().toISOString()}).eq("id",t);if(a)throw a;return{success:!0,error:null}}catch(a){return console.error("Error updating booking status:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}})}static cancelBooking(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{success:!1,error:"Not authenticated"};const{data:a,error:c}=yield o.from("event_bookings").select("event_id, tickets_count, status").eq("id",t).eq("user_id",s.id).single();if(c)throw c;if(!a)return{success:!1,error:"Booking not found"};if(a.status==="cancelled")return{success:!1,error:"Booking is already cancelled"};const{error:n}=yield o.from("event_bookings").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n;return yield o.from("posts").update({attendees_count:o.raw("attendees_count - ?",[a.tickets_count])}).eq("id",a.event_id).eq("type","event"),{success:!0,error:null}}catch(s){return console.error("Error cancelling booking:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}})}static getEventBookingStats(t){return m(this,null,function*(){try{const{data:s,error:a}=yield o.from("event_bookings").select("status, total_amount").eq("event_id",t);if(a)throw a;return{stats:{total_bookings:s.length,confirmed_bookings:s.filter(n=>n.status==="confirmed").length,pending_bookings:s.filter(n=>n.status==="pending").length,total_revenue:s.filter(n=>n.status==="confirmed").reduce((n,u)=>n+(u.total_amount||0),0)},error:null}}catch(s){return console.error("Error getting booking stats:",s),{stats:null,error:s instanceof Error?s.message:"Unknown error"}}})}static hasUserBookedEvent(t){return m(this,null,function*(){try{const{data:{user:s}}=yield o.auth.getUser();if(!s)return{hasBooked:!1,booking:null,error:"Not authenticated"};const{data:a,error:c}=yield o.from("event_bookings").select(`
          *,
          event:posts!event_bookings_event_id_fkey(id, title, event_date, event_time, location_name, price, image_url)
        `).eq("event_id",t).eq("user_id",s.id).eq("status","confirmed").single();if(c&&c.code!=="PGRST116")throw c;return{hasBooked:!!a,booking:a||null,error:null}}catch(s){return console.error("Error checking user booking:",s),{hasBooked:!1,booking:null,error:s instanceof Error?s.message:"Unknown error"}}})}}const Ls=()=>{const{eventId:v}=ss(),t=ts(),{events:s,loading:a,toggleAttendance:c}=ms(),{user:n}=fe(),{toast:u}=ve(),[r,l]=h.useState(null),[k,w]=h.useState(!1),[E,C]=h.useState(!1),[q,L]=h.useState(!1),[F,S]=h.useState(!1),[j,D]=h.useState(1),[U,B]=h.useState(""),[A,z]=h.useState(0),[M,O]=h.useState(null),[I,d]=h.useState(!1),[_,N]=h.useState(!1),[i,g]=h.useState(0),[Y,P]=h.useState(0),[ne,Ae]=h.useState(0),Me=f=>m(null,null,function*(){try{const{hasBooked:p,booking:R}=yield De.hasUserBookedEvent(f);O(p?R:null)}catch(p){console.error("Error checking user booking:",p)}});if(h.useEffect(()=>{if(v&&s.length>0){const f=s.find(p=>p.id===v);l(f),f&&n&&Me(f.id)}},[v,s,n]),!v)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Event Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The event you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>t("/events"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Back to Events"})]})});const ie=f=>{try{return hs(new Date(f),"EEEE, MMMM dd, yyyy")}catch(p){return f}},H=f=>f===0?"Free":`$${f}`,$e=()=>{if(!n){u({title:"Authentication Required",description:"Please sign in to book this event",variant:"destructive"});return}w(!0)},Te=()=>{if(!n){u({title:"Authentication Required",description:"Please sign in to chat with the organizer",variant:"destructive"});return}L(!0)},Le=()=>{U.trim()&&(u({title:"Message Sent",description:"Your message has been sent to the organizer"}),B(""),C(!1))},Fe=()=>{r&&t(`/profile/${r.user_id}`)},Oe=()=>m(null,null,function*(){if(!(!r||!n))try{d(!0);const f=r.price===0?0:r.price*j,{booking:p,error:R}=yield De.createBooking({event_id:r.id,tickets_count:j,total_amount:f});if(R){u({title:"Booking Failed",description:R,variant:"destructive"});return}p&&(u({title:"Booking Successful",description:`You've booked ${j} ticket(s) for ${r.title}`}),O(p),w(!1),D(1))}catch(f){console.error("Error confirming booking:",f),u({title:"Booking Failed",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{d(!1)}}),pe=()=>m(null,null,function*(){if(!n){u({title:"Authentication Required",description:"Please sign in to like this event",variant:"destructive"});return}try{const f=!_;N(f),g(p=>f?p+1:p-1),u({title:f?"Event Liked!":"Like Removed",description:f?"You liked this event":"You removed your like"})}catch(f){N(!_),g(p=>_?p+1:p-1),u({title:"Error",description:"Failed to update like status",variant:"destructive"})}}),_e=()=>{S(!0)},Pe=()=>m(null,null,function*(){try{yield navigator.clipboard.writeText(window.location.href),u({title:"Link Copied!",description:"Event link has been copied to clipboard"}),S(!1)}catch(f){u({title:"Copy Failed",description:"Failed to copy link to clipboard",variant:"destructive"})}}),K=f=>{const p=window.location.href,R=(r==null?void 0:r.title)||"Check out this event!",Ie=(r==null?void 0:r.description)||"Join me at this amazing event!";let V="";switch(f){case"facebook":V=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(p)}`;break;case"twitter":V=`https://twitter.com/intent/tweet?url=${encodeURIComponent(p)}&text=${encodeURIComponent(R)}`;break;case"linkedin":V=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(p)}`;break;case"email":V=`mailto:?subject=${encodeURIComponent(R)}&body=${encodeURIComponent(Ie+`

`+p)}`;break}V&&(window.open(V,"_blank","width=600,height=400"),S(!1),Ae(Ye=>Ye+1))};if(a)return e.jsx(ce,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/4 mb-4"}),e.jsx("div",{className:"h-96 bg-muted rounded-lg mb-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-full"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})]})})});if(!r)return e.jsx(ce,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Event Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"The event you're looking for doesn't exist or has been removed."}),e.jsxs(x,{onClick:()=>t("/events"),children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Back to Events"]})]})});const Re=r.price===0?0:r.price*j;return e.jsx(ce,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(x,{variant:"ghost",onClick:()=>t("/events"),className:"mb-4",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Back to Events"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:r.title}),e.jsxs("div",{className:"flex items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-4 h-4"}),ie(r.event_date)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-4 h-4"}),r.event_time]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),r.location_name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"bg-orange-500 text-white font-semibold",children:H(r.price)}),Math.random()>.7&&e.jsxs(ee,{className:"bg-blue-500 text-white",children:[e.jsx(rs,{className:"w-3 h-3 mr-1"}),"Verified"]})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r.image_url||"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&h=400&fit=crop",alt:r.title,className:"w-full h-96 object-cover rounded-lg"}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsxs(x,{variant:"ghost",size:"sm",className:`bg-white/20 hover:bg-white/30 text-white ${_?"text-red-400":""}`,onClick:pe,children:[e.jsx(ge,{className:`w-4 h-4 ${_?"fill-current":""}`}),i>0&&e.jsx("span",{className:"ml-1 text-xs",children:i})]}),e.jsxs(x,{variant:"ghost",size:"sm",className:"bg-white/20 hover:bg-white/30 text-white",onClick:_e,children:[e.jsx(Ce,{className:"w-4 h-4"}),ne>0&&e.jsx("span",{className:"ml-1 text-xs",children:ne})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(y,{children:[e.jsx($,{children:e.jsx(T,{children:"About This Event"})}),e.jsx(b,{children:e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:r.description||"No description available for this event."})})]}),e.jsxs(y,{children:[e.jsx($,{children:e.jsx(T,{children:"Event Details"})}),e.jsx(b,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Date"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ie(r.event_date)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Time"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.event_time})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Location"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.location_name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Attendees"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.attendees_count," / ",r.max_attendees||"âˆž"," attending"]})]})]})]})})]}),r.tags&&r.tags.length>0&&e.jsxs(y,{children:[e.jsx($,{children:e.jsx(T,{children:"Tags"})}),e.jsx(b,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((f,p)=>e.jsxs(ee,{variant:"secondary",children:[e.jsx(as,{className:"w-3 h-3 mr-1"}),f]},p))})})]}),r.target_authority&&r.target_authority.length>0&&e.jsxs(y,{children:[e.jsxs($,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Government Authorities"]}),e.jsx(ds,{children:"This event involves the following government authorities"})]}),e.jsx(b,{children:e.jsx("div",{className:"space-y-3",children:r.target_authority.map((f,p)=>e.jsxs("div",{className:"p-3 border rounded-lg bg-blue-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"font-medium",children:["Government Authority #",p+1]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Authority ID: ",f]})]},p))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"w-full",variant:r.user_attending?"default":"outline",onClick:()=>c(r.id),children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),r.user_attending?"Attending":"Attend Event"]}),M?e.jsxs("div",{className:"w-full",children:[e.jsxs(x,{className:"w-full",variant:"outline",disabled:!0,children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Already Booked (",M.tickets_count," ticket",M.tickets_count>1?"s":"",")"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:["Booking ID: ",M.id.slice(0,8),"..."]})]}):e.jsxs(x,{className:"w-full btn-event",onClick:$e,children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Book Tickets"]}),e.jsxs(x,{variant:"outline",className:"w-full",onClick:Te,children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Chat with Organizer"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",className:"flex-1",onClick:pe,children:[e.jsx(ge,{className:`w-4 h-4 mr-1 ${_?"fill-current text-red-500":""}`}),_?"Liked":"Like"," (",i,")"]}),e.jsxs(x,{variant:"outline",size:"sm",className:"flex-1",onClick:_e,children:[e.jsx(Ce,{className:"w-4 h-4 mr-1"}),"Share (",ne,")"]})]})]})})}),e.jsxs(y,{children:[e.jsx($,{children:e.jsx(T,{children:"Event Organizer"})}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted transition-colors cursor-pointer",onClick:Fe,children:[e.jsxs(se,{className:"w-12 h-12",children:[e.jsx(te,{src:r.organizer_avatar}),e.jsx(re,{children:(r.organizer_name||"E")[0]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:r.organizer_name||"Event Organizer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Event Creator"})]}),e.jsx(qe,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsx(us,{className:"my-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Send Message"]}),e.jsxs(x,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"View Profile"]})]})]})]}),e.jsxs(y,{children:[e.jsx($,{children:e.jsx(T,{children:"Pricing"})}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Ticket Price"}),e.jsx("span",{className:"text-2xl font-bold text-orange-500",children:H(r.price)})]}),r.price>0&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Price per ticket"})]})]})]})]}),e.jsx(le,{open:k,onOpenChange:w,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ue,{children:[e.jsxs(me,{children:["Book Tickets - ",r.title]}),e.jsx(he,{children:"Select the number of tickets you'd like to book"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 p-4 bg-muted rounded-lg",children:[e.jsx("img",{src:r.image_url||"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&h=400&fit=crop",alt:r.title,className:"w-20 h-16 rounded object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:r.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[ie(r.event_date)," at ",r.event_time]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.location_name})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ae,{htmlFor:"tickets",children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"General Admission"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[H(r.price)," per ticket"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>D(Math.max(1,j-1)),disabled:j<=1,children:"-"}),e.jsx("span",{className:"w-8 text-center",children:j}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>D(Math.min(r.max_attendees-r.attendees_count,j+1)),disabled:j>=r.max_attendees-r.attendees_count,children:"+"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-xl font-bold",children:H(Re)})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(x,{className:"flex-1 btn-event",onClick:Oe,disabled:I,children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),I?"Processing...":r.price===0?"Reserve Spot":"Book Tickets"]}),e.jsx(x,{variant:"outline",onClick:()=>w(!1),children:"Cancel"})]})]})]})}),e.jsx(le,{open:E,onOpenChange:C,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ue,{children:[e.jsxs(me,{children:["Chat with ",r.organizer_name||"Event Organizer"]}),e.jsx(he,{children:"Send a message to the event organizer"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"message",children:"Your Message"}),e.jsx(W,{id:"message",placeholder:"Type your message here...",value:U,onChange:f=>B(f.target.value),rows:4})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(x,{className:"flex-1",onClick:Le,disabled:!U.trim(),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Send Message"]}),e.jsx(x,{variant:"outline",onClick:()=>C(!1),children:"Cancel"})]})]})]})}),r&&e.jsx("div",{className:"mt-8",children:e.jsx(gs,{eventId:r.id})}),e.jsx(le,{open:F,onOpenChange:S,children:e.jsxs(de,{className:"max-w-md",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Share This Event"}),e.jsx(he,{children:"Share this amazing event with your friends and family"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(x,{variant:"outline",className:"w-full justify-start",onClick:Pe,children:[e.jsx(ns,{className:"w-4 h-4 mr-3"}),"Copy Link"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>K("facebook"),children:[e.jsx(is,{className:"w-4 h-4 mr-2 text-blue-600"}),"Facebook"]}),e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>K("twitter"),children:[e.jsx(os,{className:"w-4 h-4 mr-2 text-blue-400"}),"Twitter"]}),e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>K("linkedin"),children:[e.jsx(cs,{className:"w-4 h-4 mr-2 text-blue-700"}),"LinkedIn"]}),e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>K("email"),children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"Email"]})]})]})]})}),r&&e.jsx(fs,{eventId:r.id,organizerId:r.user_id,organizerName:r.organizer_name,organizerAvatar:r.organizer_avatar,isOpen:q,onClose:()=>L(!1)})]})})};export{Ls as default};
